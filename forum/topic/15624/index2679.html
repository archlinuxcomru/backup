


<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Общение с USB-устройством
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://storage.yandexcloud.net/aor-static/static/css/default.css">
    
    
    

    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/posts/" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/topics/" title="Последние темы на форуме" >

    
    
    
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/jquery.formset.min.js"></script>

</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="/">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="/news/">Новости</a></li>
    <li class="active"><a href="/forum/">Форум</a></li>
    <li class=""><a href="/blogs/">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_%28%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9%29">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="/irc/#chat">IRC</a></li>
      <li class="dropdown">
        <a href="/accounts/login/" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="/accounts/login/">Вход</a></li>
          <li><a href="/accounts/register/">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="/messages/inbox/" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="/">ArchLinux.org.ru</a></li>


    <li><a href="/forum/">Начало</a> <span class="divider">/</span></li>
    
        
            
                <li><a href="/forum/category/8/">Блоги</a> <span class="divider">/</span></li>
            
                <li><a href="/forum/forum/25/">Блоги</a> <span class="divider">/</span></li>
            
        
        
            <li>Общение с USB-устройством</li>
        
    
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    
    <div class="topic">
        <h1>Общение с USB-устройством</h1>
        
            <div class="text-center">
    



</div>

        

        

        <div class="posts">
            
            
                
                




<table class="table table-bordered post post-row
       "
       id="post-162302"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/vasek/">
                <span class="post-username">vasek</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/162302/">#</a>
            6 лет, 7 месяцев назад
            
                (отредактировано
                
                    6 лет, 7 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/vasek/topics/">
                    48
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/vasek/posts/">
                    11340
                </a>
            </div>
            <div>
                Участник с: 17 февраля 2013
            </div>
            
        </td>
        <td class="post-content">
            <strong>Общение с USB-устройством</strong><br />Два дня было свободных и решил написать две  ознакомительные статейки. Но, чувствую, что это в первый и последний раз …..тяжеловато, особенно  в этой статье, тема тяжелая, написать можно много.... но уже стал путаться, ну и гложет мысль …. а кому это нужно — успокоился тем, что пойдет на пользу ребятишкам, которые частенько забегают за ответами на свои вопросы...<br /><br /> USB-устройства, по большей части флешки, отказывали у многих и прежде чем заниматься их восстановлением хотелось бы извлечь из этой флешки побольше информации — чем больше информации, тем лучше .... А вот как поговрить с этим устройством, особо и не расписано.....информация, конечно,  имеется, но в основном вся проверка сводится к тестированию несколькими утилитами.... А вот как общаются эти самые утилиты с устройством …. особо и неизвестно ….. а общаются они  посредством SCSI команд (запрос/ответ). И напрашивается вывод - а может лучше самим пообщаться с устройством без всяких посредников, напрямую ?<br />Вот с этими способами общения и хочу ознакомить форумчан......<br />В основном для тестирования флешек в Linux применяют утилиту hdparm и реже sdparm.<br />В качестве подопытного будет 16G флешка (при возможности буду приводить похожие выводы всеми способами — обоими утилитами и SCSI командами)<br /><strong># sdparm -i /dev/sdb</strong><br /> /dev/sdb: JetFlash  Transcend 16GB    1100<br />malformed VPD response, VPD pages probably not supported<br /><br />USB-устройство, в частности флешка, представляет собой тот же мини/микро компьютер — описывать ее устройство не собираюсь — все давно уже хорошо описано и в инете можно найти кучу схем и описаний (интересующимся даю ссылку на <a href="http://migera.ru/hard/usb/smi324.html">старую статью</a>..... там хоть и много лишнего, но хорошая схемка......что то другой похожей я у себя не нашел, а может плохо искал....)<br /><br />Для начала - набор команд SCSI разрабатывался, как протокол для устройств, использующих параллельный интерфейс для малых компьютерных систем (Small Computer Systems Interface - SCSI). Команды является инструментом, позволяющим получать информацию об устройстве, менять режим его работы и читать/записывать блоки данных на носитель. Набор команд SCSI используют многие накопители данных, подключаемые через другие аппаратные интерфейсы, в том числе через USB.<br />Команды SCSI охватывают широкий диапазон типов устройств и задач, все заспецифицировано, а для нас важна спецификация <strong>SCSI Block Commands (SBC)</strong> - блоковые команды SCSI, которые описывает команды, используемые жёсткими дисками, флэш-дисками и другими блоковыми устройствами прямого доступа. Текущая версия - SBC-3. Кого интересует данная спецификация, формат команд, их описание и.т.п. могут обратится к первоисточнику — можно найти и скачать по названию <strong>SCSI Block Commands - 3 (SBC-3)</strong><br />Ну вот, с водной можно закончить и приступить к основной части.<br /><br />SCSI команды условно можно разделить на 3 группы<br />- специфицированные, обязательные для всех устройств;<br />- специфицированные, но работающие не на всех устройствах;<br />- неспецифицированные, применяются разработчиками, изготовителями и, как бы сказать....наладчиками...... то есть эти команды не описаны в спецификации и известны узкому кругу лиц.<br />Специфицированных команд около 60. Но обычным пользователям достаточно 5 базовых команд — минимум команд, которые используются устройством и хостом для начала взаимодействия/общения, чтобы начать полноценную работу. Вот эти команды я и постараюсь описать.<br /><br />1. <strong>INQUIRY (12 00 00 00 60 00)</strong> - запрашивает структуру с информацией об устройстве. Устройство должно возвращать ответ даже в случае неготовности носителя и невозможности отвечать на все остальные команды. Все блоковые устройства должны поддерживать команду INQUIRY. <u>В скобках приведен формат команды</u>.<br />Ответ на команду имеет длину как минимум 36 байт и указывает периферийный тип устройства (&quot;PDT&quot;), версию набора базовых команд SPC, идентификаторы производителя и изделия, номер модификации изделия, а также данные о возможностях устройства и поддерживаемых протоколах.<br />Забыл написать, что для дальнейшего тестирования <strong>должен быть установлен пакет sg3_utils и загружен модуль sg</strong> ...... и будем использовать утилиту  <strong>sg_raw</strong><br />Вставляем флешку и смотрим как она определилась<br /><strong># sg_map -i</strong><br /><strong>/dev/sg2</strong>  /dev/sdb  JetFlash  Transcend 16GB    1100<br />Приступаем к общению ….<br /><strong># sg_raw /dev/sg2 12 00 00 00 60 00</strong><br />SCSI Status: Good<br />или более информативный вывод<br /><strong># sg_raw -vv /dev/sg2 12 00 00 00 60 00</strong><br />open /dev/sg2 with flags=0x802<br /> cdb to send: 12 00 00 00 60 00<br />SCSI Status: Good<br />No errors<br />Попросим дать ответ в другой форме и вывести нам всю информацию об устройстве (запросим только первые 64 байта)<br /><strong># sg_raw -r 64 /dev/sg2 12 00 00 00 60 00</strong><br />SCSI Status: Good<br />Received 64 bytes of data:<br /> 00     00 80 00 01 1f 73 6d 69  4a 65 74 46 6c 61 73 68    <strong>.....smiJetFlash</strong><br /> 10     54 72 61 6e 73 63 65 6e  64 20 31 36 47 42 20 20    <strong>Transcend 16GB</strong><br /> 20     31 31 30 30 00 80 02 00  00 00 00 00 00 00 00 00    <strong>1100............</strong><br /> 30     00 00 00 00 00 00 28 00  03 01 82 06 00 15 00 00    <strong>......(.........</strong><br />формат ответа описывать не буду — кому интересно, обращайтесь к спецификации (например, 8..15 байты - обозначение производителя, 16..31 байты - обозначение изделия,  32..35 байты - версия изделия и.т.д....). .....<em>PS...чтобы увеличить количество выводимых байт, нужно вместо 64 прописать, например, 256.....иногда и там имеется полезное)</em><br />…..............................<br />Аналог специальных утилит пакета sg3_utils<br /># sg_inq /dev/sg2   или   # sginfo /dev/sg2<br />Аналог sdparm (но менее информативный) с опцией -i (--inquiry) команда<br /># sdparm -i /dev/sdb<br />….................................<br />2. <strong>READ CAPACITY (25 00 00 00 00 00)</strong> - возвращает структуру, содержащую логический адрес (LBA) последнего блока на носителе и размер блока в байтах. Стоит уточнить, что команда запрашивает логический адрес (LBA) последнего блока, а не количество блоков на носителе. Логический адрес первого блока равен нулю, таким образом, логический адрес последнего блока на единицу меньше количества блоков. <em>PS.... команда используется, чтобы выяснить какой объём данных может хранить устройство</em><br /><strong># sg_raw -r 8 /dev/sg2 25 00 00 00 00 00</strong><br />SCSI Status: Good<br />00     01 e3 bf ff 00 00 02 00<br />( 01e3bfff=<strong>31703039</strong> - <em>(первые 4 байта)</em> количество блоков , <em>(последние 4 байта)</em> 00000200=<strong>512</strong> - размер блока)<br />Проверка<br />$ sudo fdisk -l /dev/sdb<br />Диск /dev/sdb: 15,1 GiB, 16231956480 байт, <strong>31703040</strong> секторов<br />Единицы: секторов по 1 * 512 = <strong>512</strong> байт<br />Размер сектора (логический/физический): 512 байт / 512 байт<br />…..................................<br />Аналог специальной утилиты пакета sg3_utils - # sg_readcap /dev/sg2<br />…...................................<br />3. <strong>SEND DIAGNOSTIC (1D 00 00 00 00 00)</strong> - команда предписывает устройству провести самотестирование и/или проверку логического накопителя. Для блоковых устройств (SBC) обязательна поддержка самотестирования, способ реализации которого оставляется на усмотрение разработчика.<br /><strong># sg_raw  /dev/sg2 1D 00 00 00 00 00</strong><br />SCSI Status: Good<br />или<br /># sg_raw -vv /dev/sg2 1D 00 00 00 00 00<br />open /dev/sg2 with flags=0x802<br />cdb to send: 1d 00 00 00 00 00<br />SCSI Status: Good<br />No errors<br /><br />4. <strong>REQUEST SENSE (03 00 00 00 00 00)</strong> - <strong>(запрос о состоянии)</strong> столкнувшись с проблемами при исполнении команды или получив неизвестную команду, устройство заполняет структуру, содержащую подробную информацию о состоянии и устанавливает значение поля &quot;bCSWStatus&quot; (CSW) равным &quot;0x01&quot; (ошибка исполнения). Структура с информацией о состоянии называется пояснительными данными (SENSE DATA) и передаётся в ответ на команду REQUEST SENSE (все поля формата не привожу, а только наиболее интересующие пользователей)<br />Запрашиваю только первые 16 байт (можно и без опции -vv, пишу для того, чтобы увидеть No errors, хотя это и не к чему.... и так все видно)<br /><strong># sg_raw -vv -r 16 /dev/sg2 03 00 00 00 00 00</strong><br />open /dev/sg2 with flags=0x802<br />cdb to send: 03 00 00 00 00 00<br />SCSI Status: Good<br />Received 16 bytes of data:<br /> 00     70 00 00 00 00 00 00 0a  00 00 00 00 00 00 00 00    p...............<br />No errors<br />….....................................<br /><em>PS..... Забыл отметить, что в спецификации указано, что запрос должен быть равным 252 байтам для того, чтобы устройство могло возвратить всю значимую информацию, включая внутренние данные производителя.</em><br />........................................<br />Аналог специальной утилиты пакета sg3_utils (а вот с этими двумя разными выводами руки так разобраться и не дошли, наверное, потому, что утилиты этого пакета практически не использую.......нравится общаться на прямую....)<br /> # sg_requests /dev/sg2<br />Decode parameter data as sense data:<br /> Fixed format, current;  Sense key: No Sense<br /> Additional sense: No additional sense information<br /># sg_requests -vv /dev/sg2<br />open /dev/sg2 with flags=0x800<br />Request Sense cmd: 03 00 00 00 fc 00<br />Decode parameter data as sense data:<br /> Fixed format, current;  Sense key: No Sense<br /> Additional sense: No additional sense information<br />Parameter data in hex<br /> 00     70 00 00 00 00 00 00 0a  00 00 00 00 00 00 00 00<br /> 10     00 00<br />….............................................<br /><br /><strong>Формат вывода ответа</strong><br />0 байт - RESPONSE CODE  - для сведений о текущих ошибках устанавливается в &quot;0x70&quot;. Для сведений об отложенных ошибках (для команд использующих кэширование) устанавливается в &quot;0x71&quot;<br />2 байт - SENSE KEY - содержит данные, классифицирующие ошибку<br />7 байт - ADDITIONAL SENSE LENGTH - длина дополнительных пояснительных данных, следующих за данным полем, в байтах, 244 байта максимум<br /><br />Некоторые значения поля SENSE KEY<br />00 - NO SENSE (нет ответа)<br />01 - RECOVERED ERROR (вскрытая ошибка)<br />02 - NOT READY  (не готов)<br />03 - MEDIUM ERROR (ошибка носителя/средняя ошибка)<br />04 - HARDWARE ERROR (ошибка аппаратного обеспечения)<br />05 - ILLEGAL REQUEST (некорректный запрос)<br />06 - UNIT ATTENTION  (устройство требует внимания/ предупреждение)<br />07 - DATA PROTECT (защищенная информация)<br />…...... ит.п. ит.д.......  и, если мне не изменяет память, есть еще уточняющие коды, посмотреть можно в спецификации...<br />Примечание: уточнение кода SENSE KEY в части значения 05 - в случае получения неизвестной команды устройство не должно &quot;зависать&quot; или аварийно завершать работу. Правильный ответ на неподдерживаемую команду выглядит так:<br />- возвратить значение &quot;0x01&quot; (ошибка выполнения) в поле &quot;bCSWStatus&quot; (CSW);<br />-  установить в блоке пояснительных данных (&quot;SENSE DATA&quot;) параметр &quot;SENSE KEY&quot; в &quot;0x05&quot; (&quot;Недопустимый запрос&quot; - &quot;ILLEGAL REQUEST&quot;), а параметр &quot;ADDITIONAL SENSE CODE&quot; в &quot;0x20&quot; (&quot;Неверный код операции&quot; - &quot;INVALID COMMAND OPERATION CODE&quot;).<br /><br />Имеются и другие команды, но, если честно, что то уже устал и стал путаться (за найденные ошибки особо не пинать) — думаю для начального ознакомления этого достаточно.<br /><em>PS.... по ответам, напрямую посланным запросам (на низком уровне), можно судить о состоянии устройства...</em>
            
                
                    <div class="post-signature">
                        Ошибки не исчезают с опытом - они просто умнеют
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-162309"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/scorpid/">
                <span class="post-username">scorpid</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/162309/">#</a>
            6 лет, 7 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/0d/a4/0da4f56adfecb050fac8e5a4b3725636.png" alt="scorpid avatar" />
    
</div>

            <div>
                Темы:
                <a href="/forum/users/scorpid/topics/">
                    4
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/scorpid/posts/">
                    294
                </a>
            </div>
            <div>
                Участник с: 14 апреля 2015
            </div>
            
        </td>
        <td class="post-content">
            Спасибо, добавил в закладки :).
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-162351"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/GVG/">
                <span class="post-username">GVG</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/162351/">#</a>
            6 лет, 7 месяцев назад
            
                (отредактировано
                
                    6 лет, 7 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/GVG/topics/">
                    18
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/GVG/posts/">
                    122
                </a>
            </div>
            <div>
                Участник с: 11 июня 2013
            </div>
            
        </td>
        <td class="post-content">
            <blockquote>00 01 e3 bf ff 00 00 02 00<br />( 01e3bfff=31703039 - (первые 4 байта) количество блоков , (последние 4 байта) 00000200=512 - размер блока)</blockquote>  я не пойму где здесь в суме 8байт, я вижу здесь только 2байта ( по 8бит в каждом). Объясните что я пропускаю, спасибо.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-162353"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/vasek/">
                <span class="post-username">vasek</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/162353/">#</a>
            6 лет, 7 месяцев назад
            
                (отредактировано
                
                    6 лет, 7 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/vasek/topics/">
                    48
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/vasek/posts/">
                    11340
                </a>
            </div>
            <div>
                Участник с: 17 февраля 2013
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>GVG</em><br>я не пойму где здесь в суме 8байт, я вижу здесь только 2байта ( по 8бит в каждом). Объясните что я пропускаю, спасибо.</blockquote>Как то это понимается само собой, автоматом, никогда на этот счет и не задумывался.....<br /><u>Постараюсь ответить пополнее.</u> Начну с вопроса - какое максимальное число можно записать с помощью одного байта?<br />Ответ -  1 байт составляет 8 бит (8 разрядов) и бит может принимать только 2 значения — 0 или 1. Следовательно, максимально возможное число, которое можно записать с помощью одного байта будет (в 2-ичной системе) — 11111111 , или в 10-ричной системе это будет 255.<br />У нас же имеется значение записанное в 16-ричном исчислении (0,1,2,3,4,5,6,7,8,9,A,B,C,D,E,F)<br /><strong>01 e3 bf ff 00 00 02 00</strong><br /> и принято считать байтом (при работе с 16-ричными числами) выражение состоящее из 2 символов, каждый символ в 16-ричном исчислении может принимать 16 значений (смотри выше...0,1,....F) — это и есть один байт ….. посчитай какое максимально возможное число можно записать таким образом....<em>PS....сначала убрал, но решил вернуть - то же 255 , так как максимальное число в 16-ричной системе будет FF , а в 10-ой ....255</em><br />Насчет бит …... повторюсь — это только 0 или 1 …... а что унас???  а у нас<br /> 01 e3 bf ff 00 00 02 00<br />т.е. мы видим не только 0 и 1, но и другие символы.......ну не знаю, как еще объяснить...
            
                
                    <div class="post-signature">
                        Ошибки не исчезают с опытом - они просто умнеют
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-162355"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/GVG/">
                <span class="post-username">GVG</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/162355/">#</a>
            6 лет, 7 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/GVG/topics/">
                    18
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/GVG/posts/">
                    122
                </a>
            </div>
            <div>
                Участник с: 11 июня 2013
            </div>
            
        </td>
        <td class="post-content">
            Спасибо,  немного Гугла мне помогло, никогда не работал плотно со система счисления, вот и вышла ошибочка. В свете последних событий еще и забанят за злупый вопрос 
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-162357"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/vasek/">
                <span class="post-username">vasek</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/162357/">#</a>
            6 лет, 7 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/vasek/topics/">
                    48
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/vasek/posts/">
                    11340
                </a>
            </div>
            <div>
                Участник с: 17 февраля 2013
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>GVG</em><br>никогда не работал плотно со система счисления, вот и вышла ошибочка</blockquote>Есть хороший <strong>gnome-calculator</strong> - им очень удобно пользоваться, используя <strong>программный режим</strong>, когда нужно одновременно видеть число в нескольких системах исчисления.<br />Например, выбираешь 16-ричную систему и набираешь число — сразу же при наборе (on-line) показывается это число и в 2-системе и в 8-системе и в 10-системе....... (аналогично и вдругих системах исчисления).<br />Наверное, имеются и другие калькулятоы такого типа, но привык к этому...
            
                
                    <div class="post-signature">
                        Ошибки не исчезают с опытом - они просто умнеют
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-162396"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/ghost/">
                <span class="post-username">ghost</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/162396/">#</a>
            6 лет, 7 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/ghost/topics/">
                    26
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/ghost/posts/">
                    632
                </a>
            </div>
            <div>
                Участник с: 07 мая 2013
            </div>
            
        </td>
        <td class="post-content">
            Зачетная статейка, спасибо.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-162510"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/Sheykhnur/">
                <span class="post-username">Sheykhnur</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/162510/">#</a>
            6 лет, 7 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/d1/b6/d1b62754f45b5c4a783cd15c795c84b5.png" alt="Sheykhnur avatar" />
    
</div>

            <div>
                Темы:
                <a href="/forum/users/Sheykhnur/topics/">
                    16
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/Sheykhnur/posts/">
                    244
                </a>
            </div>
            <div>
                Участник с: 05 февраля 2013
            </div>
            
        </td>
        <td class="post-content">
            Хорошая, годная статья. Вопрос: а как прошивается тогда контроллёр флешки? Для винды есть спец утилиты, они умеют изменять прошивку контролёра, например, китайцы этим нагло пользуются и флешки у них из 1-гиговых превращаются в 32-гиговые. Так вот, эти утилиты с помощью тех же комманд на низком уровне переводят мк в режим записи, а потом льют образ, я правильно понимаю? Или есть спец. команды для перевода мк в режим прошивки, не относящиеся к спецификациям SCSI?
            
                
                    <div class="post-signature">
                        <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4b3924243f0b3d3b3e3b202225">[email&#160;protected]</a># cat /dev/ass &gt; /dev/head
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-162575"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/vasek/">
                <span class="post-username">vasek</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/162575/">#</a>
            6 лет, 7 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/vasek/topics/">
                    48
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/vasek/posts/">
                    11340
                </a>
            </div>
            <div>
                Участник с: 17 февраля 2013
            </div>
            
        </td>
        <td class="post-content">
            Прошивка — это бинарный файл, микропрограмма (программное обеспечение), закладываемая в контроллер на этапе изготовления.  И все хранится в ПЗУ. В эту микропрограмму зашиты и SCSI команды (т.е. определены его действия на эти команды), а также и информация с параметрами флешки. И разумеется с помощью этих команд изменить содержимое самой микропрограммы, записанной в ПЗУ, не возможно.<br />Чтобы изменить/подделать информацию о параметрах флешки необходимо внести изменения в сам бинарный файл (микропрограмму) и записать/перезаписать ее в ПЗУ.<br />Прошивка (запись бинарного файла в ПЗУ) осуществляется в основном автоматизированным способом - специальными утилитами, и намного реже ручным способом - с использованием программаторов. Для этого применяются свои команды,  имеющие свой формат — и у них совсем другое назначение (перевести контроллер в режим программирования, стереть, записать, проверить......)<br />Возможно сейчас и имеются способы (по типу реверсинга бинарников обычных программ) изменения микропрограммы непосредственно в ПЗУ (без полной перезаписи), но я не знаком и думаю отстал в этой части на много ..... А в принципе даже стало интересно и никогда не интересовался структурой записи в  ПЗУ и ее реверсинга...<br /><em>UPD.... кстати имеется еще один инструмент -  утилита <strong>plscsi</strong>  (раньше с ее помощью выполняли разблокировку первых флешек с отпечатком пальца, которые имели скрытый запароленный раздел), но работа с ней намного мудренее......</em>
            
                
                    <div class="post-signature">
                        Ошибки не исчезают с опытом - они просто умнеют
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
        </div>
        <div>&nbsp;</div>
        
            <div class="text-center">
    



</div>

        

        

        
            
<a href="/accounts/register/">Зарегистрироваться</a> или <a href="/accounts/login/?next=/forum/topic/15624/">войдите</a> чтобы оставить сообщение.

        

        
    </div>

        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>(function(){var js = "window['__CF$cv$params']={r:'747ab47effe878ff',m:'0XgS_u0XPiTKT1jdshTFUD35z.5.h6QiFesCoDYbK0E-1662671785-0-AWIgA47/tzZ04TB0w6sp06QdbGYwtF/6azvJj+ZefPLJV80IjMO1F3RYhNykAk0pcolyksdZ+neREhzSLVpJBUH13Mj/MoH/5JcUlaAHaYGRwtouu2O6336Titb1orZVlm2TjNNT9y/VpVJCobRrV0A=',s:[0x4a6656ed3a,0x3b6ea00577],u:'/cdn-cgi/challenge-platform/h/g'};var now=Date.now()/1000,offset=14400,ts=''+(Math.floor(now)-Math.floor(now%offset)),_cpo=document.createElement('script');_cpo.nonce='',_cpo.src='/cdn-cgi/challenge-platform/h/g/scripts/alpha/invisible.js?ts='+ts,document.getElementsByTagName('head')[0].appendChild(_cpo);";var _0xh = document.createElement('iframe');_0xh.height = 1;_0xh.width = 1;_0xh.style.position = 'absolute';_0xh.style.top = 0;_0xh.style.left = 0;_0xh.style.border = 'none';_0xh.style.visibility = 'hidden';document.body.appendChild(_0xh);function handler() {var _0xi = _0xh.contentDocument || _0xh.contentWindow.document;if (_0xi) {var _0xj = _0xi.createElement('script');_0xj.nonce = '';_0xj.innerHTML = js;_0xi.getElementsByTagName('head')[0].appendChild(_0xj);}}if (document.readyState !== 'loading') {handler();} else if (window.addEventListener) {document.addEventListener('DOMContentLoaded', handler);} else {var prev = document.onreadystatechange || function () {};document.onreadystatechange = function (e) {prev(e);if (document.readyState !== 'loading') {document.onreadystatechange = prev;handler();}};}})();</script></body>
</html>
