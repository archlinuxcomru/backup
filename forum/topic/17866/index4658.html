


<!DOCTYPE html>
<html lang="ru">

<!-- Mirrored from archlinux.org.ru/forum/topic/17866/?page=2 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 04:13:27 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        systemd-nologin.conf, /run/nologin
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://storage.yandexcloud.net/aor-static/static/css/default.css">
    
    
    

    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="../../feeds/posts/index.html" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="../../feeds/topics/index.html" title="Последние темы на форуме" >

    
    
    
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/jquery.formset.min.js"></script>

</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="../../../index.html">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="../../../news/index.html">Новости</a></li>
    <li class="active"><a href="../../index.html">Форум</a></li>
    <li class=""><a href="../../../blogs/index.html">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_(Русский)">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="../../../irc/index.html#chat">IRC</a></li>
      <li class="dropdown">
        <a href="../../../accounts/login/index.html" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="../../../accounts/login/index.html">Вход</a></li>
          <li><a href="../../../accounts/register/index.html">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="../../../messages/inbox/index.html" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="../../../index.html">ArchLinux.org.ru</a></li>


    <li><a href="../../index.html">Начало</a> <span class="divider">/</span></li>
    
        
            
                <li><a href="../../category/2/index.html">Поддержка пользователей</a> <span class="divider">/</span></li>
            
                <li><a href="../../forum/23/index.html">Демоны и загрузка системы</a> <span class="divider">/</span></li>
            
        
        
            <li>systemd-nologin.conf, /run/nologin</li>
        
    
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    
    <div class="topic">
        <h1>systemd-nologin.conf, /run/nologin</h1>
        
            <div class="text-center">
    


    <nav>
        <ul class="pagination">
            
                <li class="previous">
                    <a href="index2679.html?page=1" aria-label="предыдущая страница">
                        <span aria-hidden="true">&laquo;</span>
                        <span class="hidden-xs">предыдущая страница</span>
                    </a>
                </li>
            

            
                
                    
                        <li>
                            <a href="index2679.html?page=1">1</a>
                        </li>
                    
                
            
                
                    
                        <li class="active">
                            <a href="index4658.html?page=2">2 <span class="sr-only">(текущая страница)</span></a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index9ba9.html?page=3">3</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexfdb0.html?page=4">4</a>
                        </li>
                    
                
            

            
                <li class="next">
                    <a href="index9ba9.html?page=3" aria-label="следующая страница">
                        <span class="hidden-xs">следующая страница</span>
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            
        </ul>
    </nav>


</div>

        

        

        <div class="posts">
            
            
                
                




<table class="table table-bordered post post-row
       "
       id="post-195652"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/vasek/index.html">
                <span class="post-username">vasek</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/195652/index.html">#</a>
            4 года, 11 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/vasek/topics/index.html">
                    48
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/vasek/posts/index.html">
                    11320
                </a>
            </div>
            <div>
                Участник с: 17 февраля 2013
            </div>
            
        </td>
        <td class="post-content">
            Сейчас перегрузился с повышенным логированием.<br />Привожу лог в части наличия nologin в нормальной системе<br /><pre><code>arch systemd-tmpfiles[193]: Reading config file &quot;/usr/lib/tmpfiles.d/systemd-nologin.conf&quot;.
arch systemd-tmpfiles[193]: Entry &quot;/run/nologin&quot; does not match any include prefix, skipping.
arch systemd-tmpfiles[286]: Reading config file &quot;/usr/lib/tmpfiles.d/systemd-nologin.conf&quot;.
arch systemd-tmpfiles[286]: Running create action for entry F /run/nologin
arch systemd-tmpfiles[286]: Writing to &quot;/run/nologin&quot;.
arch systemd-tmpfiles[286]: &quot;/run/nologin&quot; has right mode 100644
arch systemd-tmpfiles[286]: Running remove action for entry F /run/nologin</code></pre>
            
                
                    <div class="post-signature">
                        Ошибки не исчезают с опытом - они просто умнеют
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-195656"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/vasek/index.html">
                <span class="post-username">vasek</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/195656/index.html">#</a>
            4 года, 11 месяцев назад
            
                (отредактировано
                
                    4 года, 11 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/vasek/topics/index.html">
                    48
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/vasek/posts/index.html">
                    11320
                </a>
            </div>
            <div>
                Участник с: 17 февраля 2013
            </div>
            
        </td>
        <td class="post-content">
            Провел эксперимент<br />- создал /run/nologin и /etc/nologin<br />- зайти в другую консоль (Ctrl+Alt+F2) разумеется не удалось<br />- перегрузился — файлы /run/nologin и /etc/nologin исчезли<br />Или у тебя действительно какой то баг или ты не все описал?<br />Я не понял - не удается залогинится при загрузке? Или в загруженной системе не удается залогинится другому юзеру? Или не удается залогинится по ssh?
            
                
                    <div class="post-signature">
                        Ошибки не исчезают с опытом - они просто умнеют
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-195711"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/binaryshadow/index.html">
                <span class="post-username">binaryshadow</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/195711/index.html">#</a>
            4 года, 11 месяцев назад
            
                (отредактировано
                
                    4 года, 11 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/de/3c/de3c388e2f57b6c49e7fe0bf2b2d118d.png" alt="binaryshadow avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/binaryshadow/topics/index.html">
                    16
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/binaryshadow/posts/index.html">
                    453
                </a>
            </div>
            <div>
                Участник с: 30 августа 2011
            </div>
            
        </td>
        <td class="post-content">
            1. в другую консоль (Ctrl+Alt+F2) зайти могу.<br />2. в логах /run/nologin нет, есть только nologin<br /><pre><code>сен 27 09:34:59 archpc systemd[579]: pam_nologin(systemd-user:account): conversation failed
сен 27 09:34:48 archpc sddm[349]: Authentication error: &quot;\&quot;System is booting up. See pam_nologin(8)\&quot;&quot;
сен 27 09:32:17 archpc systemd[444]: pam_nologin(systemd-user:account): conversation failed
сен 26 18:06:54 archpc systemd[584]: pam_nologin(systemd-user:account): conversation failed
сен 26 18:06:39 archpc sddm[336]: Authentication error: &quot;\&quot;System is booting up. See pam_nologin(8)\&quot;&quot;
сен 26 18:06:35 archpc sddm[336]: Authentication error: &quot;\&quot;System is booting up. See pam_nologin(8)\&quot;&quot;
сен 26 18:06:27 archpc systemd[440]: pam_nologin(systemd-user:account): conversation failed
сен 26 17:18:37 archpc systemd[457]: pam_nologin(systemd-user:account): conversation failed
сен 22 20:00:29 archpc systemd[597]: pam_nologin(systemd-user:account): conversation failed
сен 22 20:00:12 archpc sddm[340]: Authentication error: &quot;\&quot;System is booting up. See pam_nologin(8)\&quot;&quot;
сен 22 20:00:08 archpc sddm[340]: Authentication error: &quot;\&quot;System is booting up. See pam_nologin(8)\&quot;&quot;
сен 22 19:59:49 archpc systemd[461]: pam_nologin(systemd-user:account): conversation failed
сен 18 09:30:39 archpc systemd[455]: pam_nologin(systemd-user:account): conversation failed
сен 13 12:21:32 archpc systemd[1973]: pam_nologin(systemd-user:account): conversation failed
июл 18 19:43:25 archpc systemd[8171]: pam_nologin(systemd-user:account): conversation failed
июл 18 19:43:11 archpc sddm[351]: Authentication error: &quot;\&quot;System is booting up. See pam_nologin(8)\&quot;&quot;
июл 18 19:43:05 archpc systemd[2022]: pam_nologin(systemd-user:account): conversation failed
июл 17 16:56:57 archpc systemd[587]: pam_nologin(systemd-user:account): conversation failed
</code></pre>При перезагрузке он не удаляется, наверно баг sddm или что-то с правами.<br /><br />Под рутом пускает, но предупреждает Authentication error: &quot;\&quot;System is booting up. See pam_nologin(8)\&quot;&quot;<br />Блокируется только вход под пользователем.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-195714"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/vasek/index.html">
                <span class="post-username">vasek</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/195714/index.html">#</a>
            4 года, 11 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/vasek/topics/index.html">
                    48
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/vasek/posts/index.html">
                    11320
                </a>
            </div>
            <div>
                Участник с: 17 февраля 2013
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>binaryshadow</em><br>в логах /run/nologin нет, есть только nologin</blockquote>Загружался с опцией  <strong>debug</strong>?<br />Я обычно в этих случаях при старте захожу в меню Grub и дописываю нужную опцию, в данном случае debug<br /><blockquote><em>binaryshadow</em><br>в другую консоль (Ctrl+Alt+F2) зайти могу.</blockquote>По теории не должен. А попробуй удали оставшийся (не удаленный) <strong>/run/nologin</strong> и пропиши от root новый <strong>/run/nologin</strong> (а лучше прописать еще и <strong>/etc/nologin</strong>) и попробуй залогиниться в другую консоль.<br />Дальше перегрузиться, чтобы посмотреть останутся оба файла или нет. Плюс к этому проверить удаляются ли эти файлы при запуске без sddm, например, просто при startx.<br />UPD ... если это мешает, то можно временно (до устранения) изменить политику применения модуля pam_nologin
            
                
                    <div class="post-signature">
                        Ошибки не исчезают с опытом - они просто умнеют
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-195719"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/binaryshadow/index.html">
                <span class="post-username">binaryshadow</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/195719/index.html">#</a>
            4 года, 11 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/de/3c/de3c388e2f57b6c49e7fe0bf2b2d118d.png" alt="binaryshadow avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/binaryshadow/topics/index.html">
                    16
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/binaryshadow/posts/index.html">
                    453
                </a>
            </div>
            <div>
                Участник с: 30 августа 2011
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>vasek</em><br>Загружался с опцией debug?</blockquote>Еще не пробовал.<br />Я просто удаляю /usr/lib/tmpfiles.d/systemd-nologin.conf и до следующего обновления systemd всё ок =) Но это не решение.<br /><br /><pre><code>-rw-r--r-- 1 root root   42 сен 28 22:16 nologin</code></pre><br /># cat nologin<br /><pre><code>&quot;System is booting up. See pam_nologin(8)&quot;</code></pre><br />Попробую по тестировать и сообщу.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-195722"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/vasek/index.html">
                <span class="post-username">vasek</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/195722/index.html">#</a>
            4 года, 11 месяцев назад
            
                (отредактировано
                
                    4 года, 11 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/vasek/topics/index.html">
                    48
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/vasek/posts/index.html">
                    11320
                </a>
            </div>
            <div>
                Участник с: 17 февраля 2013
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>binaryshadow</em><br>Я просто удаляю /usr/lib/tmpfiles.d/systemd-nologin.conf</blockquote>По теории достаточно удалить только файлы /run/nologin или /etc/nologin (который обычно создается root ручками).<br />Просто удалять один файл /run/nologin не пробовал?<br /><strike>UPD ... в предыдущем посту забыл отметить, что при создании вручную файлов /run/nologin и /etc/nologin в них желательно приписать какой-нибудь текст, чтобы потом посмотреть - эти  файлы перезаписываются системными или нет.</strike><br />PS - Если попробовать залогиниться в другую консоль с любым из этих файлов, то обычного юзера выкинет и будет выведен этот текст.<br /><br /><strong>EDIT 1</strong> - не прав, конечно, эти файлы перезапишутся системными с другим текстом - нет смыса этого делать. Что то сразу не сообразил.<br /><strong>EDIT 2</strong> - мля ... чем старее, тем хуже и медленнее соображаю. Сам же просил посмотреть содержимое этого файла и забыл.<br /><blockquote><em>binaryshadow</em><br># cat nologin<br />&quot;System is booting up. See pam_nologin(8)&quot;</blockquote>Говорит о том, что при загрузке создался файл <strong>/run/nologin</strong>  с целью, чтобы в этот промежуток времени загрузки больше никто не мог залогиниться. После этого файл удаляется.<br />Файл создает systemd-tmpfiles, а удаляет systemd-user-sessions.service. Аналогично при shutdown.
            
                
                    <div class="post-signature">
                        Ошибки не исчезают с опытом - они просто умнеют
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-195723"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/binaryshadow/index.html">
                <span class="post-username">binaryshadow</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/195723/index.html">#</a>
            4 года, 11 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/de/3c/de3c388e2f57b6c49e7fe0bf2b2d118d.png" alt="binaryshadow avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/binaryshadow/topics/index.html">
                    16
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/binaryshadow/posts/index.html">
                    453
                </a>
            </div>
            <div>
                Участник с: 30 августа 2011
            </div>
            
        </td>
        <td class="post-content">
            Ну, вот, не удаляется он. Если удаляю ручками, то он после перезагрузки снова появляется. Может это Мате косячит?
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-195724"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/vasek/index.html">
                <span class="post-username">vasek</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/195724/index.html">#</a>
            4 года, 11 месяцев назад
            
                (отредактировано
                
                    4 года, 11 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/vasek/topics/index.html">
                    48
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/vasek/posts/index.html">
                    11320
                </a>
            </div>
            <div>
                Участник с: 17 февраля 2013
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>binaryshadow</em><br>Может это Мате косячит?</blockquote>Это гадание. Факт, что после создания файла, последний не удаляется. Когда то читал, что выполняет это systemd-user-sessions.service. И если это так, то выяснить это можно только ковыряясь в исходниках и выполняя отладку. Но это могут только разработчики. Нам, думаю, это не подсилу.<br />Можно попробовать другой DM, а лучше вообще без всякого DM. Если и в этом случае проблема не уйдет, то, возможно, виновник Мате. Но это все предположения.<br />А пока, временно, можно <u>отключить модуль pam_nologin.so</u> , в принципе, на безопасность это не влияет.<br />Запусти команду<br /><strong>find /etc/pam.d -type f -print0 | xargs -0 grep &#39;pam.nologin&#39;</strong><br />Получишь перечень файлов с указанием строк, где этот модуль прописан. Ну и смотри, что тебе нужно, те файлы и редактируй.<br />Например, для обычного входа нужно закоментировать строки с <strong>pam_nologin.so</strong> в файлах <strong>/etc/pam.d/login</strong> и <strong>/etc/pam.d/system-login</strong><br />Не забывай, в некоторых файлах может быть по несколько строк с данным модулем, что будет показано в выводе find<br />Сейчас у себя проделал это. Потом создал файл /run/nologin и прописал в нем слово test. В итоге смог залогиниться в другую консоль. А вот когда снова включил этот модуль, то уже залогиниться не смог - было сообщение test.<br />UPD … Да я не использую никакие DM, а у тебя должен быть еще файлик типа /etc/pam.d/sddm* , вот нужно ли закометировать там, не знаю, но похоже нужно. Пробуй.<br /><br /><strong>EDIT 1</strong> - может в твоем случае достаточно будет отключить модуль pam_nologin.so только в файлах /etc/pam.d/sddm*
            
                
                    <div class="post-signature">
                        Ошибки не исчезают с опытом - они просто умнеют
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-195741"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/binaryshadow/index.html">
                <span class="post-username">binaryshadow</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/195741/index.html">#</a>
            4 года, 11 месяцев назад
            
                (отредактировано
                
                    4 года, 7 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/de/3c/de3c388e2f57b6c49e7fe0bf2b2d118d.png" alt="binaryshadow avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/binaryshadow/topics/index.html">
                    16
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/binaryshadow/posts/index.html">
                    453
                </a>
            </div>
            <div>
                Участник с: 30 августа 2011
            </div>
            
        </td>
        <td class="post-content">
            find /etc/pam.d -type f -print0 | xargs -0 grep &#39;pam.nologin&#39;<br /><pre><code>/etc/pam.d/rlogin:auth       required     pam_nologin.so
/etc/pam.d/sddm-autologin:auth        required    pam_nologin.so
/etc/pam.d/rsh:auth       required     pam_nologin.so
/etc/pam.d/login:auth       requisite    pam_nologin.so
/etc/pam.d/system-login:auth       requisite  pam_nologin.so
/etc/pam.d/system-login:account    required   pam_nologin.so
</code></pre>Спасибо за помощь и информацию. Считаю костылями, правки других файлов. Дождусь нормального решения или сам покопаюсь, кто за сбой не убирает этот файл или кто его создаёт.<br />На текущий момент проблема не решена, имеется только решение с удалением файлов /usr/lib/tmpfiles.d/systemd-nologin.conf и /run/nologin.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-201065"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/vasek/index.html">
                <span class="post-username">vasek</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/201065/index.html">#</a>
            4 года, 6 месяцев назад
            
                (отредактировано
                
                    4 года, 6 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/vasek/topics/index.html">
                    48
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/vasek/posts/index.html">
                    11320
                </a>
            </div>
            <div>
                Участник с: 17 февраля 2013
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>binaryshadow</em><br>На текущий момент проблема не решена, имеется только решение с удалением файлов /usr/lib/tmpfiles.d/systemd-nologin.conf и /run/nologin.</blockquote><a href="https://bugzilla.redhat.com/show_bug.cgi?id=1043212">Здесь</a> обсуждают этот bug уже 3 года<br /><br /><strong>EDIT 1</strong> - достаточно удалить 1 файл -  /run/nologin - можно написать unit, чтобы не удалять в ручную.
            
                
                    <div class="post-signature">
                        Ошибки не исчезают с опытом - они просто умнеют
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
        </div>
        <div>&nbsp;</div>
        
            <div class="text-center">
    


    <nav>
        <ul class="pagination">
            
                <li class="previous">
                    <a href="index2679.html?page=1" aria-label="предыдущая страница">
                        <span aria-hidden="true">&laquo;</span>
                        <span class="hidden-xs">предыдущая страница</span>
                    </a>
                </li>
            

            
                
                    
                        <li>
                            <a href="index2679.html?page=1">1</a>
                        </li>
                    
                
            
                
                    
                        <li class="active">
                            <a href="index4658.html?page=2">2 <span class="sr-only">(текущая страница)</span></a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index9ba9.html?page=3">3</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexfdb0.html?page=4">4</a>
                        </li>
                    
                
            

            
                <li class="next">
                    <a href="index9ba9.html?page=3" aria-label="следующая страница">
                        <span class="hidden-xs">следующая страница</span>
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            
        </ul>
    </nav>


</div>

        

        

        
            
<a href="../../../accounts/register/index.html">Зарегистрироваться</a> или <a href="../../../accounts/login/indexbcd1.html?next=/forum/topic/17866/">войдите</a> чтобы оставить сообщение.

        

        
    </div>

        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

</body>

<!-- Mirrored from archlinux.org.ru/forum/topic/17866/?page=2 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 04:13:27 GMT -->
</html>
