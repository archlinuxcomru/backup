


<!DOCTYPE html>
<html lang="ru">

<!-- Mirrored from archlinux.org.ru/forum/topic/20271/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 04:13:55 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Мультимедийные клавиши ноутбука HP.
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://archlinuxcomru.github.io/backup/src/css/bootstrap.css">
    
    
    

    <script type="text/javascript" src="https://archlinuxcomru.github.io/backup/src/js/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://archlinuxcomru.github.io/backup/src/js/bootstrap.js"></script>
    <script type="text/javascript" src="https://archlinuxcomru.github.io/backup/src/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="../../feeds/posts/index.html" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="../../feeds/topics/index.html" title="Последние темы на форуме" >

    
    
    
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/jquery.formset.min.js"></script>

</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="../../../index.html">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="../../../news/index.html">Новости</a></li>
    <li class="active"><a href="../../index.html">Форум</a></li>
    <li class=""><a href="../../../blogs/index.html">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_(Русский)">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="../../../irc/index.html#chat">IRC</a></li>
      <li class="dropdown">
        <a href="../../../accounts/login/index.html" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="../../../accounts/login/index.html">Вход</a></li>
          <li><a href="../../../accounts/register/index.html">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="../../../messages/inbox/index.html" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="../../../index.html">ArchLinux.org.ru</a></li>


    <li><a href="../../index.html">Начало</a> <span class="divider">/</span></li>
    
        
            
                <li><a href="../../category/2/index.html">Поддержка пользователей</a> <span class="divider">/</span></li>
            
                <li><a href="../../forum/12/index.html">Ядро и Железо</a> <span class="divider">/</span></li>
            
        
        
            <li>Мультимедийные клавиши ноутбука HP.</li>
        
    
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    
    <div class="topic">
        <h1>Мультимедийные клавиши ноутбука HP.</h1>
        
            <div class="text-center">
    



</div>

        

        

        <div class="posts">
            
            
                
                




<table class="table table-bordered post post-row
       "
       id="post-235956"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/Danesteti/index.html">
                <span class="post-username">Danesteti</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/235956/index.html">#</a>
            1 год, 10 месяцев назад
            
                (отредактировано
                
                    1 год, 10 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/Danesteti/topics/index.html">
                    1
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/Danesteti/posts/index.html">
                    1
                </a>
            </div>
            <div>
                Участник с: 18 октября 2020
            </div>
            
        </td>
        <td class="post-content">
            На самом деле, в заголовке я суть описал не очень верно, более точно опишу здесь.<br />Линукс видит и понимает только некоторые мультимедийные клавиши. Основные проблемы связаны с клавишами для повышения/понижения яркости. В xev их не видно совсем, в остальных грабберах клавиш (или как называются эти утилиты) тоже. Видно разве что, в dmesg, <strong>НО</strong> обе клавиши отображаются как один keycode. e02b если не ошибаюсь. acpi_listen их, кстати, тоже не видит. И evtest.<br />Ладно бы только эти две клавиши, с этим ещё можно как-то справиться, но есть и другая проблема.<br />В acpi_listen <em>закрытие крышки ноутбука</em> (не знаю, как ещё это по русски обозвать) детектится как button/wlan. Через systemd из-за этого никак не настроить действие при lid switch.<br /><br />Каким способом это можно исправить?<br />Ноутбук - HP Laptop 15-dw1035ur
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-235996"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/vasek/index.html">
                <span class="post-username">vasek</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/235996/index.html">#</a>
            1 год, 10 месяцев назад
            
                (отредактировано
                
                    1 год, 10 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/vasek/topics/index.html">
                    48
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/vasek/posts/index.html">
                    11320
                </a>
            </div>
            <div>
                Участник с: 17 февраля 2013
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>Danesteti</em><br>Каким способом это можно исправить?</blockquote>Если хочешь, чтобы кто то что то подсказал, нужна информация, а ее нет ...<br />Для начала<br />- какие клавиши выполняют управление подсветкой???<br />- вывод команд при нажатии соответствующих клавиш управления подсветкой (в выводе оставь только нужные строки, относящиеся к нажатию нужных клавиш)<br />    - xev | awk -F&#39;[ )]+&#39; &#39;/^KeyPress/ { a[NR+2] } NR in a { printf &quot;%-3s %s\n&quot;, $5, $8 }&#39;<br />    - sudo evtest /dev/input/eventN    ... где вместо N поставь номер, соответсвующий клавиатуре<br /><strong>PS</strong> - перед запуском команд запусти <strong>journalctl -f</strong> в отдельном терминале, чтобы потом посмотреть наличие ошибок, если они будут<br /><br />В части<br />- <strong>acpi_listen</strong> рекомендую вообще не использовать, все можно сделать без него<br />- <strong>keycode. e02b</strong> - во первых это не keycode, а похоже scancode, а во вторых на ноутах HP такой сканкод раньше не использовался для управления подсветкой ... а потому рекомендую зайти в текстовую консоль (Ctrl+Alt+FN) и запустить <strong>showkey -s</strong> и <strong>showkey -k</strong> чтобы узнать коды нужных клавиш.<br /><br /><strong>EDIT 1</strong> - клавиатура надеюсь родная, встроенная .... а не какая-нибудь внешняя USB
            
                
                    <div class="post-signature">
                        Ошибки не исчезают с опытом - они просто умнеют
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-236016"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/vasek/index.html">
                <span class="post-username">vasek</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/236016/index.html">#</a>
            1 год, 10 месяцев назад
            
                (отредактировано
                
                    1 год, 10 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/vasek/topics/index.html">
                    48
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/vasek/posts/index.html">
                    11320
                </a>
            </div>
            <div>
                Участник с: 17 февраля 2013
            </div>
            
        </td>
        <td class="post-content">
            Хотя, если есть желание, можно обойтись без всяких вспомогательных утилит и проанализировать raw date нужных комбинаций клавиш … и самому распарсить вывод<br />Для этого пишем в терминале (любом) команду <strong>sudo od -tx1 /dev/input/eventN</strong> …  вместо <strong>N</strong> пишем свое значение<br />- жмем Enter … и больше ничего не трогаем, просто смотрим что нам вывелось на монитор, возможны 2 варианта<br /><strong>1</strong> - ничего не вывелось после запуска команды - это самое лучшее - и просто вводим нужную комбинацию клавиш …. и далее вообще не трогаем клавиатуру, а пользуемся только мышкой и выделяем полученные байты и копируем/сохранеяем. После чего завершаем действие команды комбинацией Ctrl+D …. лучше, чтобы не запутаться в байтах, новую комбинацию начинать по новой.<br /><strong>2</strong> - будет выведено несколько строк, запоминаем номер последней строки … и действуем, как в п.1, но только НЕ выделяем для копирования строки, которые были выведены до нажатия комбинации … вообщем строки, которые запомнили.<br />Все ...  эти сохраненные байты распарсим и узнаем и сканкод и кейкод примененной комбинации клавиш (при желании узнаем даже и дату нажатия и время нажатия)<br /><br />Как пример, после запуска команды<br /><strong>sudo od -tx1 /dev/input/event3</strong><br />видим следующие 4 строки<br /><pre><code>0000000 25 ce 8d 5f 00 00 00 00 76 13 0c 00 00 00 00 00
0000020 04 00 04 00 1c 00 00 00 25 ce 8d 5f 00 00 00 00
0000040 76 13 0c 00 00 00 00 00 01 00 1c 00 00 00 00 00
0000060 25 ce 8d 5f 00 00 00 00 76 13 0c 00 00 00 00 00</code></pre>далее нажимаем комбинацию <strong>Fn+F2</strong> и появятся следующие строки, которые и копируем/сохраняем<br /><pre><code>0000100 00 00 00 00 00 00 00 00 2b ce 8d 5f 00 00 00 00
0000120 bf 1f 0f 00 00 00 00 00 04 00 04 00 92 00 00 00
0000140 2b ce 8d 5f 00 00 00 00 bf 1f 0f 00 00 00 00 00
0000160 01 00 e0 00 01 00 00 00 2b ce 8d 5f 00 00 00 00
0000200 bf 1f 0f 00 00 00 00 00 00 00 00 00 00 00 00 00
0000220 2c ce 8d 5f 00 00 00 00 d1 6b 01 00 00 00 00 00
0000240 04 00 04 00 92 00 00 00 2c ce 8d 5f 00 00 00 00
0000260 d1 6b 01 00 00 00 00 00 01 00 e0 00 00 00 00 00
0000300 2c ce 8d 5f 00 00 00 00 d1 6b 01 00 00 00 00 00</code></pre>Находим последовательность из 6 байт типа  <strong>00 04 00 04 00 XX</strong>, где <strong>XX</strong> зависит от комбинации клавиш и определяет сканкод этой комбинации, эта последовательность прописана дважды  - в моем случае это  комбинация  <strong>00 04 00 04 00 92</strong> и сканкод равен 92<br />Далее находим 2-е последовательности (одна нажатие, другая отжатие) из 6 байт  типа <strong>00 01 00 YY 00 01</strong> и  <strong>00 01 00 YY 00 00</strong>, где YY зависит от комбинации клавиш и определяет кейкод этой комбинации  - в моем случае <strong>YY = e0</strong> или в 10-ой системе <strong>224</strong> - это и есть кейкод.
            
                
                    <div class="post-signature">
                        Ошибки не исчезают с опытом - они просто умнеют
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-236023"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/vasek/index.html">
                <span class="post-username">vasek</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/236023/index.html">#</a>
            1 год, 10 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/vasek/topics/index.html">
                    48
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/vasek/posts/index.html">
                    11320
                </a>
            </div>
            <div>
                Участник с: 17 февраля 2013
            </div>
            
        </td>
        <td class="post-content">
            <strong>Danesteti</strong>, а вообще рекомендую использовать для проблемных мультимедийных комбинаций <strong>xbindkeys</strong>  - это намного проще ...<br />Чтобы решить проблему мультимедийных клавиш нужно много знать, да и то не всегда получается. У меня, например, все мультимедийные клавиши определяются, прописаны, НО не работают ... делал много подходов, применял много разных способов ... и даже уже не для работы, а просто ради интереса, но так и не смог решить эту проблему. А вот используя  <strong>xbindkeys</strong> проблема решается быстро ... но при использовании tiling WM не нужен и xbindkeys - все решается встроенным функционалом.
            
                
                    <div class="post-signature">
                        Ошибки не исчезают с опытом - они просто умнеют
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
        </div>
        <div>&nbsp;</div>
        
            <div class="text-center">
    



</div>

        

        

        
            
<a href="../../../accounts/register/index.html">Зарегистрироваться</a> или <a href="../../../accounts/login/index3370.html?next=/forum/topic/20271/">войдите</a> чтобы оставить сообщение.

        

        
    </div>

        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

</body>

<!-- Mirrored from archlinux.org.ru/forum/topic/20271/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 04:13:55 GMT -->
</html>
