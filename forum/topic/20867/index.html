


<!DOCTYPE html>
<html lang="ru">

<!-- Mirrored from archlinux.org.ru/forum/topic/20867/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 04:13:50 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        прошу помощи с отключением матрицы ноутбука (amdgpu)
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://storage.yandexcloud.net/aor-static/static/css/default.css">
    
    
    

    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="../../feeds/posts/index.html" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="../../feeds/topics/index.html" title="Последние темы на форуме" >

    
    
    
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/jquery.formset.min.js"></script>

</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="../../../index.html">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="../../../news/index.html">Новости</a></li>
    <li class="active"><a href="../../index.html">Форум</a></li>
    <li class=""><a href="../../../blogs/index.html">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_(Русский)">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="../../../irc/index.html#chat">IRC</a></li>
      <li class="dropdown">
        <a href="../../../accounts/login/index.html" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="../../../accounts/login/index.html">Вход</a></li>
          <li><a href="../../../accounts/register/index.html">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="../../../messages/inbox/index.html" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="../../../index.html">ArchLinux.org.ru</a></li>


    <li><a href="../../index.html">Начало</a> <span class="divider">/</span></li>
    
        
            
                <li><a href="../../category/2/index.html">Поддержка пользователей</a> <span class="divider">/</span></li>
            
                <li><a href="../../forum/12/index.html">Ядро и Железо</a> <span class="divider">/</span></li>
            
        
        
            <li>прошу помощи с отключением матрицы ноутбука (amdgpu)</li>
        
    
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    
    <div class="topic">
        <h1>прошу помощи с отключением матрицы ноутбука (amdgpu)</h1>
        
            <div class="text-center">
    


    <nav>
        <ul class="pagination">
            
                <li class="previous disabled">
                    <span>
                        <span aria-hidden="true">&laquo;</span>
                        <span class="hidden-xs">предыдущая страница</span>
                    </span>
                </li>
            

            
                
                    
                        <li class="active">
                            <a href="index2679.html?page=1">1 <span class="sr-only">(текущая страница)</span></a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index4658.html?page=2">2</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index9ba9.html?page=3">3</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexfdb0.html?page=4">4</a>
                        </li>
                    
                
            

            
                <li class="next">
                    <a href="index4658.html?page=2" aria-label="следующая страница">
                        <span class="hidden-xs">следующая страница</span>
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            
        </ul>
    </nav>


</div>

        

        

        <div class="posts">
            
            
                
                




<table class="table table-bordered post post-row
       "
       id="post-247784"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/c.o.d.e.m.a.s.t.e.r/index.html">
                <span class="post-username">c.o.d.e.m.a.s.t.e.r</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/247784/index.html">#</a>
            1 год, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/c.o.d.e.m.a.s.t.e.r/topics/index.html">
                    3
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/c.o.d.e.m.a.s.t.e.r/posts/index.html">
                    27
                </a>
            </div>
            <div>
                Участник с: 20 июня 2018
            </div>
            
        </td>
        <td class="post-content">
            доброго времени, ув. форумчане. Прошу помощи. Ситуация следующая - купил ноут б/у с нерабочей матрицей. Бывший владелец сказал что подключает ноут к внешнему монитору и проблем нет при таком подключении. Продавец не соврал - так и было. Действительно некоторое время ноут работал без каких либо проблем, матрица не светилась, её как будто небыло вообще в системе (не виделась ни драйверами, нигде вообще). Теперь ситуация такая - драйвер в Виндовс я поставить не могу, он ставится но ноут с установленным драйвером AMD не загружается, идёт циклически на перезагрузку (процессор Ryzen 2500U со встроенным видео Vega 8). На данный момент Виндовс работает только со стандартным драйвером VGA. Решил попробовать ArchLinux, тут сиутация получше, ноут начинает загружаться, после первых строк загрузки ядра идёт смена видеорежима, в этот момент внешний монитор тухнет и пауза секунд 40, после неё ноут загружается дальше. При самой первой загрузке графической оболочки разрешение 640*480, так потому что матрица ноута распознаётся только с таким разрешением (её настоящее разрешение 1920*1080), соответственно внешний монитор тоже включается с таким же разрешением (дублирование). Отключаю в настройках матрицу ноута, выставляю на внешнем мониторе 1920*1080 и с ноутом можно нормально работать. В чём проблема? в том что использую оболочку XFCE и она теперь запускается с моими настройками - матрица ноута отключена а внешний монитор с разрешением FullHD. Но при попытке сменить пользователя или банально переключиться в tty включается gdm который пытается вывести изображение на матрицу ноута. При этом возникает снова пауза в 40 секунд. Такая же пауза возникает когда ноуту даёшь команду перезагрузки. В логах ядра по dmesg видно что видеоадаптер не может считать EDID из матрицы ноута и потому такая задержка, но какая причина этого - матрица ноута или поломка самого видеоадаптера (отслоение из за перегрева, бывший владелец очень много играл на этом ноуте) - неизвестна. Стоит задача полностью отключить матрицу, чтобы система её вообще не видела. Поскольку система загружается через grub в /etc/default/grub.cfg дописал в &quot;GRUB_CMDLINE_LINUX_DEFAULT=&quot; параметр video=eDP:d и выполнил переконфигурацию grub. Итог - это не помогает. ничего не меняется, во время загрузки сообщения ядра всё равно не выводятся на внешний монитор и матрица не отключается, опять пауза в 40 сек и тормоза при переключении на консоль, также пауза при попытке вызвать gdm<br />что делаю не так? возможно это связано с тем что адаптер AMD а не Nvidia или Intel и нужно указывать какой то другой параметр ядру. Либо нужно создать файл описания внешнего монитора в настройках xorg чтобы небыло автодетекта, но ведь по идее video=eDP:d должно бы полностью отключать вывод на матрицу а это не так. Если уже на загруженном ноуте выполнить в терминале команду xrandr, она пишет -<br />eDP connected (normal left inverted right x axis y axis)<br />   640x480       59.94<br />HDMI-A-0 connected primary 1920x1080+0+0 (normal left inverted right x axis y axis) 476mm x 268mm<br />   1920x1080     60.00*+<br /><br />это при том, что в настройках дисплея матрица ноута выключена и основным дисплеем назначен внешний монитор
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-247786"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/vs220/index.html">
                <span class="post-username">vs220</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/247786/index.html">#</a>
            1 год, 1 месяц назад
            
                (отредактировано
                
                    1 год, 1 месяц назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/vs220/topics/index.html">
                    22
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/vs220/posts/index.html">
                    8070
                </a>
            </div>
            <div>
                Участник с: 16 августа 2009
            </div>
            
        </td>
        <td class="post-content">
            Ядро продолжает видеть матрицу?<br />Гляньте вывод на предмет ее наличия, если есть то в параметры ядра запрет на нее надо, возможно неправильно указали название.<br /><pre><code>ls  /sys/class/drm
 sudo  dmesg | grep -E &quot;VGA|HDMI&quot;
# и в выводе  xrandr она  есть? полный вывод
 xrandr --listmonitors
# и проверить
cat /proc/cmdline
</code></pre>правильное название берите из вывода ls  /sys/class/drm а не из xrandr<br />для запрета d на матрицу, e на экран<br />примерно в параметры ядра <pre><code>video=eDP-1:d video=HDMI-A-1:e</code></pre>
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-247792"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/RusWolf/index.html">
                <span class="post-username">RusWolf</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/247792/index.html">#</a>
            1 год, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/8a/00/8a00073bdfb852ab8504f1e6d4c044f4.png" alt="RusWolf avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/RusWolf/topics/index.html">
                    11
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/RusWolf/posts/index.html">
                    2394
                </a>
            </div>
            <div>
                Участник с: 16 июля 2016
            </div>
            
        </td>
        <td class="post-content">
            А физически, шлейф матрицы, просто отключить не легче?
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-247804"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/c.o.d.e.m.a.s.t.e.r/index.html">
                <span class="post-username">c.o.d.e.m.a.s.t.e.r</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/247804/index.html">#</a>
            1 год, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/c.o.d.e.m.a.s.t.e.r/topics/index.html">
                    3
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/c.o.d.e.m.a.s.t.e.r/posts/index.html">
                    27
                </a>
            </div>
            <div>
                Участник с: 20 июня 2018
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>RusWolf</em><br>А физически, шлейф матрицы, просто отключить не легче?</blockquote>да была такая мысль... Дело в том, что проблема эта гуляющая. Боюсь всё таки причина в перегреве GPU, бывший владелец признался что на этом ноуте прошёл GTA V, а сколько ещё он играл - неизвестно. После того как в Виндовс вообще перестал ставиться драйвер AMD я некоторое время использовал ноут на стандартном драйвере VGA, время от времени пробуя поставить драйвер. И действительно бывали периоды когда он ставился и внешний монитор нормально работал, можно было и в игры поиграть. А было и такое что сама матрица включалась и работала (конечно и внешний монитор при этом работал). поскольку проблема вот такая гуляющая не хочется лезть отсоединять шлейф, иногда есть потребность этот ноут поносить с собой, и если случайно матрица заработает то она так сможет проработать долгое время если не нагружать играми (последний раз когда матрица включилась ноут работал почти месяц без проблем, потом один раз поиграл и матрица снова потухла).
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-247805"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/c.o.d.e.m.a.s.t.e.r/index.html">
                <span class="post-username">c.o.d.e.m.a.s.t.e.r</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/247805/index.html">#</a>
            1 год, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/c.o.d.e.m.a.s.t.e.r/topics/index.html">
                    3
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/c.o.d.e.m.a.s.t.e.r/posts/index.html">
                    27
                </a>
            </div>
            <div>
                Участник с: 20 июня 2018
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>vs220</em><br>Ядро продолжает видеть матрицу?<br />Гляньте вывод на предмет ее наличия, если есть то в параметры ядра запрет на нее надо, возможно неправильно указали название.<br />ls  /sys/class/drm</blockquote>[lenovo a1]# ls /sys/class/drm<br />card0       card0-DP-2   card0-HDMI-A-1  ttm<br />card0-DP-1  card0-eDP-1  renderD128      version
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-247806"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/c.o.d.e.m.a.s.t.e.r/index.html">
                <span class="post-username">c.o.d.e.m.a.s.t.e.r</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/247806/index.html">#</a>
            1 год, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/c.o.d.e.m.a.s.t.e.r/topics/index.html">
                    3
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/c.o.d.e.m.a.s.t.e.r/posts/index.html">
                    27
                </a>
            </div>
            <div>
                Участник с: 20 июня 2018
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>vs220</em><br>правильное название берите из вывода ls /sys/class/drm а не из xrandr</blockquote>это и было моей ошибкой. Спасибо большое, помогло. Теперь ноут загружается моментально без всяких пауз и не видит матрицу. Удивлён что в xrandr одно а в drm другое.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-247807"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/c.o.d.e.m.a.s.t.e.r/index.html">
                <span class="post-username">c.o.d.e.m.a.s.t.e.r</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/247807/index.html">#</a>
            1 год, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/c.o.d.e.m.a.s.t.e.r/topics/index.html">
                    3
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/c.o.d.e.m.a.s.t.e.r/posts/index.html">
                    27
                </a>
            </div>
            <div>
                Участник с: 20 июня 2018
            </div>
            
        </td>
        <td class="post-content">
            раз уж есть такая проблема у меня, спрошу ещё.. На данный момент по симптомам сложно понять в чём всё таки причина - либо матрица ноута некорректно сообщает ядру данные EDID (в логе dmesg есть запись о том что драйвер адаптера не может вычитать edid из eDP), либо всё таки перегретый процессор имеет где то отслоение кристалла (или отходит где то от материнки) и возникает такая проблема, поэтому хотелось бы уточнить - можно ли попытаться вручную запустить матрицу?<br />что я уже попробовал. Вычитал на каком то форуме параметры матрицы ноута Леново которая имеет разрешение FullHD, далее выполнил следующие команды -<br />xrandr --newmode &quot;1920x1080_60.00&quot;  173.00  1920 2048 2248 2576  1080 1083 1088 1120 -hsync +vsync<br />xrandr --addmode eDP 1920x1080_60.00<br />xrandr --output eDP --mode 1920x1080_60.00<br /><br />выдаёт следующее - xrandr: Configure crtc 1 failed<br />возможно причина в том, что я ошибочно указываю вывод? ведь ядру нужно было передать video=eDP-1:d а я передавал video=eDP:d ориентируясь на xrandr<br /><br />и второй вопрос. Такого указания разрешения через добавление режима достаточно чтобы протестировать работу матрицы?<br />или же нужно принудительно создать файл настроек монитора в /etc/X11/xorg.conf ?
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-247808"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/vasek/index.html">
                <span class="post-username">vasek</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/247808/index.html">#</a>
            1 год, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/vasek/topics/index.html">
                    48
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/vasek/posts/index.html">
                    11320
                </a>
            </div>
            <div>
                Участник с: 17 февраля 2013
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>c.o.d.e.m.a.s.t.e.r</em><br>в логе dmesg есть запись о том что драйвер адаптера не может вычитать edid из eDP</blockquote>Что конкретно в логах?<br />И посмотри какие имеются edid<br /><strong>ls -1 /sys/class/drm/*/edid</strong><br /><pre><code>/sys/class/drm/card0-DP-1/edid
/sys/class/drm/card0-HDMI-A-1/edid
/sys/class/drm/card0-LVDS-1/edid
/sys/class/drm/card0-VGA-1/edid</code></pre>
            
                
                    <div class="post-signature">
                        Ошибки не исчезают с опытом - они просто умнеют
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-247812"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/c.o.d.e.m.a.s.t.e.r/index.html">
                <span class="post-username">c.o.d.e.m.a.s.t.e.r</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/247812/index.html">#</a>
            1 год, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/c.o.d.e.m.a.s.t.e.r/topics/index.html">
                    3
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/c.o.d.e.m.a.s.t.e.r/posts/index.html">
                    27
                </a>
            </div>
            <div>
                Участник с: 20 июня 2018
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>vasek</em><br>Что конкретно в логах?</blockquote>вот, отсортировал по amdgpu<br /><br />[lenovo a1]# dmesg | grep amdgpu<br />[    3.985726] [drm] amdgpu kernel modesetting enabled.<br />[    3.985864] amdgpu: Topology: Add APU node [0x0:0x0]<br />[    3.985926] fb0: switching to amdgpudrmfb from VESA VGA<br />[    3.986070] amdgpu 0000:04:00.0: vgaarb: deactivate vga console<br />[    3.986259] amdgpu 0000:04:00.0: amdgpu: Trusted Memory Zone (TMZ) feature disabled as experimental (default)<br />[    4.025412] amdgpu 0000:04:00.0: amdgpu: Fetched VBIOS from ROM BAR<br />[    4.025415] amdgpu: ATOM BIOS: 113-RAVEN-107<br />[    4.025779] amdgpu 0000:04:00.0: amdgpu: VRAM: 1024M 0x000000F400000000 - 0x000000F43FFFFFFF (1024M used)<br />[    4.025780] amdgpu 0000:04:00.0: amdgpu: GART: 1024M 0x0000000000000000 - 0x000000003FFFFFFF<br />[    4.025782] amdgpu 0000:04:00.0: amdgpu: AGP: 267419648M 0x000000F800000000 - 0x0000FFFFFFFFFFFF<br />[    4.025951] [drm] amdgpu: 1024M of VRAM memory ready<br />[    4.025954] [drm] amdgpu: 3072M of GTT memory ready.<br />[    4.032388] amdgpu: hwmgr_sw_init smu backed is smu10_smu<br />[    4.279436] amdgpu 0000:04:00.0: amdgpu: RAS: optional ras ta ucode is not available<br />[    4.302737] amdgpu 0000:04:00.0: amdgpu: RAP: optional rap ta ucode is not available<br />[    4.310282] snd_hda_intel 0000:04:00.1: bound 0000:04:00.0 (ops amdgpu_dm_audio_component_bind_ops [amdgpu])<br />[    4.901842] [drm:retrieve_link_cap [amdgpu]] *ERROR* retrieve_link_cap: Read dpcd data failed.<br />[    5.337730] [drm:dc_link_detect_helper [amdgpu]] *ERROR* No EDID read.<br />[    5.502289] amdgpu: Topology: Add APU node [0x15dd:0x1002]<br />[    5.502294] amdgpu 0000:04:00.0: amdgpu: SE 1, SH per SE 1, CU per SH 11, active_cu_number 8<br />[    5.503505] fbcon: amdgpudrmfb (fb0) is primary device<br />[    5.653345] amdgpu 0000:04:00.0: [drm] fb0: amdgpudrmfb frame buffer device<br />[    5.682919] amdgpu 0000:04:00.0: amdgpu: ring gfx uses VM inv eng 0 on hub 0<br />[    5.682923] amdgpu 0000:04:00.0: amdgpu: ring comp_1.0.0 uses VM inv eng 1 on hub 0<br />[    5.682926] amdgpu 0000:04:00.0: amdgpu: ring comp_1.1.0 uses VM inv eng 4 on hub 0<br />[    5.682928] amdgpu 0000:04:00.0: amdgpu: ring comp_1.2.0 uses VM inv eng 5 on hub 0<br />[    5.682930] amdgpu 0000:04:00.0: amdgpu: ring comp_1.3.0 uses VM inv eng 6 on hub 0<br />[    5.682932] amdgpu 0000:04:00.0: amdgpu: ring comp_1.0.1 uses VM inv eng 7 on hub 0<br />[    5.682934] amdgpu 0000:04:00.0: amdgpu: ring comp_1.1.1 uses VM inv eng 8 on hub 0<br />[    5.682936] amdgpu 0000:04:00.0: amdgpu: ring comp_1.2.1 uses VM inv eng 9 on hub 0<br />[    5.682938] amdgpu 0000:04:00.0: amdgpu: ring comp_1.3.1 uses VM inv eng 10 on hub 0<br />[    5.682941] amdgpu 0000:04:00.0: amdgpu: ring kiq_2.1.0 uses VM inv eng 11 on hub 0<br />[    5.682943] amdgpu 0000:04:00.0: amdgpu: ring sdma0 uses VM inv eng 0 on hub 1<br />[    5.682946] amdgpu 0000:04:00.0: amdgpu: ring vcn_dec uses VM inv eng 1 on hub 1<br />[    5.682948] amdgpu 0000:04:00.0: amdgpu: ring vcn_enc0 uses VM inv eng 4 on hub 1<br />[    5.682950] amdgpu 0000:04:00.0: amdgpu: ring vcn_enc1 uses VM inv eng 5 on hub 1<br />[    5.682952] amdgpu 0000:04:00.0: amdgpu: ring jpeg_dec uses VM inv eng 6 on hub 1<br />[    5.705375] [drm] Initialized amdgpu 3.40.0 20150101 for 0000:04:00.0 on minor 0<br />[    5.731850] audit: type=1130 audit(1628004050.512:56): pid=1 uid=0 auid=4294967295 ses=4294967295 subj==unconfined msg=&#39;unit=systemd-backlight@backlight:amdgpu_bl0 comm=&quot;systemd&quot; exe=&quot;/usr/lib/systemd/systemd&quot; hostname=? addr=? terminal=? res=failed&#39;<br /><br />тут присутствует запись:<br />5.337730] [drm:dc_link_detect_helper [amdgpu]] *ERROR* No EDID read.<br /><br />соответственно драйвер не знает какие параметры у матрицы ноута, и видит матрицу только с разрешением 640*480, при этом если в настройках XFCE включить матрицу, то светится подсветка но нет самого изображения. Варианта три - либо неправильно задаётся это разрешение или сама матрица неправильно обрабатывает изображение или сбоит GPU и причина в нём. Если к примеру загрузить с флешки чистый линукс без настроек, то внешний монитор будет с разрешением 640*480, матрица ноута светится и видимо она тоже должна была бы вывести изображение в таком разрешении но изображения нет, только подсветка. При этом для eDP (матрицы ноута) в настройках можно выбрать только 640*480, а вот для внешнего монитора (HDMI-A-0) можно выбрать все возможные разрешения которые есть у монитора. Поскольку увидел запись в логах *ERROR* No EDID read. сделал вывод что драйвер не может вычитать из матрицы параметры потому и не может её включить.<br /><br /><blockquote><em>vasek</em><br>И посмотри какие имеются edid</blockquote>[lenovo a1]# ls -1 /sys/class/drm/*/edid<br />/sys/class/drm/card0-DP-1/edid<br />/sys/class/drm/card0-DP-2/edid<br />/sys/class/drm/card0-eDP-1/edid<br />/sys/class/drm/card0-HDMI-A-1/edid
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-247813"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/c.o.d.e.m.a.s.t.e.r/index.html">
                <span class="post-username">c.o.d.e.m.a.s.t.e.r</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/247813/index.html">#</a>
            1 год, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/c.o.d.e.m.a.s.t.e.r/topics/index.html">
                    3
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/c.o.d.e.m.a.s.t.e.r/posts/index.html">
                    27
                </a>
            </div>
            <div>
                Участник с: 20 июня 2018
            </div>
            
        </td>
        <td class="post-content">
            лог dmesg из предыдущего сообщения - это при настройке ядра video=eDP-1:d<br /><br />убрал из настроек ядра отключение матрицы eDP и вот как выглядит лог теперь:<br /><br />[lenovo a1]# dmesg | grep amdgpu<br />[    4.000911] [drm] amdgpu kernel modesetting enabled.<br />[    4.001029] amdgpu: Topology: Add APU node [0x0:0x0]<br />[    4.001077] fb0: switching to amdgpudrmfb from VESA VGA<br />[    4.001190] amdgpu 0000:04:00.0: vgaarb: deactivate vga console<br />[    4.001307] amdgpu 0000:04:00.0: amdgpu: Trusted Memory Zone (TMZ) feature disabled as experimental (default)<br />[    4.036446] amdgpu 0000:04:00.0: amdgpu: Fetched VBIOS from ROM BAR<br />[    4.036448] amdgpu: ATOM BIOS: 113-RAVEN-107<br />[    4.036865] amdgpu 0000:04:00.0: amdgpu: VRAM: 1024M 0x000000F400000000 - 0x000000F43FFFFFFF (1024M used)<br />[    4.036866] amdgpu 0000:04:00.0: amdgpu: GART: 1024M 0x0000000000000000 - 0x000000003FFFFFFF<br />[    4.036868] amdgpu 0000:04:00.0: amdgpu: AGP: 267419648M 0x000000F800000000 - 0x0000FFFFFFFFFFFF<br />[    4.037083] [drm] amdgpu: 1024M of VRAM memory ready<br />[    4.037089] [drm] amdgpu: 3072M of GTT memory ready.<br />[    4.045869] amdgpu: hwmgr_sw_init smu backed is smu10_smu<br />[    4.302485] amdgpu 0000:04:00.0: amdgpu: RAS: optional ras ta ucode is not available<br />[    4.336047] amdgpu 0000:04:00.0: amdgpu: RAP: optional rap ta ucode is not available<br />[    4.342950] snd_hda_intel 0000:04:00.1: bound 0000:04:00.0 (ops amdgpu_dm_audio_component_bind_ops [amdgpu])<br />[    4.951045] [drm:retrieve_link_cap [amdgpu]] *ERROR* retrieve_link_cap: Read dpcd data failed.<br />[    5.394796] [drm:dc_link_detect_helper [amdgpu]] *ERROR* No EDID read.<br />[    5.559139] amdgpu: Topology: Add APU node [0x15dd:0x1002]<br />[    5.559144] amdgpu 0000:04:00.0: amdgpu: SE 1, SH per SE 1, CU per SH 11, active_cu_number 8<br />[    5.560367] fbcon: amdgpudrmfb (fb0) is primary device<br />[   25.672507] [drm:atom_op_jump [amdgpu]] *ERROR* atombios stuck in loop for more than 20secs aborting<br />[   25.672573] [drm:amdgpu_atom_execute_table_locked [amdgpu]] *ERROR* atombios stuck executing C848 (len 907, WS 0, PS 0) @ 0xC9A9<br />[   25.672637] [drm:amdgpu_atom_execute_table_locked [amdgpu]] *ERROR* atombios stuck executing C702 (len 326, WS 0, PS 0) @ 0xC78D<br />[   25.672720] [drm:dcn10_link_encoder_enable_dp_output [amdgpu]] *ERROR* dcn10_link_encoder_enable_dp_output: Failed to execute VBIOS command table!<br />[   46.319178] [drm:atom_op_jump [amdgpu]] *ERROR* atombios stuck in loop for more than 20secs aborting<br />[   46.319243] [drm:amdgpu_atom_execute_table_locked [amdgpu]] *ERROR* atombios stuck executing C848 (len 907, WS 0, PS 0) @ 0xC99C<br />[   46.319307] [drm:amdgpu_atom_execute_table_locked [amdgpu]] *ERROR* atombios stuck executing C702 (len 326, WS 0, PS 0) @ 0xC78D<br />[   46.319391] [drm:dcn10_link_encoder_enable_dp_output [amdgpu]] *ERROR* dcn10_link_encoder_enable_dp_output: Failed to execute VBIOS command table!<br />[   66.985833] [drm:atom_op_jump [amdgpu]] *ERROR* atombios stuck in loop for more than 20secs aborting<br />[   66.985898] [drm:amdgpu_atom_execute_table_locked [amdgpu]] *ERROR* atombios stuck executing C848 (len 907, WS 0, PS 0) @ 0xC99C<br />[   66.985962] [drm:amdgpu_atom_execute_table_locked [amdgpu]] *ERROR* atombios stuck executing C702 (len 326, WS 0, PS 0) @ 0xC78D<br />[   66.986046] [drm:dcn10_link_encoder_enable_dp_output [amdgpu]] *ERROR* dcn10_link_encoder_enable_dp_output: Failed to execute VBIOS command table!<br />[   87.652505] [drm:atom_op_jump [amdgpu]] *ERROR* atombios stuck in loop for more than 20secs aborting<br />[   87.652570] [drm:amdgpu_atom_execute_table_locked [amdgpu]] *ERROR* atombios stuck executing C848 (len 907, WS 0, PS 0) @ 0xC99C<br />[   87.652634] [drm:amdgpu_atom_execute_table_locked [amdgpu]] *ERROR* atombios stuck executing C702 (len 326, WS 0, PS 0) @ 0xC78D<br />[   87.652717] [drm:dcn10_link_encoder_enable_dp_output [amdgpu]] *ERROR* dcn10_link_encoder_enable_dp_output: Failed to execute VBIOS command table!<br />[   87.775360] amdgpu 0000:04:00.0: [drm] fb0: amdgpudrmfb frame buffer device<br />[   87.789292] amdgpu 0000:04:00.0: amdgpu: ring gfx uses VM inv eng 0 on hub 0<br />[   87.789296] amdgpu 0000:04:00.0: amdgpu: ring comp_1.0.0 uses VM inv eng 1 on hub 0<br />[   87.789299] amdgpu 0000:04:00.0: amdgpu: ring comp_1.1.0 uses VM inv eng 4 on hub 0<br />[   87.789301] amdgpu 0000:04:00.0: amdgpu: ring comp_1.2.0 uses VM inv eng 5 on hub 0<br />[   87.789303] amdgpu 0000:04:00.0: amdgpu: ring comp_1.3.0 uses VM inv eng 6 on hub 0<br />[   87.789305] amdgpu 0000:04:00.0: amdgpu: ring comp_1.0.1 uses VM inv eng 7 on hub 0<br />[   87.789307] amdgpu 0000:04:00.0: amdgpu: ring comp_1.1.1 uses VM inv eng 8 on hub 0<br />[   87.789309] amdgpu 0000:04:00.0: amdgpu: ring comp_1.2.1 uses VM inv eng 9 on hub 0<br />[   87.789311] amdgpu 0000:04:00.0: amdgpu: ring comp_1.3.1 uses VM inv eng 10 on hub 0<br />[   87.789313] amdgpu 0000:04:00.0: amdgpu: ring kiq_2.1.0 uses VM inv eng 11 on hub 0<br />[   87.789316] amdgpu 0000:04:00.0: amdgpu: ring sdma0 uses VM inv eng 0 on hub 1<br />[   87.789318] amdgpu 0000:04:00.0: amdgpu: ring vcn_dec uses VM inv eng 1 on hub 1<br />[   87.789320] amdgpu 0000:04:00.0: amdgpu: ring vcn_enc0 uses VM inv eng 4 on hub 1<br />[   87.789322] amdgpu 0000:04:00.0: amdgpu: ring vcn_enc1 uses VM inv eng 5 on hub 1<br />[   87.789324] amdgpu 0000:04:00.0: amdgpu: ring jpeg_dec uses VM inv eng 6 on hub 1<br />[   87.804520] [drm] Initialized amdgpu 3.40.0 20150101 for 0000:04:00.0 on minor 0<br />[   87.834367] audit: type=1130 audit(1628005616.599:59): pid=1 uid=0 auid=4294967295 ses=4294967295 subj==unconfined msg=&#39;unit=systemd-backlight@backlight:amdgpu_bl0 comm=&quot;systemd&quot; exe=&quot;/usr/lib/systemd/systemd&quot; hostname=? addr=? terminal=? res=success&#39;
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
        </div>
        <div>&nbsp;</div>
        
            <div class="text-center">
    


    <nav>
        <ul class="pagination">
            
                <li class="previous disabled">
                    <span>
                        <span aria-hidden="true">&laquo;</span>
                        <span class="hidden-xs">предыдущая страница</span>
                    </span>
                </li>
            

            
                
                    
                        <li class="active">
                            <a href="index2679.html?page=1">1 <span class="sr-only">(текущая страница)</span></a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index4658.html?page=2">2</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index9ba9.html?page=3">3</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexfdb0.html?page=4">4</a>
                        </li>
                    
                
            

            
                <li class="next">
                    <a href="index4658.html?page=2" aria-label="следующая страница">
                        <span class="hidden-xs">следующая страница</span>
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            
        </ul>
    </nav>


</div>

        

        

        
            
<a href="../../../accounts/register/index.html">Зарегистрироваться</a> или <a href="../../../accounts/login/index2ce4.html?next=/forum/topic/20867/">войдите</a> чтобы оставить сообщение.

        

        
    </div>

        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

</body>

<!-- Mirrored from archlinux.org.ru/forum/topic/20867/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 04:13:50 GMT -->
</html>
