


<!DOCTYPE html>
<html lang="ru">

<!-- Mirrored from archlinux.org.ru/forum/topic/7000/?page=6 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 04:15:04 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Corbina vs Arch Помогите настроить VPN
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://storage.yandexcloud.net/aor-static/static/css/default.css">
    
    
    

    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="../../feeds/posts/index.html" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="../../feeds/topics/index.html" title="Последние темы на форуме" >

    
    
    
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/jquery.formset.min.js"></script>

</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="../../../index.html">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="../../../news/index.html">Новости</a></li>
    <li class="active"><a href="../../index.html">Форум</a></li>
    <li class=""><a href="../../../blogs/index.html">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_(Русский)">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="../../../irc/index.html#chat">IRC</a></li>
      <li class="dropdown">
        <a href="../../../accounts/login/index.html" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="../../../accounts/login/index.html">Вход</a></li>
          <li><a href="../../../accounts/register/index.html">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="../../../messages/inbox/index.html" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="../../../index.html">ArchLinux.org.ru</a></li>


    <li><a href="../../index.html">Начало</a> <span class="divider">/</span></li>
    
        
            
                <li><a href="../../category/2/index.html">Поддержка пользователей</a> <span class="divider">/</span></li>
            
                <li><a href="../../forum/13/index.html">Сети, Серверы, Защита</a> <span class="divider">/</span></li>
            
        
        
            <li>Corbina vs Arch Помогите настроить VPN</li>
        
    
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    
    <div class="topic">
        <h1>Corbina vs Arch Помогите настроить VPN</h1>
        
            <div class="text-center">
    


    <nav>
        <ul class="pagination">
            
                <li class="previous">
                    <a href="indexaf4d.html?page=5" aria-label="предыдущая страница">
                        <span aria-hidden="true">&laquo;</span>
                        <span class="hidden-xs">предыдущая страница</span>
                    </a>
                </li>
            

            
                
                    
                        <li>
                            <a href="index2679.html?page=1">1</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index4658.html?page=2">2</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index9ba9.html?page=3">3</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexfdb0.html?page=4">4</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexaf4d.html?page=5">5</a>
                        </li>
                    
                
            
                
                    
                        <li class="active">
                            <a href="indexc575.html?page=6">6 <span class="sr-only">(текущая страница)</span></a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index235c.html?page=7">7</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexfdfa.html?page=8">8</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index0b08.html?page=9">9</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index1448.html?page=10">10</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index1c8b.html?page=11">11</a>
                        </li>
                    
                
            
                
                    <li class="disabled">
                        <span>...</span>
                    </li>
                
            
                
                    
                        <li>
                            <a href="index3c09.html?page=22">22</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index89ae.html?page=23">23</a>
                        </li>
                    
                
            

            
                <li class="next">
                    <a href="index235c.html?page=7" aria-label="следующая страница">
                        <span class="hidden-xs">следующая страница</span>
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            
        </ul>
    </nav>


</div>

        

        

        <div class="posts">
            
            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67094"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/bobart/index.html">
                <span class="post-username">bobart</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67094/index.html">#</a>
            11 лет, 10 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/bobart/topics/index.html">
                    38
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/bobart/posts/index.html">
                    2537
                </a>
            </div>
            <div>
                Участник с: 28 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
            Вобщем, помудрил с кроном тут&#8230; Возможно сделал топорно, но вроде отрабатывает на выдёргивание кабеля и т.п. Если предложите более изящный вариант, буду рад. А то с кроном впервые столкнулся, там подглядел, сям подтырил&#8230;<br/><strong>1.</strong><br/># touch /etc/cron.daily/cheknet<br/># nano /etc/cron.daily/cheknet<br/><div class="code"><pre>#!/bin/sh
ping -c 1 -w 10 <a href="http://tp.corbina.net/">tp.corbina.net</a> &gt; /dev/null || /etc/rc.d/network restart</pre></div># chmod 744 /etc/cron.daily/cheknet<br/><br/><strong>2.</strong><br/>запуск каждые 5 мин.<br/># touch /etc/cheknetcron <br/># nano /etc/cheknetcron <br/><div class="code"><pre>*/5 * * * * /usr/sbin/run-cron /etc/cron.daily</pre></div><br/><strong>3.</strong><br/>указать crontab'у файл с расписанием:<br/># crontab /etc/cheknetcron <br/><br/><strong>4.</strong><br/># /etc/rc.d/crond restart<br/><br/>ну и проверить, добавлен ли  crond в /etc/rc.conf:<br/><div class="code"><pre>DAEMONS=(syslog-ng network ... @crond ... )</pre></div>Вобщем, смысл сих махинаций наверно понятен: если у корбины отваливаются dns-сервера (а как раз этим она славится) или просто передёргиваете кабель (неизвестно для чего), то тут /etc/rc.d/xl2tpd restart что мёртвому припарки. Надо network переподнимать. Можно что-то наваять, по образу и подобию и для того случая, когда просто ppp0 падает и не собирается передёргиваться по lcp-echo-interval 10 и lcp-echo-failure 2 в /etc/ppp/options.xl2tpd<br/>Ещё косяк: если рестартится network, то xl2tpd тоже отваливается. Хотя, раз выдернул кабель, подождал секунд 5-10, вставил обратно, сеть поднялась, ppp0 на месте, инет есть. Вобщем, разбираться ещё надо.<br/><br/>Есть шероховатость и в логе, но пока не знаю, важно ли это и что делать, если важно:<br/>cat /var/log/crond.log<div class="code"><pre>Oct 21 03:15:01 localhost crond[4328]: FILE /var/spool/cron/root USER root PID 6827 /usr/sbin/run-cron /etc/cron.daily
Oct 21 03:16:25 localhost crond[7040]: mailing cron output for user root /usr/sbin/run-cron /etc/cron.daily
Oct 21 03:16:25 localhost crond[7040]: unable to exec /usr/sbin/sendmail: cron output for user root /usr/sbin/run-cron /etc/cron.daily to /dev/null</pre></div>Пока всё.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67095"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/mithrusc/index.html">
                <span class="post-username">mithrusc</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67095/index.html">#</a>
            11 лет, 10 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/mithrusc/topics/index.html">
                    5
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/mithrusc/posts/index.html">
                    32
                </a>
            </div>
            <div>
                Участник с: 10 июля 2010
            </div>
            
        </td>
        <td class="post-content">
            <strong>bobart</strong><br/>Я так понял у вас тоже не все идеально? xl2tpd перезванивает сам или нет? в логах есть gethostbyname?<br/><blockquote>unable to exec /usr/sbin/sendmail: cron output for user root /usr/sbin/run-cron /etc/cron.daily to /dev/null</blockquote>локальную почту он хотел отправить руту, sendmail может быть нет а можт еще что<br/>Тот скрипт что я выложил тоже работает, думаю не составит большого труда заменить там команду на network restart.<br/>Все это костыли, нужен кто то кто сможет пакеты нормально собрать, и обьяснит по поводу поддержки l2tp в ядре арча
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67096"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/bobart/index.html">
                <span class="post-username">bobart</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67096/index.html">#</a>
            11 лет, 10 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/bobart/topics/index.html">
                    38
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/bobart/posts/index.html">
                    2537
                </a>
            </div>
            <div>
                Участник с: 28 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
            Привет, у меня тоже не всё идеально, но мы над этим работаем.)<br/>ps/ Про почту я понял. &ldquo;gethostbyname&rdquo; в логах нет.<br/><br/>PS. Метод тыка привёл к такому скрипту, проверил, отрабатывает нормально, поставил в cron.daily - посмотрим&#8230;<br/>Кабель выдернут/вдёрнут: сеть рестартится и поднимается скриптом. Повторный запуск: если пинг до <strong>8.8.8.8</strong> возвращает <strong>1</strong>: просто отрабатывает и завершается без передёргивания xl2tpd. Если отваливается ppp0, а локалка жива, то скрипт, по-любому, должен отработать xl2tpd restart. <br/><div class="code"><pre>#!/bin/sh
ping -c 1 -w 10 <a href="http://tp.corbina.net/">tp.corbina.net</a> &gt; /dev/null || /etc/rc.d/network restart &amp;&amp; 
checknet=`ping -c 1 8.8.8.8 |grep icmp_ |wc -l`
if [ ! $checknet = 1 ]
then
  /etc/rc.d/xl2tpd restart
fi
exit 0</pre></div>Чтобы работало от пользователя, надо разрешить выполнение этих команд в /etc/sudoers, типа:<div class="code"><pre>bob   arch=NOPASSWD: /etc/rc.d/network
bob   arch=NOPASSWD: /etc/rc.d/xl2tpd</pre></div>ps/ Подчистил на пред. странице своё сообщение: выкинул лог (неактуально) и поправил директорию для ip-up-route.sh, чтобы не было путаницы. Вобщем, готовый, рабочий конфиг + скрипт в cron для проверки сетевой активности.<br/><br/>Да, вот ещё: уважаемый PoZiTPoH заделал та-а-кой скриптище, для проверки сетевой активности! С &ldquo;выражениями&rdquo; в адрес корбины в notifications, одним словом, момент подмечен тонко. Если хорошо попросите, он вам ссылку на него предоставит, для тестирования. А я пока буду осознавать его произведение, втихаря.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67097"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/mithrusc/index.html">
                <span class="post-username">mithrusc</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67097/index.html">#</a>
            11 лет, 10 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/mithrusc/topics/index.html">
                    5
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/mithrusc/posts/index.html">
                    32
                </a>
            </div>
            <div>
                Участник с: 10 июля 2010
            </div>
            
        </td>
        <td class="post-content">
            <strong>bobart</strong><br/>исправили таки)) там все было нормально.<br/>1 в данном случае это сколько откликов на пинг он должен получить или не получить чтобы перезапустить/не перезапустить соединение. еще ! не хватало<br/><blockquote>bob   arch=NOPASSWD: /etc/rc.d/network<br/>bob   arch=NOPASSWD: /etc/rc.d/xl2tpd</blockquote>разумеется, arch в данном случае что? имя хоста? а если через ssh я команду даю?<br/>bob ALL= NOPASSWD: /etc/rc.d/xl2tpd и еще зачем в две строки? можно же так <div class="code"><pre>bob ALL= NOPASSWD: /etc/rc.d/xl2tpd,/sbin/reboot,/etc/rc.d/network</pre></div>По поводу ifplugd, в deb была такая опция для интерфейса allow hot-plug вродебы вот она и влияла на поведение при включенном-выключенном кабеле.<br/><blockquote>Да, вот ещё: уважаемый PoZiTPoH заделал та-а-кой скриптище, для проверки сетевой активности! С &ldquo;выражениями&rdquo; в адрес корбины в notifications, одним словом, момент подмечен тонко. Если хорошо попросите, он вам ссылку на него предоставит, для тестирования. А я пока буду осознавать его произведение, втихаря.</blockquote>))это для тех кто софт пишет под линукс полезно, тут нужен кто то кто соберет этот хренов xl2tpd с наложенным патчем gethostbyname вот и все.<br/>и еще <strong>bobart</strong> раз вы сейчас &ldquo;в теме&rdquo; написали бы в русскую вики статью о настройке xl2tpd
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67098"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/bobart/index.html">
                <span class="post-username">bobart</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67098/index.html">#</a>
            11 лет, 10 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/bobart/topics/index.html">
                    38
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/bobart/posts/index.html">
                    2537
                </a>
            </div>
            <div>
                Участник с: 28 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
             vs  - оно и так, и так работало, пинга нет - ответ &ldquo;0&rdquo;, но решил сделать как у вас. Не спец я в вопросе. По-всякому делал и есстественно, сначала скрипт просто в терминале выполнял и смотрел вывод. Но не суть.<br/>Насчёт SSH - я сделал так, как нужно мне, в том-то и дело, что не претендую на универсальное решение. Доступность только для моего хоста. Всё.<br/>bob arch= NOPASSWD: /etc/rc.d/xl2tpd,/sbin/reboot,/etc/rc.d/network,/etc&#8230; - тоже не суть=)<br/><br/>Если вы в дебиане имели дело с этим, возьмите исходники, возьмите дебиановский патч gethostbyname и попробуйте пересобрать. Тут такое дело, не знаю, кому кроме вас, меня и тех немногих, кто использует xl2tpd это нужно. Никто не будет пересобирать. Если вы в теме - почему-бы и нет? Есть ABS, есть оф. сайт, откуда этот xl2tpd берётся и собирается, есть сорцы и деб.патч. <br/>Найдите все необходимые ингредиенты, сообщите, давайте вместе смотреть. Не, серьёзно, если хотите что-то сдвинуть - двиньте сами и народ за вами потянется)<br/>С вики пока обождём, да? - пусть тема устаканится.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67099"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/pztrn/index.html">
                <span class="post-username">pztrn</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67099/index.html">#</a>
            11 лет, 10 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/pztrn/topics/index.html">
                    23
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/pztrn/posts/index.html">
                    1436
                </a>
            </div>
            <div>
                Участник с: 20 сентября 2009
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>bobart</em><br/> vs  - оно и так, и так работало, пинга нет - ответ &ldquo;0&rdquo;</blockquote>Это про exitcode ping'a? Если да, то когда нету пинга - exitcode 1. Нулевой - это когда программа (любая) отработала нормально, без ошибок ;)
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67100"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/bobart/index.html">
                <span class="post-username">bobart</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67100/index.html">#</a>
            11 лет, 10 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/bobart/topics/index.html">
                    38
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/bobart/posts/index.html">
                    2537
                </a>
            </div>
            <div>
                Участник с: 28 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
            В данном случае речь не о том.<br/><br/>Соединение есть:<div class="code"><pre>bob@arch:~$ ping -c 1 8.8.8.8 |grep icmp_ |wc -l
1
bob@arch:~$ ping -c 1 8.8.8.8
PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.
64 bytes from 8.8.8.8: icmp_seq=1 ttl=53 time=52.5 ms
--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 52.547/52.547/52.547/0.000 ms</pre></div><br/>Если пинг не прошёл, выдаст &ldquo;&#8230; icmp_seq=0 &#8230;&rdquo;<br/>Соединения нет:<div class="code"><pre>$ ping -c 1 8.8.8.8 |grep icmp_ |wc -l
0</pre></div>
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67101"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/bobart/index.html">
                <span class="post-username">bobart</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67101/index.html">#</a>
            11 лет, 10 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/bobart/topics/index.html">
                    38
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/bobart/posts/index.html">
                    2537
                </a>
            </div>
            <div>
                Участник с: 28 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
            <strong> mithrusc</strong>, <a href="http://wiki.archlinux.org/index.php/Configuring_Network#Laptops.2C_.27ifplugd.27">http://wiki.archlinux.org/index.php/Con &#8230; ifplugd.27</a> <br/><div class="code"><pre>Ifplugd 
Вы можете установить демон, который будет автоматически настраивать вашу сеть, когда воткнут кабель, и возвращать её в исходное состояние, когда кабель выдернут. Это полезно для лаптопов с внутренними сетевыми адаптерами, так как демон настроит интерфейс только тогда, когда кабель действительно подключён. Также можно его использовать, когда надо перезапустить сеть, но вы не хотите перезапускать компьютер или делать это из оболочки. 
Установка очень проста, так как пакет находится в [extra]: 
# pacman -S ifplugd
По умолчанию он настроен на работу с интрфейсом eth0. Эта и другие настройки, например задержка, могут быть настроены в /etc/ifplugd/ifplugd.conf. 
Запустите его: 
# /etc/rc.d/ifplugd start
или добавьте в список DAEMONS в /etc/rc.conf</pre></div>
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67102"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/pztrn/index.html">
                <span class="post-username">pztrn</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67102/index.html">#</a>
            11 лет, 10 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/pztrn/topics/index.html">
                    23
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/pztrn/posts/index.html">
                    1436
                </a>
            </div>
            <div>
                Участник с: 20 сентября 2009
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>bobart</em><br/>Если пинг не прошёл, выдаст &ldquo;&#8230; icmp_seq=0 &#8230;&rdquo;<br/>Соединения нет:<div class="code"><pre>$ ping -c 1 8.8.8.8 |grep icmp_ |wc -l
0</pre></div></blockquote>Советую уже почитать про exitcodes (return codes) - намного удобнее будет, ибо 0 - это всегда удачное завершение программы, а &lt;&gt; 0 - неудачное. Очень удобно для скриптинга. Так что как бы лень не было - но почитай ;)<br/><br/>И да - соединение может быть нестабильным. То есть первый раз пинг прошел, а вот последующие несколько - нет. Поэтому не вижу смысла ставить меньше -c 4.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67103"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/bobart/index.html">
                <span class="post-username">bobart</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67103/index.html">#</a>
            11 лет, 10 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/bobart/topics/index.html">
                    38
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/bobart/posts/index.html">
                    2537
                </a>
            </div>
            <div>
                Участник с: 28 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
            <blockquote>И да - соединение может быть нестабильным. То есть первый раз пинг прошел, а вот последующие несколько - нет. Поэтому не вижу смысла ставить меньше -c 4.</blockquote>Тоже об этом подумывал, ага) <br/>exitcodes - прислушаюсь, спасибо. Меня несколько смущает сама идея строить правило на основе пинга, в данном случае. <br/>Строить его на основе route -n |grep ^0.0.0.0 | awk &lsquo;{ print $2 }&rsquo; (например) - тоже сомнительно. Вобщем, да увеличить пинг до 4, пожалуй, верно. Сейчас 3 - вчера изменил;)<br/><br/>ps/<div class="code"><pre>#!/bin/sh
ping -c 4 -w 10 <a href="http://tp.corbina.net/">tp.corbina.net</a> &gt; /dev/null || /etc/rc.d/network restart &amp;&amp;  
ping -c4 8.8.8.8 &amp;&gt; /dev/null
if [ ! $? -eq 0 ]
then
  /etc/rc.d/xl2tpd restart
fi
exit 0</pre></div>пока так.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
        </div>
        <div>&nbsp;</div>
        
            <div class="text-center">
    


    <nav>
        <ul class="pagination">
            
                <li class="previous">
                    <a href="indexaf4d.html?page=5" aria-label="предыдущая страница">
                        <span aria-hidden="true">&laquo;</span>
                        <span class="hidden-xs">предыдущая страница</span>
                    </a>
                </li>
            

            
                
                    
                        <li>
                            <a href="index2679.html?page=1">1</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index4658.html?page=2">2</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index9ba9.html?page=3">3</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexfdb0.html?page=4">4</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexaf4d.html?page=5">5</a>
                        </li>
                    
                
            
                
                    
                        <li class="active">
                            <a href="indexc575.html?page=6">6 <span class="sr-only">(текущая страница)</span></a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index235c.html?page=7">7</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexfdfa.html?page=8">8</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index0b08.html?page=9">9</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index1448.html?page=10">10</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index1c8b.html?page=11">11</a>
                        </li>
                    
                
            
                
                    <li class="disabled">
                        <span>...</span>
                    </li>
                
            
                
                    
                        <li>
                            <a href="index3c09.html?page=22">22</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index89ae.html?page=23">23</a>
                        </li>
                    
                
            

            
                <li class="next">
                    <a href="index235c.html?page=7" aria-label="следующая страница">
                        <span class="hidden-xs">следующая страница</span>
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            
        </ul>
    </nav>


</div>

        

        

        
            
<a href="../../../accounts/register/index.html">Зарегистрироваться</a> или <a href="../../../accounts/login/index4b48.html?next=/forum/topic/7000/">войдите</a> чтобы оставить сообщение.

        

        
    </div>

        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

</body>

<!-- Mirrored from archlinux.org.ru/forum/topic/7000/?page=6 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 04:15:04 GMT -->
</html>
