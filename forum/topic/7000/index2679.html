


<!DOCTYPE html>
<html lang="ru">

<!-- Mirrored from archlinux.org.ru/forum/topic/7000/?page=1 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 04:09:02 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Corbina vs Arch Помогите настроить VPN
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://storage.yandexcloud.net/aor-static/static/css/default.css">
    
    
    

    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="../../feeds/posts/index.html" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="../../feeds/topics/index.html" title="Последние темы на форуме" >

    
    
    
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/jquery.formset.min.js"></script>

</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="../../../index.html">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="../../../news/index.html">Новости</a></li>
    <li class="active"><a href="../../index.html">Форум</a></li>
    <li class=""><a href="../../../blogs/index.html">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_(Русский)">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="../../../irc/index.html#chat">IRC</a></li>
      <li class="dropdown">
        <a href="../../../accounts/login/index.html" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="../../../accounts/login/index.html">Вход</a></li>
          <li><a href="../../../accounts/register/index.html">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="../../../messages/inbox/index.html" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="../../../index.html">ArchLinux.org.ru</a></li>


    <li><a href="../../index.html">Начало</a> <span class="divider">/</span></li>
    
        
            
                <li><a href="../../category/2/index.html">Поддержка пользователей</a> <span class="divider">/</span></li>
            
                <li><a href="../../forum/13/index.html">Сети, Серверы, Защита</a> <span class="divider">/</span></li>
            
        
        
            <li>Corbina vs Arch Помогите настроить VPN</li>
        
    
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    
    <div class="topic">
        <h1>Corbina vs Arch Помогите настроить VPN</h1>
        
            <div class="text-center">
    


    <nav>
        <ul class="pagination">
            
                <li class="previous disabled">
                    <span>
                        <span aria-hidden="true">&laquo;</span>
                        <span class="hidden-xs">предыдущая страница</span>
                    </span>
                </li>
            

            
                
                    
                        <li class="active">
                            <a href="index2679.html?page=1">1 <span class="sr-only">(текущая страница)</span></a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index4658.html?page=2">2</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index9ba9.html?page=3">3</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexfdb0.html?page=4">4</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexaf4d.html?page=5">5</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexc575.html?page=6">6</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index235c.html?page=7">7</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexfdfa.html?page=8">8</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index0b08.html?page=9">9</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index1448.html?page=10">10</a>
                        </li>
                    
                
            
                
                    <li class="disabled">
                        <span>...</span>
                    </li>
                
            
                
                    
                        <li>
                            <a href="index3c09.html?page=22">22</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index89ae.html?page=23">23</a>
                        </li>
                    
                
            

            
                <li class="next">
                    <a href="index4658.html?page=2" aria-label="следующая страница">
                        <span class="hidden-xs">следующая страница</span>
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            
        </ul>
    </nav>


</div>

        

        

        <div class="posts">
            
            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67044"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/askent/index.html">
                <span class="post-username">askent</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67044/index.html">#</a>
            12 лет, 6 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/askent/topics/index.html">
                    1
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/askent/posts/index.html">
                    1
                </a>
            </div>
            <div>
                Участник с: 17 февраля 2010
            </div>
            
        </td>
        <td class="post-content">
            Всем привет, решил установить Арх линукс чакра проэкт. У меня провайдер корбина и сразу интернета ясен перец не жду,так как надо возиться со всякими там паролями и прочей требухой. Народ помогите пожалуйста настроить инет. Ато даже на офф.форуме корбины молчат, я уже подумываю сменить провайдера изза такого отношения к клиенту.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67045"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/xlin84/index.html">
                <span class="post-username">xlin84</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67045/index.html">#</a>
            12 лет, 6 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/xlin84/topics/index.html">
                    22
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/xlin84/posts/index.html">
                    142
                </a>
            </div>
            <div>
                Участник с: 20 декабря 2008
            </div>
            
        </td>
        <td class="post-content">
            Про это много писали. <a href="../../viewtopicf48c.html?f=8&amp;t=3434&amp;p=27222&amp;hilit=vpn#p27222">Жми раз &gt;&gt;</a><br/>А тут конкретный рабочий пример.. друг делал, но мне кажется там не все верно сделано (подсказать не могу, инет через ADSL тяну)<br/><a href="http://portal.san.ru/forums/index.php?s=&amp;showtopic=135323&amp;view=findpost&amp;p=2616308">Жми два &gt;&gt;</a>
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67046"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/dasich/index.html">
                <span class="post-username">dasich</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67046/index.html">#</a>
            12 лет, 6 месяцев назад
            
                (отредактировано
                
                    12 лет, 6 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/dasich/topics/index.html">
                    1
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/dasich/posts/index.html">
                    12
                </a>
            </div>
            <div>
                Участник с: 19 февраля 2010
            </div>
            
        </td>
        <td class="post-content">
            Да что вы человеку подсовываете этот идиотский pptp.<br/>у корбины инет раздается и по l2tp который во много раз быстрее и настраивается проще.<br/>Ставишь xl2tpd (pacman -S xl2tpd) и радуешься.<br/>Закину сюда свои конфиги.<br/>/etc/xl2tpd/xl2tpd.conf<br/><div class="code"><pre>
[global]
access control = yes
auth file = /etc/ppp/chap-secrets
[lac corbina]
lns = 85.21.0.248  #ip корбиновского l2tp сервера. его можно узнать по имени <a href="http://tp.corbina.net/">tp.corbina.net</a>, а вот имя прописать сюда у меня не получилось.
redial = yes
redial timeout = 10
require chap = yes
require authentication = no
name = corbina_user #Имя корибновского пользователя
ppp debug = yes
pppoptfile = /etc/ppp/options.xl2tpd
require pap = no
autodial = yes</pre></div><br/>/etc/ppp/options.xl2tpd<br/><div class="code"><pre>
lcp-echo-interval 10
lcp-echo-failure 2
name corbina_user #Имя корибновского пользователя
remotename l2tp
ipparam corbina
connect /bin/true
nodeflate
nobsdcomp
persist
maxfail 0
nopcomp
noaccomp
defaultroute
noauth</pre></div><br/>/etc/ppp/chap-secrets выглядит так<br/><div class="code"><pre>
"corbina_user"       *       "corbina_password"</pre></div><br/>А так же правим файл /etc/ppp/ip-up<br/><br/>/etc/ppp/ip-up<br/><div class="code"><pre>
#!/bin/sh
PATH="/sbin:/bin:/usr/sbin:/usr/bin"
GATEWAY=`route | grep ^default | awk '{print $2}'`
route del default
route add default dev ppp0
(
echo '#!/bin/sh'
echo 'PATH="/sbin:/bin:/usr/sbin:/usr/bin"'
echo 'route del default'
echo "route add default gateway $GATEWAY"
) &gt;/etc/ppp/ip-down</pre></div><br/>и запускем <br/><div class="code"><pre>/etc/rc.d/xl2tpd start</pre></div><br/>не забываем прописать его для автозапуска в /etc/rc.conf<br/><br/>При обрыве он сам будет автоматом переподключаться.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67047"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/bobart/index.html">
                <span class="post-username">bobart</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67047/index.html">#</a>
            12 лет, 6 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/bobart/topics/index.html">
                    38
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/bobart/posts/index.html">
                    2537
                </a>
            </div>
            <div>
                Участник с: 28 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
            # pacman -S xl2tpd<br/>$ cat /etc/resolv.conf - здесь должны быть адреса dns-серверов, они используются в скрипте xl2tpd для поднятия ppp0<br/>$ route -n |grep ^0.0.0.0 | awk &lsquo;{ print $2 }&rsquo;   - при отключённом vpn выведет ваш шлюз по-умолчанию<br/>$ host <a href="http://tp.corbina.net/">tp.corbina.net</a> или host tp.internet.beeline.ru  - выведет список ip-адресов корбины, если нет - значит проблемы с локалкой, при условии, что в rc.conf у вас верно указаны параметры eth0 и gateway (см. ниже) и вполне возможно, что это со стороны корбины, с них станется. Но в настройках соединения конкретный ip корбины указывать не нужно, они у них меняются как погода в Питере.<br/>cat /etc/rc.conf<br/><div class="code"><pre># Static IP example
# eth0="dhcp"
eth0="dhcp"
INTERFACES=(eth0)
# Routes to start at boot-up (in this order)
# Declare each route then list in ROUTES
#   - prefix an entry in ROUTES with a ! to disable it
#
gateway="default gw XX.XXX.XXX.X" #XX.XXX.XXX.X - ваш шлюз по-умолчанию
ROUTES=(gateway)
# -----------------------------------------------------------------------
# DAEMONS
# -----------------------------------------------------------------------
#
# Daemons to start at boot-up (in this order)
#   - prefix a daemon with a ! to disable it
#   - prefix a daemon with a @ to start it up in the background
#
DAEMONS=(syslog-ng network xl2tpd hal @gdm @netfs @crond @alsa)</pre></div><br/>cat /etc/xl2tpd/xl2tpd.conf<br/><div class="code"><pre>
[global]
access control = yes
[lac corbina]
lns = <a href="http://tp.corbina.net/">tp.corbina.net</a>
redial = yes
redial timeout = 1
require chap = yes
require authentication = no
name = &lt;логин_корбины&gt;
ppp debug = yes
pppoptfile = /etc/ppp/options.xl2tpd
require pap = no
autodial = yes</pre></div><br/>cat /etc/ppp/options.xl2tpd<br/><div class="code"><pre>
name &lt;логин_корбины&gt;
remotename tp
ipparam corbina
connect /bin/true
mru 1500
mtu 1500
nodeflate
nobsdcomp
noauth
persist
maxfail 0
nopcomp
noaccomp
defaultroute</pre></div><br/>cat /etc/rc.d/xl2tpd<br/><div class="code"><pre>
#!/bin/bash
# general config
. /etc/rc.conf
. /etc/rc.d/functions
case "$1" in
    start)
        stat_busy "Starting xl2tpd"
        /usr/sbin/xl2tpd
        if [ $? -gt 0 ]; then
            stat_fail
        else
            add_daemon xl2tpd
            stat_done
        fi
        route add -host <a href="http://tp.corbina.net/">tp.corbina.net</a> gw &lt;default gw&gt;  
        route add -host &lt;dns_1&gt; gw &lt;default gw&gt; 
        route add -host &lt;dns_2&gt; gw &lt;default gw&gt; #цифири везде без "&lt;" и "&gt;", конечно
        sleep 1
        route del default
        ;;
    stop)
        stat_busy "Stopping xl2tpd"
	[ -f /var/run/xl2tpd.pid ] &amp;&amp; kill `cat /var/run/xl2tpd.pid`
        if [ $? -gt 0 ]; then
            stat_fail
        else
	    rm -f /var/run/xl2tpd.pid
            rm_daemon xl2tpd
            stat_done
        fi
        route add default gw &lt;default gw&gt;
        ;;
    restart)
        $0 stop
	sleep 1
        $0 start
        ;;
    *)
        echo "usage: $0 {start|stop|restart}"
	;;
esac
exit 0</pre></div><br/>Ну и само-собою, # nano /etc/ppp/chap-secrets<br/><div class="code"><pre>
# Secrets for authentication using CHAP
# client        server  secret                  IP addresses
corbina_login * corbina_password</pre></div>Конфиг рабочий. Запуск network в бэкграунде (@network) чреват тем, что при загрузке системы xl2tpd не успевает удалить и вновь поднять маршрут на default gw и ppp0  не поднимается сразу. Главное, без паники, а если нервы не выдержали, можно и руками, но сначала sudo /etc/rc.d/xl2tpd stop, а затем sudo /etc/rc.d/xl2tpd start - поднимется, никуда не денется=)<br/>ps/ Если у кого-нибудь будут &ldquo;более правильные&rdquo; варианты - милости просим=)
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67048"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/dasich/index.html">
                <span class="post-username">dasich</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67048/index.html">#</a>
            12 лет, 6 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/dasich/topics/index.html">
                    1
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/dasich/posts/index.html">
                    12
                </a>
            </div>
            <div>
                Участник с: 19 февраля 2010
            </div>
            
        </td>
        <td class="post-content">
            Вот мой кусок rc.conf<br/><div class="code"><pre>
l2tp="-host 85.21.0.245 gw 10.212.128.1"
l2tp2="-host 85.21.0.248 gw 10.212.128.1"
iptv="-net 224.0.0.0 netmask 240.0.0.0 dev eth1"
gateway="default gw 10.212.128.1"
ROUTES=(l2tp l2tp2 iptv gateway)</pre></div><br/><br/>в общем-то /etc/rc.d/xl2tpd я не изменял. я изменил /etc/ppp/ip-up. смотри первый мой пост, я его туда добавил.<br/><div class="code"><pre>
#!/bin/bash
# general config
. /etc/rc.conf
. /etc/rc.d/functions
case "$1" in
    start)
        stat_busy "Starting xl2tpd"
        /usr/sbin/xl2tpd
        if [ $? -gt 0 ]; then
            stat_fail
        else
            add_daemon xl2tpd
            stat_done
        fi
        ;;
    stop)
        stat_busy "Stopping xl2tpd"
        [ -f /var/run/xl2tpd.pid ] &amp;&amp; kill `cat /var/run/xl2tpd.pid`
        if [ $? -gt 0 ]; then
            stat_fail
        else
            rm -f /var/run/xl2tpd.pid
            rm_daemon xl2tpd
            stat_done
        fi
        ;;
    restart)
        $0 stop
        sleep 1
        $0 start
        ;;
    *)
        echo "usage: $0 {start|stop|restart}"
        ;;
esac
exit 0</pre></div><br/><br/>Ошибки у меня тоже идут но другие, но мне как-то до лампочки, так как на работу инета и компа они не влияют.<br/> <br/><div class="code"><pre>
Jan 25 19:03:12 das-ich dhcpcd: eth1: leased 10.212.129.110 for 604800 seconds
Jan 25 19:03:12 das-ich dhcpcd: forking to background
Jan 25 19:03:13 das-ich xl2tpd[4331]: setsockopt recvref[22]: Protocol not available
Jan 25 19:03:13 das-ich xl2tpd[4331]: This binary does not support kernel L2TP.
Jan 25 19:03:13 das-ich xl2tpd[4332]: xl2tpd version xl2tpd-1.2.4 started on .local PID:4332
Jan 25 19:03:13 das-ich xl2tpd[4332]: Written by Mark Spencer, Copyright (C) 1998, Adtran, Inc.
Jan 25 19:03:13 das-ich xl2tpd[4332]: Forked by Scott Balmos and David Stipp, (C) 2001
Jan 25 19:03:13 das-ich xl2tpd[4332]: Inherited by Jeff McAdams, (C) 2002
Jan 25 19:03:13 das-ich xl2tpd[4332]: Forked again by Xelerance (<a href="http://www.xelerance.com/">www.xelerance.com</a>) (C) 2006
Jan 25 19:03:13 das-ich xl2tpd[4332]: Listening on IP address 0.0.0.0, port 1701
Jan 25 19:03:13 das-ich xl2tpd[4332]: Connecting to host 85.21.0.248, port 1701
Jan 25 19:03:13 das-ich xl2tpd[4332]: Connection established to 85.21.0.248, 1701.  Local: 12503, Remote: 1070 (ref=0/0).
Jan 25 19:03:13 das-ich xl2tpd[4332]: Calling on tunnel 12503
Jan 25 19:03:13 das-ich xl2tpd[4332]: Call established with 85.21.0.248, Local: 13664, Remote: 20437, Serial: 1 (ref=0/0)
Jan 25 19:03:13 das-ich xl2tpd[4332]: start_pppd: I'm running:
Jan 25 19:03:13 das-ich xl2tpd[4332]: "/usr/sbin/pppd"
Jan 25 19:03:13 das-ich xl2tpd[4332]: "passive"
Jan 25 19:03:13 das-ich xl2tpd[4332]: "nodetach"
Jan 25 19:03:13 das-ich xl2tpd[4332]: ":"
Jan 25 19:03:13 das-ich xl2tpd[4332]: "name"
Jan 25 19:03:13 das-ich xl2tpd[4332]: ""
Jan 25 19:03:13 das-ich xl2tpd[4332]: "debug"
Jan 25 19:03:13 das-ich xl2tpd[4332]: "file"
Jan 25 19:03:13 das-ich xl2tpd[4332]: "/etc/ppp/options.xl2tpd"
Jan 25 19:03:13 das-ich xl2tpd[4332]: "/dev/pts/0"
Jan 25 19:03:13 das-ich pppd[4336]: pppd 2.4.4 started by root, uid 0
Jan 25 19:03:13 das-ich pppd[4336]: Serial connection established.
Jan 25 19:03:13 das-ich pppd[4336]: using channel 1
Jan 25 19:03:13 das-ich pppd[4336]: Using interface ppp0
Jan 25 19:03:13 das-ich pppd[4336]: Connect: ppp0 &lt;--&gt; /dev/pts/0
Jan 25 19:03:14 das-ich pppd[4336]: sent [LCP ConfReq id=0x1 &lt;asyncmap 0x0&gt; &lt;magic 0xdd2ab481&gt;]
Jan 25 19:03:14 das-ich pppd[4336]: rcvd [LCP ConfReq id=0x1 &lt;mru 1460&gt; &lt;asyncmap 0xa0000&gt; &lt;auth chap MD5&gt; &lt;magic 0x7eaff4c1&gt; &lt;pcomp&gt; &lt;accomp&gt;]
Jan 25 19:03:14 das-ich pppd[4336]: sent [LCP ConfRej id=0x1 &lt;pcomp&gt; &lt;accomp&gt;]
Jan 25 19:03:14 das-ich pppd[4336]: rcvd [LCP ConfAck id=0x1 &lt;asyncmap 0x0&gt; &lt;magic 0xdd2ab481&gt;]
Jan 25 19:03:14 das-ich pppd[4336]: rcvd [LCP ConfReq id=0x2 &lt;mru 1460&gt; &lt;asyncmap 0xa0000&gt; &lt;auth chap MD5&gt; &lt;magic 0x7eaff4c1&gt;]
Jan 25 19:03:14 das-ich pppd[4336]: sent [LCP ConfAck id=0x2 &lt;mru 1460&gt; &lt;asyncmap 0xa0000&gt; &lt;auth chap MD5&gt; &lt;magic 0x7eaff4c1&gt;]
Jan 25 19:03:14 das-ich pppd[4336]: sent [LCP EchoReq id=0x0 magic=0xdd2ab481]
Jan 25 19:03:14 das-ich pppd[4336]: rcvd [LCP EchoRep id=0x0 magic=0x7eaff4c1]
Jan 25 19:03:14 das-ich pppd[4336]: rcvd [CHAP Challenge id=0x1 &lt;8a8ecae428efd1ef7b91174dbbb54f10&gt;, name = "bras248"]
Jan 25 19:03:14 das-ich pppd[4336]: sent [CHAP Response id=0x1 &lt;0776a28992136a38143f7ecff0ea649c&gt;, name = ""]
Jan 25 19:03:14 das-ich pppd[4336]: rcvd [CHAP Success id=0x1 ""]
Jan 25 19:03:14 das-ich pppd[4336]: CHAP authentication succeeded
Jan 25 19:03:14 das-ich pppd[4336]: CHAP authentication succeeded
Jan 25 19:03:14 das-ich pppd[4336]: sent [IPCP ConfReq id=0x1 &lt;compress VJ 0f 01&gt; &lt;addr 0.0.0.0&gt;]
Jan 25 19:03:14 das-ich pppd[4336]: rcvd [IPCP ConfReq id=0x1 &lt;addr 85.21.0.248&gt;]
Jan 25 19:03:14 das-ich pppd[4336]: sent [IPCP ConfAck id=0x1 &lt;addr 85.21.0.248&gt;]
Jan 25 19:03:14 das-ich pppd[4336]: rcvd [IPCP ConfRej id=0x1 &lt;compress VJ 0f 01&gt;]
Jan 25 19:03:14 das-ich pppd[4336]: sent [IPCP ConfReq id=0x2 &lt;addr 0.0.0.0&gt;]
Jan 25 19:03:14 das-ich pppd[4336]: rcvd [IPCP ConfNak id=0x2 &lt;addr 95.24.160.23&gt;]
Jan 25 19:03:14 das-ich pppd[4336]: sent [IPCP ConfReq id=0x3 &lt;addr 95.24.160.23&gt;]
Jan 25 19:03:14 das-ich pppd[4336]: rcvd [IPCP ConfAck id=0x3 &lt;addr 95.24.160.23&gt;]
Jan 25 19:03:14 das-ich pppd[4336]: not replacing existing default route via 10.212.128.1
Jan 25 19:03:14 das-ich pppd[4336]: Cannot determine ethernet address for proxy ARP
Jan 25 19:03:14 das-ich pppd[4336]: local  IP address 95.24.160.23
Jan 25 19:03:14 das-ich pppd[4336]: remote IP address 85.21.0.248
Jan 25 19:03:14 das-ich pppd[4336]: Script /etc/ppp/ip-up started (pid 4403)
Jan 25 19:03:15 das-ich pppd[4336]: Script /etc/ppp/ip-up finished (pid 4403), status = 0x0
Jan 25 19:04:37 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:04:37 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:04:37 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:04:37 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:04:37 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:04:37 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:04:37 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:04:37 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:04:37 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:04:37 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:04:37 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:04:37 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:04:37 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:04:37 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:23:54 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:40:00 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:40:00 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:40:00 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:40:00 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:40:00 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:40:00 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:40:00 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:40:00 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:40:00 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:40:00 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:41:39 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:41:39 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:41:39 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:41:39 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:41:39 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:41:39 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:41:39 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:41:39 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:41:39 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:42:21 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:42:39 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:42:39 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:42:39 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:42:39 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:42:39 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:42:39 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:42:39 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:42:39 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 19:42:39 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 20:47:54 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)
Jan 25 20:48:17 das-ich xl2tpd[4332]: write_packet: Resource temporarily unavailable(11)</pre></div>
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67049"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/bobart/index.html">
                <span class="post-username">bobart</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67049/index.html">#</a>
            12 лет, 6 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/bobart/topics/index.html">
                    38
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/bobart/posts/index.html">
                    2537
                </a>
            </div>
            <div>
                Участник с: 28 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
            l2tp=&ldquo;-host 85.21.0.245 gw 10.212.128.1&rdquo;  - здесь не понятно, а если у корбины они изменятся и будет 85.21.0.243 или 85.21.0.252, то что делать?<br/>l2tp2=&ldquo;-host 85.21.0.248 gw 10.212.128.1&rdquo;  - аналогично, зачем здесь вообще l2tp, l2tp2?<br/>iptv=&ldquo;-net 224.0.0.0 netmask 240.0.0.0 dev eth1&rdquo;<br/>gateway=&ldquo;default gw 10.212.128.1&rdquo;<br/>ROUTES=(l2tp l2tp2 iptv gateway) - здесь тоже, зачем?<br/><br/>Можешь прокомментировать свой rc.conf? Я просто не понимаю, зачем там огород городить?<br/>ps/ Единственное, есть косяк: у меня при загрузке или ребуте системы, ppp0 не всегда стартует сразу. Раз на раз не приходится, бывает, что всё нормально, а бывает, что или через несколько секунд ppp0 поднимется или, если начинает тупить, то приходится руками останавливать и запускать снова /etc/rc.d/xl2tpd, но при нормальном старте в логах на предмет ошибок чисто. Вчера обновилось ядро, после этого ошибки исчезли.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67050"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/dasich/index.html">
                <span class="post-username">dasich</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67050/index.html">#</a>
            12 лет, 6 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/dasich/topics/index.html">
                    1
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/dasich/posts/index.html">
                    12
                </a>
            </div>
            <div>
                Участник с: 19 февраля 2010
            </div>
            
        </td>
        <td class="post-content">
            Наконец, путем нашей беседы я вспомнил, зачем я что-то сделал в этих настройках.<br/>Как ты знаешь nameserver в корбине не видны если к ним руками не прописать маршрут или же не подключиться к интернету.<br/>Я до xl2tpd использовал openl2tpd. В нем нельзя было на тот момент прописать имя сервера, только ip.<br/>Так как я комп без инета не использую, то решил прописывать маршрут только к серверу, а не к днс, соответственно по ip.<br/>После перехода на xl2tpd я так и написал ip в конфиг xl2tpd.<br/>Маршруты можно задавать в rc.conf, что я и делаю.<br/>то-есть я там могу прописать<br/>&lt;имя_маршрута&gt;=&ldquo;часть команды route, которая следует после параметра add&rdquo;<br/>то-есть, например у меня есть сеть 192,168,2,0/24 в другом городе к которой идет маршрут через 192,168,0,1. <br/>если писать руками то это будет выглядеть так<br/><div class="code"><pre>route add -net 192.168.2.0 netmask 255.255.255.0 gw 192.168.0.1</pre></div>Тогда в rc.conf я записываю маршрут:<br/><div class="code"><pre>my_remote_net="-net 192.168.2.0 netmask 255.255.255.0 gw 192.168.0.1"</pre></div>и в пункт ROUTES пишу имя моего маршрута для исполнения<br/><div class="code"><pre>ROUTES=(my_remote_net)</pre></div>Так что l2tp, l2tp2 это маршрут к двум серверам tp.corbina.net<br/>Ты маршруты прописываешь в /etc/rc.d/xl2tpd, а мог-бы прописывать в rc.conf<br/><div class="code"><pre>
tpsrv="-host <a href="http://tp.corbina.net/">tp.corbina.net</a> gw &lt;default gw&gt;"
dns1="-host &lt;dns_1&gt; gw &lt;default gw&gt;"
dns2="-host &lt;dns_1&gt; gw &lt;default gw&gt;"</pre></div>и добавить их в ROUTES так<br/><div class="code"><pre>ROUTES=(tpsrv dns1 dns2 gateway)</pre></div><br/>Конечно правильнее прописать маршруты к днс и к <a href="http://tp.corbina.net/">tp.corbina.net</a>. чем как я к ip.<br/>Но если есть руки, то когда ip сервера измениться, то можно прописать новый ip.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67051"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/bobart/index.html">
                <span class="post-username">bobart</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67051/index.html">#</a>
            12 лет, 6 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/bobart/topics/index.html">
                    38
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/bobart/posts/index.html">
                    2537
                </a>
            </div>
            <div>
                Участник с: 28 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
            Я понял, спасибо, что пояснил, варианты есть и не один, да. Дело в том, что я брал &ldquo;дебиановский&rdquo; (убунтушный) способ, с лёгким тюннингом под местные условия. Ну, ты понимаешь, replasedefaultroute здесь не работает, поэтому route del default и route add default gw dev ppp0, что собственно, ты и положил в /etc/ppp/ip_up, вроде, да? Но есть момент: у корбины айпишники меняются порой, и &ldquo;ждать&rdquo; этого радостного случая не хочется, либо всё что у них там обычно есть, штук десять-пятнадцать записывать в rc.conf (???) Собственно, хорошо-бы найти оптимальный, &ldquo;стопудовый&rdquo; конфиг, работающий при всяких выкрутасах со стороны прова, ну, я не говорю о смене дефолтного шлюза, хотя и это решается, у тебя, кстати, на этот счёт там и сделано верно. Как уже писал, есть момент: сеть не всегда поднимается при старте, когда как, то всё нормально подхватывается, то начинает тупить, видимо со сбросом и поднятием маршрута до ppp0.  Толи уж нам просто так повезло с провайдером и протоколом, толи надо оптимизировать конфиги, свои. Хотя, это не сильно и напрягает, по правде. Это уже так, из области перфекционизма=), а ошибки в логах исчезли, есть такое дело, после обновления ядра. Что-то там, видать, подрихтовали). Понятное дело, они работе не мешают, но согласись, тоже не &ldquo;кулл&rdquo;, когда с периодичностью в минуту в логи сыпется этот шлак.<br/>PS. Тема-то как весело названа: &ldquo;Корбина против Арча&#8230;&rdquo;, что-то в этом есть.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67052"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/h4tr3d/index.html">
                <span class="post-username">h4tr3d</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67052/index.html">#</a>
            12 лет, 6 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/h4tr3d/topics/index.html">
                    34
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/h4tr3d/posts/index.html">
                    2656
                </a>
            </div>
            <div>
                Участник с: 12 июля 2007
            </div>
            
        </td>
        <td class="post-content">
            мужики, вопрос, а что вам мешает иметь ДВА default route, но с разными metric?<br/><br/>UPD:<br/><div class="code"><pre>
gateway="default gw 10.212.128.1 metric 10"</pre></div><br/>когда поднимется ppp, он создаст default gw с метрикой 0, она станет приоритетной, пакеты по новым соединениям пойдут по этому маршруту. Когда остановится соединение, останется старый defaul gw.
            
                
                    <div class="post-signature">
                        systemd должен умереть.
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-67053"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/amigo/index.html">
                <span class="post-username">amigo</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/67053/index.html">#</a>
            12 лет, 6 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/dc/5e/dc5efbd987b6618a42ed850a73772c27.png" alt="amigo avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/amigo/topics/index.html">
                    35
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/amigo/posts/index.html">
                    2126
                </a>
            </div>
            <div>
                Участник с: 05 февраля 2007
            </div>
            
        </td>
        <td class="post-content">
            <strong>h4tr3d</strong> - всему голова :)
            
                
                    <div class="post-signature">
                        Разберемся, голубчик!
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
        </div>
        <div>&nbsp;</div>
        
            <div class="text-center">
    


    <nav>
        <ul class="pagination">
            
                <li class="previous disabled">
                    <span>
                        <span aria-hidden="true">&laquo;</span>
                        <span class="hidden-xs">предыдущая страница</span>
                    </span>
                </li>
            

            
                
                    
                        <li class="active">
                            <a href="index2679.html?page=1">1 <span class="sr-only">(текущая страница)</span></a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index4658.html?page=2">2</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index9ba9.html?page=3">3</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexfdb0.html?page=4">4</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexaf4d.html?page=5">5</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexc575.html?page=6">6</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index235c.html?page=7">7</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexfdfa.html?page=8">8</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index0b08.html?page=9">9</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index1448.html?page=10">10</a>
                        </li>
                    
                
            
                
                    <li class="disabled">
                        <span>...</span>
                    </li>
                
            
                
                    
                        <li>
                            <a href="index3c09.html?page=22">22</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index89ae.html?page=23">23</a>
                        </li>
                    
                
            

            
                <li class="next">
                    <a href="index4658.html?page=2" aria-label="следующая страница">
                        <span class="hidden-xs">следующая страница</span>
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            
        </ul>
    </nav>


</div>

        

        

        
            
<a href="../../../accounts/register/index.html">Зарегистрироваться</a> или <a href="../../../accounts/login/index4b48.html?next=/forum/topic/7000/">войдите</a> чтобы оставить сообщение.

        

        
    </div>

        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

</body>

<!-- Mirrored from archlinux.org.ru/forum/topic/7000/?page=1 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 04:09:02 GMT -->
</html>
