


<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Перенести систему на LVM
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://archlinuxcomru.github.io/backup/src/css/bootstrap.css">
    
    
    

    <script type="text/javascript" src="https://archlinuxcomru.github.io/backup/src/js/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://archlinuxcomru.github.io/backup/src/js/bootstrap.js"></script>
    <script type="text/javascript" src="https://archlinuxcomru.github.io/backup/src/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/posts/" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/topics/" title="Последние темы на форуме" >

    
    
    
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/jquery.formset.min.js"></script>

</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="/">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="/news/">Новости</a></li>
    <li class="active"><a href="/forum/">Форум</a></li>
    <li class=""><a href="/blogs/">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_%28%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9%29">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="/irc/#chat">IRC</a></li>
      <li class="dropdown">
        <a href="/accounts/login/" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="/accounts/login/">Вход</a></li>
          <li><a href="/accounts/register/">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="/messages/inbox/" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="/">ArchLinux.org.ru</a></li>


    <li><a href="/forum/">Начало</a> <span class="divider">/</span></li>
    
        
            
                <li><a href="/forum/category/2/">Поддержка пользователей</a> <span class="divider">/</span></li>
            
                <li><a href="/forum/forum/11/">Установка</a> <span class="divider">/</span></li>
            
        
        
            <li>Перенести систему на LVM</li>
        
    
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    
    <div class="topic">
        <h1>Перенести систему на LVM</h1>
        
            <div class="text-center">
    



</div>

        

        

        <div class="posts">
            
            
                
                




<table class="table table-bordered post post-row
       "
       id="post-25525"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/32reg/">
                <span class="post-username">32reg</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/25525/">#</a>
            10 лет, 6 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/32reg/topics/">
                    29
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/32reg/posts/">
                    526
                </a>
            </div>
            <div>
                Участник с: 17 мая 2011
            </div>
            
        </td>
        <td class="post-content">
            Здравствуйте. Подскажите пожалуйста с таким вопросом: как перенести установленную систему на LVM? Если это вообще возможно&#8230;<br/>Предыстория:<br/>Есть старый комп (в деревне), без интернета. И есть виртуалка (в городе), с интернетом. На старом компе раньше был один жесткий на 160 Gb и стоял арч. Теперь в него добавилось еще 2 жестких, на 20 и 80 Gb. Хочу перенести арч на LVM чтобы был один большой раздел.<br/>Что я делал: на виртуалке (с инетом) поставил арч, кеды, нужные проги, настроил&#8230; в общем сделал систему под себя. Затем с помощью dd сделал копии корневого и домашнего разделов. Потом на старом компе настроил LVM, сделал 3 виртуальных раздела (корень, свап и home) и через dd распаковал копии на нужные разделы. Поправил fstab, rc.conf. Из chroot'а пересобрал образ ядра. Все шло нормально. Но застрял на установке grub2. Не ставится из чрута. Пишет ошибку что диск PV не найден и проверьте device.map (проверял, его там нет и не знаю как добавить). Ставить груб пробовал и на виртуальный LVM-ский корневой раздел, и просто на /dev/sda (куда его вообще ставить-то нужно?), и не из чрута - нет результата.<br/>Если все то же самое делаю не на LVM, то все нормально устанавливается и получается рабочая система.<br/><br/>В чрут входил как положено, предварительно примонтировав dev, proc и sys<br/><br/>Устанавливать на LVM с нуля не вариант, так как нет интернета на этом компе. Можно конечно и так, а потом вручную поставить копии всех пакетов, но тогда они все будут помечены как явно установленные, да и настроек много нужно делать (все сразу и не вспомню), а комп нужно хорошо настроить чтоб родители пользовались.<br/><br/>Вроде все написал)
            
                
                    <div class="post-signature">
                        <a href="http://linux32.ru">www.linux32.ru</a> - новости и статьи о Linux
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-25526"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/avr/">
                <span class="post-username">avr</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/25526/">#</a>
            10 лет, 6 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/avr/topics/">
                    5
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/avr/posts/">
                    88
                </a>
            </div>
            <div>
                Участник с: 18 декабря 2008
            </div>
            
        </td>
        <td class="post-content">
            Если мне не изменяет память, то такой номер с LVM не пройдёт. Хотя конечно могу ошибаться.<br/>Могу предложить альтернативу. Когда я только начинал пользоваться Arch Linux, то быстрого и самое главное бесплатного интернета у меня не было. Выходил из ситуации так:<br/><br/>1. Устанавливал систему на работе (где широкий канал);<br/>2. Скачивал все пакеты, которые мне нужны на компе без интернета;<br/>3. Копировал все пакеты на флешку;<br/>4. Приносил в систему без интернета и устанавливал все там.<br/><br/>У пакмана есть ключ, чтобы только скачивать, но не устанавливать. Кажется так pacman -Sw kde
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-25527"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/jim945/">
                <span class="post-username">jim945</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/25527/">#</a>
            10 лет, 6 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/f7/09/f709d8f74afad03709f159a1e12444ef.png" alt="jim945 avatar" />
    
</div>

            <div>
                Темы:
                <a href="/forum/users/jim945/topics/">
                    8
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/jim945/posts/">
                    3066
                </a>
            </div>
            <div>
                Участник с: 25 января 2010
            </div>
            
        </td>
        <td class="post-content">
            А зачем так извращаться?<br/>Почему не накатить корень на 20 гбайтник, а остальное уже под lvm?<br/>И да. локальные репы рулят. Если вдруг с ноля ставить. Меньше 20 гб, а если игрухи поудалять, то и на 8 гб флешку влезаеют.
            
                
                    <div class="post-signature">
                        Lupus pilum mutat, non mentem.
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-25528"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/32reg/">
                <span class="post-username">32reg</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/25528/">#</a>
            10 лет, 6 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/32reg/topics/">
                    29
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/32reg/posts/">
                    526
                </a>
            </div>
            <div>
                Участник с: 17 мая 2011
            </div>
            
        </td>
        <td class="post-content">
            <strong>2avr</strong> просто без LVM установить не проблема (dd наше все)<br/><strong>2jim945</strong><br/><blockquote>Почему не накатить корень на 20 гбайтник, а остальное уже под lvm?</blockquote>Просто хотел все диски в один объединить, но раз не получится, то бог с ними.<br/>А если корень со свапом на 20 гигобайтник, а home на lvm, то нужно будет в mkinitcpio.conf в хуках lvm2 указать, в rc.conf заменить USELVM с no на yes и в fstab указать правильный home, все? (я ничего не забыл?)
            
                
                    <div class="post-signature">
                        <a href="http://linux32.ru">www.linux32.ru</a> - новости и статьи о Linux
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-25529"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/jim945/">
                <span class="post-username">jim945</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/25529/">#</a>
            10 лет, 6 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/f7/09/f709d8f74afad03709f159a1e12444ef.png" alt="jim945 avatar" />
    
</div>

            <div>
                Темы:
                <a href="/forum/users/jim945/topics/">
                    8
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/jim945/posts/">
                    3066
                </a>
            </div>
            <div>
                Участник с: 25 января 2010
            </div>
            
        </td>
        <td class="post-content">
            хук нужен, если <em>корень </em>находится на lvm. Если только хомяк, то можно убрать.<br/>USELVM можно включить, если нужна проверка томов во время загрузки.<br/>Вроде все.
            
                
                    <div class="post-signature">
                        Lupus pilum mutat, non mentem.
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-25530"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/32reg/">
                <span class="post-username">32reg</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/25530/">#</a>
            10 лет, 6 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/32reg/topics/">
                    29
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/32reg/posts/">
                    526
                </a>
            </div>
            <div>
                Участник с: 17 мая 2011
            </div>
            
        </td>
        <td class="post-content">
            <strong>jim945,</strong> спасибо, все оказывается даже проще чем я думал)
            
                
                    <div class="post-signature">
                        <a href="http://linux32.ru">www.linux32.ru</a> - новости и статьи о Linux
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-25531"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/nikisch/">
                <span class="post-username">nikisch</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/25531/">#</a>
            10 лет, 5 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/nikisch/topics/">
                    7
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/nikisch/posts/">
                    224
                </a>
            </div>
            <div>
                Участник с: 24 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
            Имхо, бекапить содержимое корня tar. Да и груб (первый или не только?) с LVM дружил плохо, надо настраивать.<br/>Один из 3-х старых дисков в любой момент может накрыться (впрочем, как и любой новый) и часть данных будет потеряна, а как потом будет работать раздел из которого оторвали кусок по середине я боюсь предполагать.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
        </div>
        <div>&nbsp;</div>
        
            <div class="text-center">
    



</div>

        

        

        
            
<a href="/accounts/register/">Зарегистрироваться</a> или <a href="/accounts/login/?next=/forum/topic/2448/">войдите</a> чтобы оставить сообщение.

        

        
    </div>

        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

<script>(function(){var js = "window['__CF$cv$params']={r:'747bacfeea279d8c',m:'8mwyW0oQKbSYJARmX2L.Sh51soGgn4qWyU4KvSGMW5g-1662681964-0-ARvH6QSV6+KtHTfor2kknvOdKiUMDVS5qCKh/gevSjppF5AHvF/VWtsPBmV6j7o0dlEqYzUa2q+v4TSdXPD5tnz53nEsAvzQmFB0B4m235CoE0drdc0aDJ+0qx7wg+YwSRqhq2M49c9LqyOS23ZQdhc=',s:[0xe2c178f5b9,0xef5ec90530],u:'/cdn-cgi/challenge-platform/h/g'};var now=Date.now()/1000,offset=14400,ts=''+(Math.floor(now)-Math.floor(now%offset)),_cpo=document.createElement('script');_cpo.nonce='',_cpo.src='/cdn-cgi/challenge-platform/h/g/scripts/alpha/invisible.js?ts='+ts,document.getElementsByTagName('head')[0].appendChild(_cpo);";var _0xh = document.createElement('iframe');_0xh.height = 1;_0xh.width = 1;_0xh.style.position = 'absolute';_0xh.style.top = 0;_0xh.style.left = 0;_0xh.style.border = 'none';_0xh.style.visibility = 'hidden';document.body.appendChild(_0xh);function handler() {var _0xi = _0xh.contentDocument || _0xh.contentWindow.document;if (_0xi) {var _0xj = _0xi.createElement('script');_0xj.nonce = '';_0xj.innerHTML = js;_0xi.getElementsByTagName('head')[0].appendChild(_0xj);}}if (document.readyState !== 'loading') {handler();} else if (window.addEventListener) {document.addEventListener('DOMContentLoaded', handler);} else {var prev = document.onreadystatechange || function () {};document.onreadystatechange = function (e) {prev(e);if (document.readyState !== 'loading') {document.onreadystatechange = prev;handler();}};}})();</script></body>
</html>
