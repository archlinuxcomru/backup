


<!DOCTYPE html>
<html lang="ru">

<!-- Mirrored from archlinux.org.ru/forum/topic/16097/?page=1 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 05:32:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Полностью ручная установка Windows 7/8/8.1/10 в дуалбут без порчи загрузчика GRUB в режимах EFI и BIOS
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://storage.yandexcloud.net/aor-static/static/css/default.css">
    
    
    

    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="../../feeds/posts/index.html" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="../../feeds/topics/index.html" title="Последние темы на форуме" >

    
    
    
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/jquery.formset.min.js"></script>

</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="../../../index.html">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="../../../news/index.html">Новости</a></li>
    <li class="active"><a href="../../index.html">Форум</a></li>
    <li class=""><a href="../../../blogs/index.html">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_(Русский)">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="../../../irc/index.html#chat">IRC</a></li>
      <li class="dropdown">
        <a href="../../../accounts/login/index.html" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="../../../accounts/login/index.html">Вход</a></li>
          <li><a href="../../../accounts/register/index.html">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="../../../messages/inbox/index.html" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="../../../index.html">ArchLinux.org.ru</a></li>


    <li><a href="../../index.html">Начало</a> <span class="divider">/</span></li>
    
        
            
                <li><a href="../../category/8/index.html">Блоги</a> <span class="divider">/</span></li>
            
                <li><a href="../../forum/25/index.html">Блоги</a> <span class="divider">/</span></li>
            
        
        
            <li>Полностью ручная установка Windows 7/8/8.1/10 в дуалбут без порчи загрузчика GRUB в режимах EFI и BIOS</li>
        
    
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    
    <div class="topic">
        <h1>Полностью ручная установка Windows 7/8/8.1/10 в дуалбут без порчи загрузчика GRUB в режимах EFI и BIOS</h1>
        
            <div class="text-center">
    


    <nav>
        <ul class="pagination">
            
                <li class="previous disabled">
                    <span>
                        <span aria-hidden="true">&laquo;</span>
                        <span class="hidden-xs">предыдущая страница</span>
                    </span>
                </li>
            

            
                
                    
                        <li class="active">
                            <a href="index2679.html?page=1">1 <span class="sr-only">(текущая страница)</span></a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index4658.html?page=2">2</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index9ba9.html?page=3">3</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexfdb0.html?page=4">4</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexaf4d.html?page=5">5</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexc575.html?page=6">6</a>
                        </li>
                    
                
            

            
                <li class="next">
                    <a href="index4658.html?page=2" aria-label="следующая страница">
                        <span class="hidden-xs">следующая страница</span>
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            
        </ul>
    </nav>


</div>

        

        

        <div class="posts">
            
            
                
                




<table class="table table-bordered post post-row
       "
       id="post-169608"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/maisvendoo/index.html">
                <span class="post-username">maisvendoo</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/169608/index.html">#</a>
            6 лет, 3 месяца назад
            
                (отредактировано
                
                    6 лет, 3 месяца назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/f4/dc/f4dc0d9e80c61dbb447753a201a2676d.png" alt="maisvendoo avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/maisvendoo/topics/index.html">
                    68
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/maisvendoo/posts/index.html">
                    1142
                </a>
            </div>
            <div>
                Участник с: 10 октября 2012
            </div>
            
        </td>
        <td class="post-content">
            Многие жители форума знакомы с моей <a href="https://habrahabr.ru/post/228641/">статьей</a>, в которой рассказывается об установке Windows 7 на VHD диск. Отношение к ней неоднозначное: кто-то считает такой способ установки системы удобным, кто-то, весьма справедливо критикует его за излишнюю сложность.<br /><br />Почесав репу, я пришел к выводу, что да, действительно, это довольно сложный способ. Тем более он крайне тяжело осуществим, если вы используете разметку диска GPT и устанавливается EFI-версию Windows. На первый взгляд проще поставить винду обычным способом. Однако, тут таки есть один нюанс, который лично мне не нравится - установщик винды в режиме EFI хоть и не перезаписывает сектора диска своим кодом, но зато переопределяет NVRAM, подсовывая туда путь к своему загрузчику. Так что функционал GBUB всё равно приходится восстанавливать.<br /><br />В итоге разработан совершенно иной метод установки Windows версий 7/8/8.1/10. Работает это метод и в случае с MBR + BIOS системы, так и для случая с EFI + GPT. Установить систему можно как в раздел HDD, так и на VHD. При этом, идеологически он очень похож на установку арча - всё происходит под полным контролем пользователя, без изменения настроек загрузчка, который уже имеется у вас.<br /><br />Предположим у вас имеется компьютер, с установленным на HDD загрузчиком GRUB2 и свободным разделом, отформатированном в NTFS. Устанавливать будем Windows 7 Ultimate SP1. Для этого потребуются:<br /><br /><ol style="list-style-type:decimal;"><li>Установочный диск с виндой</li><li>Чистая флешка объемом &gt;= 4 Gb</li><li>Архиватор <a href="http://www.7-zip.org/">7-zip</a> соответствующей разрядности</li><li>Утилита BootICE, желательна, но совершенно не обязательна, можно обойтись и bcdedit.exe, входящим в дистрибутив винды</li></ol><br /><strong>1. Создаем загрузочную флешку</strong><br /><br />Дело в том, что семерка не хочет устанавливаться в EFI-режиме с DVD. Вот не хочет и всё. К тому же, на установочном носителе нам понадобятся дополнительные утилиты, которые туда надо поместить, а в случае с шлешкой это несколько проще, чем в случае с DVD.<br /><br />Монтируем установочный образ с виндой, допустим он лежит у нас в хомяке в каталоге <strong>install</strong> с именем <strong>win7-setup.iso</strong><br /><br /><pre><code>
$ mkdir ~/iso
$ sudo mount -t udf ~/install/win7-setup.iso ~/iso
</code></pre><br />Вставляем флешку в USB-порт. Допустим, она получила имя устройства <strong>/dev/sdb</strong>. Выполним её разметку в формате MBR<br /><br /><pre><code>
$ sudo fdisk /dev/sdb
</code></pre><br />Создем на флешке один единственный раздел. После чего форматируем её в FAT<br /><pre><code>
$ sudo mkfs.vfat /dev/sdb1
</code></pre><br />Копируем содержимое дистрибутива винды на флешку<br /><pre><code>
$ mkdir /tmp/flash
$ sudo mount /dev/sdb1 /tmp/flash -o uid=1000,gid=100,fmask=113,dmask=002
$ cp -rv ~/iso/* /tmp/flash/
</code></pre><br />Скопируем конфиги EFI-загрузчика на уровень выше<br /><br /><pre><code>
$ cp -rv ~/tmp/flash/efi/microsoft/* ~/tmp/flash/efi/
</code></pre><br />Теперь нам нужен EFI-загрузчик винды. Его придется выцарапать из дистрибутива. Это легко сделать с помощью архиватора 7-zip, который имеется в репозитории <strong>extra/p7zip</strong>. Все содержимое дистрибутива винды сжато в образ wim-формата находится на установочном DVD в файле <strong>source/install.wim</strong>. Обычно этот образ имеет следующую структуру<br /><br /><img src="http://storage3.static.itmages.ru/i/16/0523/h_1464011332_9702856_f970d91771.png"><br /><br />В каталогах с именами в виде цифр 1-4 находятся разные редакции винды. Чтобы выбрать нужную надо посмотреть внутрь файла с именем [1].xml. Распакуем его в /tmp<br /><br /><pre><code>
$ cd /tmp
$ 7z e ~/iso/sources/install.wim \[1\].xml
</code></pre><br />и посмотрим с помощью какого-нибудь браузера, ибо в текстовом редакторе он выглядит ужасно, а специального редактора xml у меня в наличии не оказалось. Каждую редакцию винды описывают структурой вида<br /><br /><img src="http://storage3.static.itmages.ru/i/16/0523/h_1464011544_9378232_6aa9388a58.png"><br /><br />где нода &lt;EDITIONID&gt; указывает на редакцию. Параметр INDEX - как раз номер каталога, в котором валяется нужная редакция. Итак, мне нужна Ultimate, а это индекс 4. Соответсвенно выковыриваем загрузчик оттуда<br /><br /><pre><code>
$ 7z e ~/iso/sources/install.wim 4/Windows/Boot/EFI/bootmgfw.efi
</code></pre><br />Оки, теперь перенесем полученный файл на флешку<br /><br /><pre><code>
$ mv bootmgfwmefi /tmp/flash/efi/boot/bootx64.efi
</code></pre><br />Порядок, теперь у нас в наличии загрузочная флешка для установки винды. Теперь добавим на неё необходимые для установки утилиты - виндозную версию архиватора 7-zip и утилиту BootICE. Архиватор качаем с официального сайта и распаковываем на флешку в каталог utils<br /><br /><pre><code>
$ mkdir -p /tmp/flash/utils/7-Zip/
$ cd /tmp/flash/utils/7-Zip/
$ 7z x ~/downloads/7z1602-x64.exe
</code></pre><br />Туда же помещаем и bootice<br /><br /><pre><code>
$ cp ~/install/BOOTICEx64.exe /tmp/flash/utils
</code></pre><br />Уф, всё, отмонтируем флешку<br /><pre><code>
$ cd ~
$ sudo umount /tmp/flash/
</code></pre><br />Перезагружаемся. Если у вас система с EFI и съемные диски стоят в приоритете загрузки, то компьютер загрузится в установку винды автоматом. Если же появилось таки меню GRUB, ничего страшного, жмем &quot;С&quot; и в консоли набиваем команду exit. Вас вывалит в меню EFI, где выбираем загрузку с флешки. Если же ваша система с BIOS, то тут чуть сложнее, ибо мы не стали заморачиваться с настройкой MBR на флешке. Тогда в консоли GRUB даем команду ls - появися список всех дисков и разделов. Находим нашу флешку, она отобразится в виде (hdX, msdosY), где X, Y - номер диска и раздела соответственно. Теперь вбиваем в консоли команды<br /><br /><pre><code>
grub&gt; set root=hdX,Y
grub&gt; ntldr /bootmgr
grub&gt; boot
</code></pre><br />Для режима MBR можно поставить GRUB на флешку, тогда при выборе в биосе загрузки со съемного носителя, установщик винды будет грузится так же автоматически, как и в случае с EFI<br /><br /><pre><code>
$ sudo fatlabel /dev/sdb1 SETUP
$ mkdir /tmp/flash/grub
$ sudo grub-install --target=i386-pc --boot-directory=/tmp/flash/grub /dev/sdb
</code></pre><br />Конфигурируем GRUB, причем корень лучше установить по метке тома<br /><br /><strong>/tmp/flash/grub/grub/grub.cfg</strong><br /><pre><code>
menuentry &#39;Windows 7 Setup&#39; {

search --label SETUP --set root
ntldr /bootmgr
}
</code></pre><br />Начнется загрузка установщика винды. Он то загрузится, но нам он и нафиг не нужен - мы всё будем делать руками ))) Чтобы стало понятно, что к чему, придется рассмотреть некоторую теорию<br /><br /><strong>2. О развертываении Windows из WIM-образа и капризном нраве Sysprep</strong><br /><br />Начиная с семерки установка Windows заключается в следующих этапах<br /><br /><ol style="list-style-type:decimal;"><li>Разметка диска в соответствии с архитектурой системы инициализации оборудования. Если BIOS - установщик размечает диск в MBR. При наличии активной EFI - разметка будет GPT.</li><li>Распаковка образа install.wim в выбранный для установки раздел</li><li>Установка загрузчика и перезагрузка</li><li>Инициализация оборудования. Ребут</li><li>Локализация, ввод ключа, окончание настройки системы</li></ol><br />Это стандартный путь. У нас же диск уже размечен. И нам не нужна автоматическая установка загрузчика - мы поставим его вручную. Разметка диска должна удовлетворять следующим требованиям<br /><br /><ul><li>Если система с EFI на диске должен присутствовать FAT-раздел с типом 0xEF. Если у нас уже установлен линукс с EFI-загрузчиком, то таковой раздел уже имеется</li><li>Если система с BIOS, то раздел, в котором располагается загрузчик, а это наш NTFS-раздел <strong>должен быть активным</strong>. Это очень важно! Почему, будет объяснено ниже.</li></ul><br />Таким образом, перед распаковкой системы мы должны убедится в том, что перечисленные требования выполнены. После того, как мы распакуем все файл системы и установим загрузчик, система перезагрузиться. После перезагрузки запустится утилита Sysprep, среди прочего настраивающая оборудования и проверяющая конфигурацию системы. Так вот, если в режиме EFI Sysprep не найдет загрузчик и его конфигурацию в EFI-разделе по пути EFI/microsof/boot, а в системе с BIOS каталог  \Boot и bootmgr будут лежать в неактивном разделе, то Sysprep завершится с ошибкой sysprep generalize error, а в лог, расположенный по адресу \Windows\Panther\sysperr.log выплюнет что-то похожее на<br /><br /><pre><code>
2015-03-11 16:55:42, Error      [0x0e00b3] TOOL   Sysprep_Specialize_Bcd: There was an error opening the system store. Status=[0xC0000098]
2015-03-11 16:55:42, Error      [0x0f0082] SYSPRP LaunchDll:Failure occurred while executing &#39;c:\Windows\System32\spbcd.dll,Sysprep_Specialize_Bcd&#39;, returned error code 1006
2015-03-11 16:55:42, Error      [0x060435] IBS    Callback_Specialize: An error occurred while either deciding if we need to specialize or while specializing; dwRet = 0x3ee
</code></pre><br />и никакие танцы с бубном нам уже не помогут. Винда требует, чтобы загручик лежал в загрузочном разделе и точка. В случае с BIOS просто делаем активным раздел NTFS в котором лежит винда и туда же кладем и загрузчик. Грузится будем всё равно с помощью GRUB, а ему все равно, какой раздел будет активным. В случае с EFI загрузчик придется положить рядом с GRUB в EFI-разделе.<br /><br /><strong>3. Распаковка системы</strong><br /><br />Итак, определимся, куда мы хотим ставить винду. Можно поставить в NTFS-раздел, а можно и в VHD-диск. Это уж как вам хочется. Я буду показывать процесс на примере с виртуальной машиной EFI, имеющей следующую разметку<br /><br /><pre><code>
The protective MBR&#39;s 0xEE partition is oversized! Auto-repairing.

Partition table scan:
  MBR: protective
  BSD: not present
  APM: not present
  GPT: present

Found valid GPT with protective MBR; using GPT.

Command (? for help): p
Disk /dev/loop1: 104857600 sectors, 50.0 GiB
Logical sector size: 512 bytes
Disk identifier (GUID): 0D217C93-6699-435A-9BBB-61DFAA6F30B7
Partition table holds up to 128 entries
First usable sector is 34, last usable sector is 104857566
Partitions will be aligned on 2048-sector boundaries
Total free space is 4029 sectors (2.0 MiB)

Number  Start (sector)    End (sector)  Size       Code  Name
   1            2048          206847   100.0 MiB   EF00  EFI system partition
   2          206848       104855551   49.9 GiB    0700  Basic data partition
</code></pre><br />На этом диске нет линукса, установлен только GRUB в раздел с EFI. Если мы ставим систему непосредственно в NTFS-раздел, то загружаемся с флешки, дожидаемся запуска программы установки и жмем Shift + F10, чтобы вызвать консоль. Запускаем утилиту diskpart и смотрим список подключенных томов<br /><br /><pre><code>
X:\sources&gt; diskpart
DISKPART&gt; list vol
</code></pre><br /><a href="http://itmages.ru/image/view/4306890/0a51d3b1"><img src="http://storage4.static.itmages.ru/i/16/0523/s_1464029816_5122225_0a51d3b144.png"></a><br /><br />Видим, что флешка (объемом 8 Гб) подключена как диск C:, а раздел для установки вовсе не смонтирован. Непорядок. Делаем так<br /><br /><pre><code>
DISKPART&gt; sel vol 3
DISKPART&gt; remove
DISKPART&gt; assign letter=E
DISKPART&gt; sel vol 1
DISKPART&gt; assign letter=C
DISKPART&gt; list vol
DISKPART&gt; sel vol 2
DISKPART&gt; assign letter=F
</code></pre><br />Вот теперь порядок, диск на который будем ставить винду стал диском C:, флешка - диском E:, а EFI-раздел - диском F:<br /><br /><a href="http://itmages.ru/image/view/4307142/9f33e166"><img src="http://storage8.static.itmages.ru/i/16/0523/s_1464033582_8971769_9f33e166be.png"></a><br /><br />Если же мы хотим поставить систему на VHD, то делаем так<br /><br /><pre><code>
DISKPART&gt; sel vol 3
DISKPART&gt; remove
DISKPART&gt; assign letter=E
DISKPART&gt; sel vol 1
DISKPART&gt; assign letter=G
DISKPART&gt; exit
</code></pre><br />Для порядка создаем каталог с образами<br /><pre><code>
X:\sources&gt; md G:\vhd
X:\sources&gt; diskpart
</code></pre><br />Создаем виртуальный диск, создаем на нем разметку GPT и раздел NTFS и понтируем его к C:<br /><br /><pre><code>
DISKPART&gt; create vdisk file=&quot;G:\vhd\win7.vhd&quot; maximum=25600 type=fixed
DISKPART&gt; attach vdisk
DISKPART&gt; clean
DISKPART&gt; convert gpt
DISKPART&gt; create part primary
DISKPART&gt; format fs=ntfs quick
DISKPART&gt; assign letter=C
</code></pre><br />EFI-раздел монтируем к F:<br /><br /><pre><code>
DISKPART&gt; sel vol 2
DISKPART&gt; assign letter=F
</code></pre><br />Получаем такую картину<br /><br /><a href="http://itmages.ru/image/view/4306897/4920e0ad"><img src="http://storage1.static.itmages.ru/i/16/0523/s_1464029899_3374035_4920e0ad7c.png"></a><br /><br /><strong>Очень важно!</strong> Убеждаемся в том, что EFI-раздел отформатирован именно в FAT, а не в FAT32. Иначе Sysprep не простит нам этой ошибки. Если на компе уже есть линукс, то настройки будут верны.<br /><br />Теперь распаковываем дистрибутив на диск C:<br /><br /><pre><code>
X:\sources&gt; E:
E:\&gt; utils\7-Zip\7zFM.exe
</code></pre><br />Откроется GUI архиватора 7-zip. В нем открываем каталог E:\sources, находим там файл install.wim<br /><br /><a href="http://itmages.ru/image/view/4306530/dbfb3a7e"><img src="http://storage9.static.itmages.ru/i/16/0523/s_1464023323_4840480_dbfb3a7eed.png"></a><br /><br />Правой кнопкой на этом файле вызываем контектстное меню и переходим по 7-zip -&gt; Открыть архив. Появится содержимое образа. Лезем в папку 4 - там лежит ультимейт<br /><br /><a href="http://itmages.ru/image/view/4306540/31a0ac83"><img src="http://storage9.static.itmages.ru/i/16/0523/s_1464023569_7688794_31a0ac8390.png"></a><br /><br />Выделяем всё Ctrl + A и жмем кнопку &quot;Извлечь&quot;. Появится окно, где нам предложат указать путь распаковки<br /><br /><a href="http://itmages.ru/image/view/4306545/a7cdc7c5"><img src="http://storage6.static.itmages.ru/i/16/0523/s_1464023701_3495009_a7cdc7c546.png"></a><br /><br />Указываем корень диска C: и жмем ОК.<br /><br /><a href="http://itmages.ru/image/view/4306553/a957597f"><img src="http://storage5.static.itmages.ru/i/16/0523/s_1464023792_6897133_a957597f4d.png"></a><br /><br />Всё, теперь ждемс...<br /><br /><strong>4. Установка и настройка загрузчика</strong><br /><br />Итак, после некоторого время ожидания распаковка окончена. И вот тут, вот в этом месте винда обчно делает бяку, а именно портит MBR или перенастраивает NVRAM. Но мы не дадим ей этого сделать - мы установим загрузчик вручную.<br /><br />В случае с EFI, переходим на раздел EFI, смонтированный к F: и создаем необходимые пути и копируем файлы загрузчика<br /><br /><pre><code>
E:\&gt; F:
F:\&gt; mkdir EFI\microsoft\boot
F:\&gt; xcopy C:\Windows\Boot\EFI\* F:\EFI\microsoft\boot /s /e
F:\&gt; mkdir EFI\microsoft\boot\Fonts
F:\&gt; xcopy C:\Windows\Boot\Fonts\* F:\EFI\microsoft\boot\Fonts\ /s /e
F:\&gt; copy C:\Windows\System32\config\BCD-Template F:\EFI\microsoft\boot\BCD
</code></pre><br />Отлично, загрузчик скопирован. Теперь настроим его<br /><br /><pre><code>
F:\&gt; E:\utils\BOOTICEx64.exe
</code></pre><br />Открываем файл F:\EFI\Microsoft\Boot\BCD. В случае установки на раздел, его параметры задаются так<br /><br /><a href="http://itmages.ru/image/view/4306984/c6124bfa"><img src="http://storage1.static.itmages.ru/i/16/0523/s_1464031079_8276222_c6124bfa4f.png"></a><br /><br />Если же мы устанавливали систему на VHD, то настройки будут такими<br /><br /><a href="http://itmages.ru/image/view/4306993/486a2825"><img src="http://storage9.static.itmages.ru/i/16/0523/s_1464031186_8186923_486a282586.png"></a><br /><br /><strong>Важно!</strong> Имя вторичного загрузчика для EFI-системы <strong>winload.efi</strong>, для BIOS-системы - <strong>winload.exe</strong>.<br /><br />В случае, если мы устанавливаем BIOS-систему установка загрузчика будет выглядеть так<br /><br /><pre><code>
F:\&gt; mkdir C:\Boot
F:\&gt; xcopy C:\Windows\Boot\PCAT\* C:\Boot /s /e
F:\&gt; mkdir C:\Boot\Fonts
F:\&gt; xcopy C:\Windows\Boot\Fonts\* C:\Boot\Fonts /s /e
F:\&gt; copy C:\Boot\bootmgr C:\bootmgr
F:\&gt; copy C:\Windows\System32\config\BCD-Template C:\Boot\BCD
</code></pre><br /><strong>Важно!</strong> Раздел, смонтированный к C: (там где размещен загрузчик) обязан быть активным! Убедитесь в этом перед перезагрузкой!<br /><br />Настройку выполняем так же точно, используя BootICE.<br /><br />Ну, вроде все. Закрываем все окна и идем в ребут. Флешку можно вытащить из компа.<br /><br /><strong>5. Скрестим пальцы да вознесем молитвы тебе, о Великий и Ужасный Sysprep...!</strong><br /><br />GRUB у нас еще не настроен пункта для винды в меню нет. Как только появится меню GRUB жмем &quot;C&quot;. В консоли набираем<br /><br /><pre><code>
grub&gt; set root=hdX,Y
grub&gt; chainloader /EFI/Microsoft/Boot/bootmgfw.efi
grub&gt; boot
</code></pre><br />X, Y - соответственно диск и раздел, где лежит загрузчик. Это в случае EFI. В случае с BIOS делаем так<br /><br /><pre><code>
grub&gt; set root=hdX,Y
grub&gt; ntldr /bootmgr
grub&gt; boot
</code></pre><br />X, Y - диск и раздел с NTFS. Там где распакована винда и лежит её загрузчик.<br /><br />Ждем... В режиме EFI вы сначала увидите черный экран. Не пугайтесь - просто я не нашел злосчатную dll с логотипами, пока что. В случае с BIOS увидим знакомую летающую эмблему винды. А потом в обоих случаях увидим это<br /><br /><a href="http://itmages.ru/image/view/4307060/f1572fa3"><img src="http://storage3.static.itmages.ru/i/16/0523/s_1464032258_7533000_f1572fa388.png"></a><br /><br />Ждем и молимся. На 57% моргнет экран - настраивается видяха. И если мы все сделали верно, то надпись &quot;Применение параметров системы&quot; повисит довольно долго, потом система сообщит, что установка будет продолжена после перезагрузки. Если мы где-то напортачили с установкой загрузчика - неправильный EFI раздел или неактивный NTFS, то тогда будет ошибка :( Но мы молодцы и у нас все получится, и после очередной перезагрузки мы увидим это<br /><br /><a href="http://itmages.ru/image/view/4307069/9dc762bc"><img src="http://storage3.static.itmages.ru/i/16/0523/s_1464032451_4601016_9dc762bc58.png"></a><br /><br />а потом, наконец вот это<br /><br /><a href="http://itmages.ru/image/view/4307070/23efd35c"><img src="http://storage4.static.itmages.ru/i/16/0523/s_1464032476_9103196_23efd35c7d.png"></a><br /><br />Дальше все как при обычной, штатной установке.<br /><br /><strong>6. Настраиваем GRUB</strong><br /><br />Обратили внимание на то, что каждый раз мы грузим систему из консоли GRUB руками. Это очень хорошо - значит ни MBR ни NVRAM не перезаписаны коварным майкрософтом. Настало время грузится в арч и добавить в меню GRUB новый пункт<br /><br /><pre><code>
menuentry &#39;Windows 7 Ultimate SP1 (EFI)&#39; {

	set root=hdX,Y
	chainloader /EFI/Microsoft/Boot/bootmgfw.efi
}
</code></pre><br />в случае EFI. Или<br /><br /><pre><code>
menuentry &#39;Windows 7 Ultimate SP1&#39; {

	set root=hdX,Y
	ntldr /bootmgr
}
</code></pre><br />в случае BIOS. Применяем настройки GRUB и перезагружаемся....<br /><br /><a href="http://itmages.ru/image/view/4307097/55cff0ba"><img src="http://storage3.static.itmages.ru/i/16/0523/s_1464033064_6044675_55cff0ba7d.png"></a> <a href="http://itmages.ru/image/view/4307099/212cc6c5"><img src="http://storage5.static.itmages.ru/i/16/0523/s_1464033081_6716711_212cc6c592.png"></a><br /><br /><strong>Выводы</strong><br /><br />Злой Майкрософт побежден. Винда может быть установлена без вмешательства в настройки загрузки. А если бы написать аналог bcdedit.exe или BootICE под линукс, то всё перечисленное можно было бы проделать не выходя из Арча. Прямо в арче - и образ раскатать и загрузчик настроить. И никаких виртуальных машин.
            
                
                    <div class="post-signature">
                        Да пребудет с нами Сила...!<br />CPU Intel Core i9 10900-KF/RAM DDR4 128 Gb/NVidia GForce GTX 1080 Ti Turbo 11Gb/SSD M2 512 Gb/HDD Seagate SATA3 2 Tb/HDD Toshiba 3Tb/HDD Toshiba 6Tb<br /><a href="http://rusrailsim.org/">http://rusrailsim.org</a>
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-169615"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/jim945/index.html">
                <span class="post-username">jim945</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/169615/index.html">#</a>
            6 лет, 3 месяца назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/f7/09/f709d8f74afad03709f159a1e12444ef.png" alt="jim945 avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/jim945/topics/index.html">
                    8
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/jim945/posts/index.html">
                    3066
                </a>
            </div>
            <div>
                Участник с: 25 января 2010
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>maisvendoo</em><br>Злой Майкрософт побежден. Винда может быть установлена без вмешательства в настройки загрузки. А если бы написать аналог bcdedit.exe или BootICE под линукс, то всё перечисленное можно было бы проделать не выходя из Арча. Прямо в арче - и образ раскатать и загрузчик настроить. И никаких виртуальных машин.</blockquote>значит wim можно распаковать из линукса?
            
                
                    <div class="post-signature">
                        Lupus pilum mutat, non mentem.
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-169616"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/maisvendoo/index.html">
                <span class="post-username">maisvendoo</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/169616/index.html">#</a>
            6 лет, 3 месяца назад
            
                (отредактировано
                
                    6 лет, 3 месяца назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/f4/dc/f4dc0d9e80c61dbb447753a201a2676d.png" alt="maisvendoo avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/maisvendoo/topics/index.html">
                    68
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/maisvendoo/posts/index.html">
                    1142
                </a>
            </div>
            <div>
                Участник с: 10 октября 2012
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>jim945</em><br>значит wim можно распаковать из линукса?</blockquote>Да, можно. Используя 7-zip<br /><br />И если бы был аналог bcdedit для линукса, то можно было бы установить винду из линукса. И, например сделать live-носитель с установщиком на bash-скриптах. Как говорят на лоре - &quot;не нужен&quot; стандартный установщик<br /><br /><strong>Upd:</strong> Опубликовал это на хабре. Тут же посоветовали ценный для данной задачи тулз - <a href="https://aur.archlinux.org/packages/wimlib/">wimlib</a><br /><pre><code>
[maisvendoo@arch-host win7-efi]$ wimlib-imagex info ~/iso/sources/install.wim
WIM Information:
----------------
Path:           /home/maisvendoo/iso/sources/install.wim
GUID:           0xd2cd8e1cb9c7144483bad0dac385534d
Version:        68864
Image Count:    4
Compression:    LZX
Chunk Size:     32768 bytes
Part Number:    1/1
Boot Index:     0
Size:           2850077531 bytes
Attributes:     Integrity info, Relative path junction

Available Images:
-----------------
Index:                  1
Name:                   Windows 7 HOMEBASIC
Description:            Windows 7 HOMEBASIC
Display Name:           Windows 7 Домашняя базовая
Display Description:    Windows 7 Домашняя базовая
Directory Count:        13976
File Count:             66508
Total Bytes:            11529408728
Hard Link Bytes:        4376878446
Creation Time:          Вс ноя 21 04:39:25 2010 UTC
Last Modification Time: Вс ноя 21 13:14:41 2010 UTC
Architecture:           x86_64
Product Name:           Microsoft® Windows® Operating System
Edition ID:             HomeBasic
Installation Type:      Client
HAL:                    acpiapic
Product Type:           WinNT
Product Suite:          Terminal Server
Languages:              ru-RU
Default Language:       ru-RU
System Root:            WINDOWS
Major Version:          6
Minor Version:          1
Build:                  7601
Service Pack Build:     17514
Service Pack Level:     1
Flags:                  HomeBasic
WIMBoot compatible:     no

Index:                  2
Name:                   Windows 7 HOMEPREMIUM
Description:            Windows 7 HOMEPREMIUM
Display Name:           Windows 7 Домашняя расширенная
Display Description:    Windows 7 Домашняя расширенная
Directory Count:        14226
File Count:             67569
Total Bytes:            12042784908
Hard Link Bytes:        4792628161
Creation Time:          Вс ноя 21 04:39:25 2010 UTC
Last Modification Time: Вс ноя 21 13:15:42 2010 UTC
Architecture:           x86_64
Product Name:           Microsoft® Windows® Operating System
Edition ID:             HomePremium
Installation Type:      Client
HAL:                    acpiapic
Product Type:           WinNT
Product Suite:          Terminal Server
Languages:              ru-RU
Default Language:       ru-RU
System Root:            WINDOWS
Major Version:          6
Minor Version:          1
Build:                  7601
Service Pack Build:     17514
Service Pack Level:     1
Flags:                  HomePremium
WIMBoot compatible:     no

Index:                  3
Name:                   Windows 7 PROFESSIONAL
Description:            Windows 7 PROFESSIONAL
Display Name:           Windows 7 Профессиональная
Display Description:    Windows 7 Профессиональная
Directory Count:        14314
File Count:             68104
Total Bytes:            11945156754
Hard Link Bytes:        4667733545
Creation Time:          Вс ноя 21 04:39:25 2010 UTC
Last Modification Time: Вс ноя 21 13:16:43 2010 UTC
Architecture:           x86_64
Product Name:           Microsoft® Windows® Operating System
Edition ID:             Professional
Installation Type:      Client
HAL:                    acpiapic
Product Type:           WinNT
Product Suite:          Terminal Server
Languages:              ru-RU
Default Language:       ru-RU
System Root:            WINDOWS
Major Version:          6
Minor Version:          1
Build:                  7601
Service Pack Build:     17514
Service Pack Level:     1
Flags:                  Professional
WIMBoot compatible:     no

Index:                  4
Name:                   Windows 7 ULTIMATE
Description:            Windows 7 ULTIMATE
Display Name:           Windows 7 Максимальная
Display Description:    Windows 7 Максимальная
Directory Count:        14350
File Count:             68286
Total Bytes:            12107983977
Hard Link Bytes:        4828481537
Creation Time:          Вс ноя 21 04:39:25 2010 UTC
Last Modification Time: Вс ноя 21 13:17:22 2010 UTC
Architecture:           x86_64
Product Name:           Microsoft® Windows® Operating System
Edition ID:             Ultimate
Installation Type:      Client
HAL:                    acpiapic
Product Type:           WinNT
Product Suite:          Terminal Server
Languages:              ru-RU
Default Language:       ru-RU
System Root:            WINDOWS
Major Version:          6
Minor Version:          1
Build:                  7601
Service Pack Build:     17514
Service Pack Level:     1
Flags:                  Ultimate
WIMBoot compatible:     no
</code></pre><br /><pre><code>
[maisvendoo@arch-host win7-efi]$ mkdir /tmp/wim
[maisvendoo@arch-host win7-efi]$ wimlib-imagex mount ~/iso/sources/install.wim 4 /tmp/wim
[maisvendoo@arch-host win7-efi]$ ls /tmp/wim -l
итого 0
lrwxrwxrwx 1 maisvendoo users 0 июл 14  2009 &#39;Documents and Settings&#39; -&gt; /tmp/wim/Users
drwxrwxrwx 1 maisvendoo users 0 июл 14  2009 PerfLogs
drwxrwxrwx 1 maisvendoo users 0 июл 14  2009 ProgramData
drwxrwxrwx 1 maisvendoo users 0 ноя 21  2010 &#39;Program Files&#39;
drwxrwxrwx 1 maisvendoo users 0 июл 14  2009 &#39;Program Files (x86)&#39;
drwxrwxrwx 1 maisvendoo users 0 ноя 21  2010 &#39;$Recycle.Bin&#39;
drwxrwxrwx 1 maisvendoo users 0 ноя 21  2010 Users
drwxrwxrwx 1 maisvendoo users 0 ноя 21  2010 Windows
</code></pre>
            
                
                    <div class="post-signature">
                        Да пребудет с нами Сила...!<br />CPU Intel Core i9 10900-KF/RAM DDR4 128 Gb/NVidia GForce GTX 1080 Ti Turbo 11Gb/SSD M2 512 Gb/HDD Seagate SATA3 2 Tb/HDD Toshiba 3Tb/HDD Toshiba 6Tb<br /><a href="http://rusrailsim.org/">http://rusrailsim.org</a>
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-169627"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/jim945/index.html">
                <span class="post-username">jim945</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/169627/index.html">#</a>
            6 лет, 3 месяца назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/f7/09/f709d8f74afad03709f159a1e12444ef.png" alt="jim945 avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/jim945/topics/index.html">
                    8
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/jim945/posts/index.html">
                    3066
                </a>
            </div>
            <div>
                Участник с: 25 января 2010
            </div>
            
        </td>
        <td class="post-content">
            BCD файл - это же кусок реестра, если не ошибаюсь.<br />Открылся в hivexsh. Что-то там есть...
            
                
                    <div class="post-signature">
                        Lupus pilum mutat, non mentem.
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-169639"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/maisvendoo/index.html">
                <span class="post-username">maisvendoo</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/169639/index.html">#</a>
            6 лет, 3 месяца назад
            
                (отредактировано
                
                    6 лет, 3 месяца назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/f4/dc/f4dc0d9e80c61dbb447753a201a2676d.png" alt="maisvendoo avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/maisvendoo/topics/index.html">
                    68
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/maisvendoo/posts/index.html">
                    1142
                </a>
            </div>
            <div>
                Участник с: 10 октября 2012
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>jim945</em><br>hivexsh</blockquote>Да, это куст реестра. И да, читается верно<br /><br /><pre><code>
BCD\&gt; ls
Description
Objects
BCD\&gt; cd Objects
BCD\Objects&gt; ls
{0aadda60-01d8-4e67-a646-a312249d3487}
{88063e7f-18ce-4000-923f-50c044132e98}
{9dea862c-5cdd-4e70-acc1-f32b344d4795}
BCD\Objects&gt;
</code></pre><br />Причем {9dea862c-5cdd-4e70-acc1-f32b344d4795} - это стандартный раздел {bootmgr}. Остальные две - загрузочные записи имеющиеся у меня<br /><br />Весьма и весьма занятно... Проект <a href="https://bitbucket.org/patatetom/hivexsh/overview">хостится на битбукете</a><br /><br /><strong>Upd:</strong> hivexml позволяет перекрутить данные в структуру<br /><br /><pre><code>
&lt;node name=&quot;12000002&quot;&gt;
&lt;mtime&gt;2016-02-02T11:37:46Z&lt;/mtime&gt;
&lt;byte_runs&gt;
&lt;byte_run file_offset=&quot;9944&quot; len=&quot;88&quot;/&gt;
&lt;/byte_runs&gt;
&lt;value type=&quot;string&quot; key=&quot;Element&quot; value=&quot;\Windows\system32\winload.exe&quot;&gt;
&lt;byte_runs&gt;
&lt;byte_run file_offset=&quot;10032&quot; len=&quot;31&quot;/&gt;
&lt;byte_run file_offset=&quot;10064&quot; len=&quot;64&quot;/&gt;
&lt;/byte_runs&gt;
&lt;/value&gt;
&lt;/node&gt;
&lt;node name=&quot;12000004&quot;&gt;
&lt;mtime&gt;2016-02-02T11:38:13Z&lt;/mtime&gt;
&lt;byte_runs&gt;
&lt;byte_run file_offset=&quot;10536&quot; len=&quot;88&quot;/&gt;
&lt;/byte_runs&gt;
&lt;value type=&quot;string&quot; key=&quot;Element&quot; value=&quot;Windows 7 for UM&quot;&gt;
&lt;byte_runs&gt;
&lt;byte_run file_offset=&quot;10624&quot; len=&quot;31&quot;/&gt;
&lt;byte_run file_offset=&quot;10864&quot; len=&quot;38&quot;/&gt;
&lt;/byte_runs&gt;
&lt;/value&gt;
&lt;/node&gt;
</code></pre><br />И это таки один из пунктов моего меню для загрузки винды. Сама библиотека hivex позволяет редактировать реестр винды. Это уже что-то, что можно использовать
            
                
                    <div class="post-signature">
                        Да пребудет с нами Сила...!<br />CPU Intel Core i9 10900-KF/RAM DDR4 128 Gb/NVidia GForce GTX 1080 Ti Turbo 11Gb/SSD M2 512 Gb/HDD Seagate SATA3 2 Tb/HDD Toshiba 3Tb/HDD Toshiba 6Tb<br /><a href="http://rusrailsim.org/">http://rusrailsim.org</a>
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-169658"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/jim945/index.html">
                <span class="post-username">jim945</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/169658/index.html">#</a>
            6 лет, 3 месяца назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/f7/09/f709d8f74afad03709f159a1e12444ef.png" alt="jim945 avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/jim945/topics/index.html">
                    8
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/jim945/posts/index.html">
                    3066
                </a>
            </div>
            <div>
                Участник с: 25 января 2010
            </div>
            
        </td>
        <td class="post-content">
            <a href="http://white55.narod.ru/bootmgr.html">Вот.</a> Поднял архивы)))<br />может пригодится
            
                
                    <div class="post-signature">
                        Lupus pilum mutat, non mentem.
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-169663"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/maisvendoo/index.html">
                <span class="post-username">maisvendoo</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/169663/index.html">#</a>
            6 лет, 3 месяца назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/f4/dc/f4dc0d9e80c61dbb447753a201a2676d.png" alt="maisvendoo avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/maisvendoo/topics/index.html">
                    68
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/maisvendoo/posts/index.html">
                    1142
                </a>
            </div>
            <div>
                Участник с: 10 октября 2012
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>jim945</em><br>Вот. Поднял архивы)))</blockquote>Я знаком с этим циклом статей. Оттуда многое почерпнул. Но всё равно спасибо. Ещё есть <a href="http://datadump.ru/">замечательный блог</a>, на котором в частности есть <a href="http://datadump.ru/bootmgr-windows-7/">вот это</a>, <a href="http://datadump.ru/tag/pbr/">это</a> и ещё <a href="http://datadump.ru/mbr-windows7/">вот</a> )
            
                
                    <div class="post-signature">
                        Да пребудет с нами Сила...!<br />CPU Intel Core i9 10900-KF/RAM DDR4 128 Gb/NVidia GForce GTX 1080 Ti Turbo 11Gb/SSD M2 512 Gb/HDD Seagate SATA3 2 Tb/HDD Toshiba 3Tb/HDD Toshiba 6Tb<br /><a href="http://rusrailsim.org/">http://rusrailsim.org</a>
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-169665"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/jim945/index.html">
                <span class="post-username">jim945</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/169665/index.html">#</a>
            6 лет, 3 месяца назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/f7/09/f709d8f74afad03709f159a1e12444ef.png" alt="jim945 avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/jim945/topics/index.html">
                    8
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/jim945/posts/index.html">
                    3066
                </a>
            </div>
            <div>
                Участник с: 25 января 2010
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>maisvendoo</em><br>вот это, это и ещё вот )</blockquote>Спасибо. проходили)))<br /><blockquote><em>maisvendoo</em><br>Upd: hivexml позволяет перекрутить данные в структуру</blockquote>Обратно соберется интересно? :)
            
                
                    <div class="post-signature">
                        Lupus pilum mutat, non mentem.
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-169671"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/maisvendoo/index.html">
                <span class="post-username">maisvendoo</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/169671/index.html">#</a>
            6 лет, 3 месяца назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/f4/dc/f4dc0d9e80c61dbb447753a201a2676d.png" alt="maisvendoo avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/maisvendoo/topics/index.html">
                    68
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/maisvendoo/posts/index.html">
                    1142
                </a>
            </div>
            <div>
                Участник с: 10 октября 2012
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>jim945</em><br>Обратно соберется интересно? :)</blockquote>Это излишне сложно будет, тем более что обратного конвертора в составе пакета нет. Единственный вариант - писать специальное приложение на C/С++, используя hivex в качестве средства работы с реестром. Тут же можно задействовать и исходники ReactOS - там есть ашник, описывающий BCD-хранилище, и при просмотре по диагонали вроде значения ключей совпадают с виндовыми. И в MSDN имеется описание некоторых структур этого файла.<br /><br />Так что задача написания редактора BCD для линукс представляется мне вполне решаемой. При наличии такой утилиты и используя wimlib вполне реально создать альтернативный инсталлятор винды на основе live-носителя с Linux, с кастомизацией загрузчика, да и много ещё с чем.<br /><br />Если использовать в качестве Live-носителя winPE, то такой инсталлятор можно сделать уже сейчас - приведенная выше статья это примерный алгоритм его работы<br /><br />
            
                
                    <div class="post-signature">
                        Да пребудет с нами Сила...!<br />CPU Intel Core i9 10900-KF/RAM DDR4 128 Gb/NVidia GForce GTX 1080 Ti Turbo 11Gb/SSD M2 512 Gb/HDD Seagate SATA3 2 Tb/HDD Toshiba 3Tb/HDD Toshiba 6Tb<br /><a href="http://rusrailsim.org/">http://rusrailsim.org</a>
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-169676"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/scorpid/index.html">
                <span class="post-username">scorpid</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/169676/index.html">#</a>
            6 лет, 3 месяца назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/0d/a4/0da4f56adfecb050fac8e5a4b3725636.png" alt="scorpid avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/scorpid/topics/index.html">
                    4
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/scorpid/posts/index.html">
                    294
                </a>
            </div>
            <div>
                Участник с: 14 апреля 2015
            </div>
            
        </td>
        <td class="post-content">
            Спасибо за мануал !!!
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
        </div>
        <div>&nbsp;</div>
        
            <div class="text-center">
    


    <nav>
        <ul class="pagination">
            
                <li class="previous disabled">
                    <span>
                        <span aria-hidden="true">&laquo;</span>
                        <span class="hidden-xs">предыдущая страница</span>
                    </span>
                </li>
            

            
                
                    
                        <li class="active">
                            <a href="index2679.html?page=1">1 <span class="sr-only">(текущая страница)</span></a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index4658.html?page=2">2</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index9ba9.html?page=3">3</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexfdb0.html?page=4">4</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexaf4d.html?page=5">5</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexc575.html?page=6">6</a>
                        </li>
                    
                
            

            
                <li class="next">
                    <a href="index4658.html?page=2" aria-label="следующая страница">
                        <span class="hidden-xs">следующая страница</span>
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            
        </ul>
    </nav>


</div>

        

        

        
            
<a href="../../../accounts/register/index.html">Зарегистрироваться</a> или <a href="../../../accounts/login/index1982.html?next=/forum/topic/16097/">войдите</a> чтобы оставить сообщение.

        

        
    </div>

        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

</body>

<!-- Mirrored from archlinux.org.ru/forum/topic/16097/?page=1 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 05:32:00 GMT -->
</html>
