


<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        [РЕШЕНО] Systemd и cron
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://storage.yandexcloud.net/aor-static/static/css/default.css">
    
    
    

    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/posts/" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/topics/" title="Последние темы на форуме" >

    
    
    
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/jquery.formset.min.js"></script>

</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="/">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="/news/">Новости</a></li>
    <li class="active"><a href="/forum/">Форум</a></li>
    <li class=""><a href="/blogs/">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_%28%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9%29">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="/irc/#chat">IRC</a></li>
      <li class="dropdown">
        <a href="/accounts/login/" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="/accounts/login/">Вход</a></li>
          <li><a href="/accounts/register/">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="/messages/inbox/" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="/">ArchLinux.org.ru</a></li>


    <li><a href="/forum/">Начало</a> <span class="divider">/</span></li>
    
        
            
                <li><a href="/forum/category/2/">Поддержка пользователей</a> <span class="divider">/</span></li>
            
                <li><a href="/forum/forum/9/">Новичкам в Arch Linux</a> <span class="divider">/</span></li>
            
        
        
            <li>[РЕШЕНО] Systemd и cron</li>
        
    
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    
    <div class="topic">
        <h1>[РЕШЕНО] Systemd и cron</h1>
        
            <div class="text-center">
    



</div>

        

        

        <div class="posts">
            
            
                
                




<table class="table table-bordered post post-row
       "
       id="post-2058"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/rec/">
                <span class="post-username">rec</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/2058/">#</a>
            9 лет, 9 месяцев назад
            
                (отредактировано
                
                    9 лет, 8 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/59/e6/59e633eaa20e7c7212550c73859984bf.png" alt="rec avatar" />
    
</div>

            <div>
                Темы:
                <a href="/forum/users/rec/topics/">
                    16
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/rec/posts/">
                    86
                </a>
            </div>
            <div>
                Участник с: 24 июня 2010
            </div>
            
        </td>
        <td class="post-content">
            <a href="https://wiki.archlinux.org/index.php/Systemd_%28%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9%29#.D0.A1.D0.BE.D0.BE.D0.B1.D1.80.D0.B0.D0.B6.D0.B5.D0.BD.D0.B8.D1.8F_.D0.BF.D0.B5.D1.80.D0.B5.D0.B4_.D0.BD.D0.B0.D1.87.D0.B0.D0.BB.D0.BE.D0.BC_.D0.BC.D0.B8.D0.B3.D1.80.D0.B0.D1.86.D0.B8.D0.B8">Цитата</a> из вики: <blockquote>&#8230;systemd вполне способна заменить определенную функциональность таких демонов, как <strong>cron</strong>&#8230;</blockquote>Может заменить.. а как?
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-2059"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/and4027/">
                <span class="post-username">and4027</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/2059/">#</a>
            9 лет, 9 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/and4027/topics/">
                    0
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/and4027/posts/">
                    49
                </a>
            </div>
            <div>
                Участник с: 08 сентября 2010
            </div>
            
        </td>
        <td class="post-content">
            Может быть, установка и запуск сервиса cronie.service?
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-2060"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/sleepycat/">
                <span class="post-username">sleepycat</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/2060/">#</a>
            9 лет, 9 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/f2/c0/f2c02cdf7ab1395c1ebcd403ff0c9d53.png" alt="sleepycat avatar" />
    
</div>

            <div>
                Темы:
                <a href="/forum/users/sleepycat/topics/">
                    98
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/sleepycat/posts/">
                    3291
                </a>
            </div>
            <div>
                Участник с: 19 июля 2011
            </div>
            
        </td>
        <td class="post-content">
            чисто теоретически - таймером. Но когда я смотрел нужно было самому создвать юниты так как целиком из коробки самое простое это завести cronie.<br/><blockquote>Consider removing cron from your system and use systemd timer units instead. Timer units currently have no support for calendar times (i.e. cannot be used to spawn things &ldquo;at 6 am every monday&rdquo;, but can do &ldquo;run this every 7 days&rdquo;), but for the usual /etc/cron.daily/, /etc/cron.weekly/, &#8230; should be good enough, if the time of day of the execution doesn't matter (just add four small service and timer units for supporting these dirs. Eventually we might support these out of the box, but until then, just write your own scriplets for this).</blockquote> <a href="https://freedesktop.org/wiki/Software/systemd/Optimizations">http://freedesktop.org/wiki/Software/sy &#8230; imizations</a> 
            
                
                    <div class="post-signature">
                        Лозунг у них был такой: &quot;Познание бесконечности требует бесконечного времени&quot;. С этим я не спорил, но они делали из этого неожиданный вывод: &quot;А потому работай не работай — все едино&quot;. И в интересах неувеличения энтропии Вселенной они не работали. (с)
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-2061"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/rec/">
                <span class="post-username">rec</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/2061/">#</a>
            9 лет, 8 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/59/e6/59e633eaa20e7c7212550c73859984bf.png" alt="rec avatar" />
    
</div>

            <div>
                Темы:
                <a href="/forum/users/rec/topics/">
                    16
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/rec/posts/">
                    86
                </a>
            </div>
            <div>
                Участник с: 24 июня 2010
            </div>
            
        </td>
        <td class="post-content">
            Про systemd хорошо написано <a href="https://docs.google.com/open?id=1RnTqtQ2nhP23hyedsl7YrclqqY1qNuP18x94KRe_owmK2LZfnZ0LSJK5ma9m">здесь</a>, но про таймеры очень мало. После прочтения понял, что системд рулит и пошёл читать маны.<br/>В итоге получилось заменить крон на <a href="https://www.freedesktop.org/software/systemd/man/systemd.timer.html">systemd.timer</a>.<br/>Последовательность действий (на примере grive):<br/>1. Создаём файл таймера /etc/systemd/system/grive.timer со следующим содержимым:<br/><div class="code"><pre>[Timer]
OnBootSec=15min
OnUnitActiveSec=15min
Unit=grive.service
[Install]
WantedBy=multi-user.target</pre></div>2. Создаём юнит-файл /etc/systemd/system/grive.service<br/><div class="code"><pre>[Unit]
Description=Synchronize my files
[Service]
WorkingDirectory=/home/rec/.grive
Nice=10
ExecStart=/usr/bin/grive
Type=simple</pre></div>3. Включаем наш таймер:<br/><div class="code"><pre>#systemctl start grive.timer
#systemctl enable grive.timer</pre></div>4. Проверяем статус таймера:<br/><div class="code"><pre>$ systemctl status grive.timer
grive.timer
	  Loaded: loaded (/etc/systemd/system/grive.timer; enabled)
	  Active: active (waiting) since (null); 3s ago</pre></div><br/>Мы получили таймер, который активируется через 15 минут после загрузки и каждые последующие 15 минут выполняет одноимённый юнит. На каждую задачу - по таймеру и юниту, объдинить их в один таймер мне не удалось.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-119165"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/Dganic/">
                <span class="post-username">Dganic</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/119165/">#</a>
            8 лет, 12 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/20/94/209416cc929c93f654b38d2836e80c5a.png" alt="Dganic avatar" />
    
</div>

            <div>
                Темы:
                <a href="/forum/users/Dganic/topics/">
                    26
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/Dganic/posts/">
                    189
                </a>
            </div>
            <div>
                Участник с: 23 октября 2009
            </div>
            
        </td>
        <td class="post-content">
            <strong>rec </strong> Не знаешь как ему сказать активироваться какждый месяц, скажет определенного числа, ну там например 20-го ?
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-119842"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/tchgefest/">
                <span class="post-username">tchgefest</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/119842/">#</a>
            8 лет, 11 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/tchgefest/topics/">
                    51
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/tchgefest/posts/">
                    1505
                </a>
            </div>
            <div>
                Участник с: 20 октября 2008
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>Dganic</em><br/><strong>rec </strong> Не знаешь как ему сказать активироваться каждый месяц, скажет определенного числа, ну там например 20-го ?</blockquote>Я не разбирался,но посмотри<br/><a href="https://blog.higgsboson.tk/2013/06/09/use-systemd-as-a-cron-replacement/">http://blog.higgsboson.tk/2013/06/09/use-systemd-as-a-cron-replacement/</a><br/>и<br/><a href="https://wiki.archlinux.org/index.php/Systemd/cron_functionality">https://wiki.archlinux.org/index.php/Systemd/cron_functionality</a>
            
                
                    <div class="post-signature">
                        Последний крик моды - эхо 30-летней давности.
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-119844"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/nafanja/">
                <span class="post-username">nafanja</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/119844/">#</a>
            8 лет, 11 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/8b/bf/8bbfdb897f0c37710a7d8b4dc072bea1.png" alt="nafanja avatar" />
    
</div>

            <div>
                Темы:
                <a href="/forum/users/nafanja/topics/">
                    94
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/nafanja/posts/">
                    9252
                </a>
            </div>
            <div>
                Участник с: 02 июня 2012
            </div>
            
                <div class="label label-warning">заблокирован</div>
            
        </td>
        <td class="post-content">
            Dganic<br/><strong>man systemd.time</strong><br/><strong>man systemd.timer</strong><br/><br/>вроде так<br/><div class="code"><pre>OnCalendar=*-*-20 00:00:00</pre></div><a href="https://wiki.archlinux.org/index.php/Systemd/cron_functionality#Starting_events_according_to_the_calendar">https://wiki.archlinux.org/index.php/Systemd/cron_functionality#Starting_events_according_to_the_calendar</a>
            
                
                    <div class="post-signature">
                        <a href="https://archlinux.org.ru/forum/topic/10992/">Псевдографический инсталлятор Arch Linux ver. 3.8.2</a><br />Благодарности принимаются на ЯД <strong>410012815723874</strong>
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-132970"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/32reg/">
                <span class="post-username">32reg</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/132970/">#</a>
            8 лет, 5 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/32reg/topics/">
                    29
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/32reg/posts/">
                    526
                </a>
            </div>
            <div>
                Участник с: 17 мая 2011
            </div>
            
        </td>
        <td class="post-content">
            Подскажите, с помощью таймеров можно выполнить нужный сервис например по понедельникам в час дня или при следующей загрузке компьютера если в это время компьютер был выключен?
            
                
                    <div class="post-signature">
                        <a href="http://linux32.ru">www.linux32.ru</a> - новости и статьи о Linux
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-159114"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/renegut/">
                <span class="post-username">renegut</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/159114/">#</a>
            6 лет, 10 месяцев назад
            
                (отредактировано
                
                    6 лет, 10 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/renegut/topics/">
                    0
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/renegut/posts/">
                    1
                </a>
            </div>
            <div>
                Участник с: 04 ноября 2015
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>32reg</em><br>Подскажите, с помощью таймеров можно выполнить нужный сервис например по понедельникам в час дня или при следующей загрузке компьютера если в это время компьютер был выключен?</blockquote><br />Запускать задание после старта компьютера позволяет дирректива &quot;OnBootSec=&quot;, а чтобы задание выполнялось по понедельникам в час дня нужно, например, в диррективе &quot;OnCalendar=&quot; прописать &quot;Mon  13:00&quot;. А вообще вот статья на русском языке, описывающая разные варианты конфигурации <a href="https://www.hippolab.ru/systemdtimer-zapusk-zadach-po-raspisaniyu">Systemd.timer. Запуск задач по расписанию</a>
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
        </div>
        <div>&nbsp;</div>
        
            <div class="text-center">
    



</div>

        

        

        
            
<a href="/accounts/register/">Зарегистрироваться</a> или <a href="/accounts/login/?next=/forum/topic/282/">войдите</a> чтобы оставить сообщение.

        

        
    </div>

        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

<script>(function(){var js = "window['__CF$cv$params']={r:'747b383f1848497d',m:'nva6YjVGei67SEnQPcYsCBHAwgJ_yKSjuPrWwt9wTW0-1662677185-0-AectzSnXyJiTrDQdThjyWbQikSftffe9jggpE4tcFsmzhBPFK0/qvzvXtS5+szrAbO2OWRsH6s8Tr+a7zrI0vkYDAm+DoS1IAgc7cDXeZSptiNQT4bTvsEpowXhVFLzNvGLfwvk7ooS+kCtk+P7S48k=',s:[0x8ffa64557c,0x3bbfba1af4],u:'/cdn-cgi/challenge-platform/h/g'};var now=Date.now()/1000,offset=14400,ts=''+(Math.floor(now)-Math.floor(now%offset)),_cpo=document.createElement('script');_cpo.nonce='',_cpo.src='/cdn-cgi/challenge-platform/h/g/scripts/alpha/invisible.js?ts='+ts,document.getElementsByTagName('head')[0].appendChild(_cpo);";var _0xh = document.createElement('iframe');_0xh.height = 1;_0xh.width = 1;_0xh.style.position = 'absolute';_0xh.style.top = 0;_0xh.style.left = 0;_0xh.style.border = 'none';_0xh.style.visibility = 'hidden';document.body.appendChild(_0xh);function handler() {var _0xi = _0xh.contentDocument || _0xh.contentWindow.document;if (_0xi) {var _0xj = _0xi.createElement('script');_0xj.nonce = '';_0xj.innerHTML = js;_0xi.getElementsByTagName('head')[0].appendChild(_0xj);}}if (document.readyState !== 'loading') {handler();} else if (window.addEventListener) {document.addEventListener('DOMContentLoaded', handler);} else {var prev = document.onreadystatechange || function () {};document.onreadystatechange = function (e) {prev(e);if (document.readyState !== 'loading') {document.onreadystatechange = prev;handler();}};}})();</script></body>
</html>
