


<!DOCTYPE html>
<html lang="ru">

<!-- Mirrored from archlinux.org.ru/forum/topic/3852/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 04:35:10 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Настройка сети gtk интерфейс
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://storage.yandexcloud.net/aor-static/static/css/default.css">
    
    
    

    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="../../feeds/posts/index.html" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="../../feeds/topics/index.html" title="Последние темы на форуме" >

    
    
    
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/jquery.formset.min.js"></script>

</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="../../../index.html">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="../../../news/index.html">Новости</a></li>
    <li class="active"><a href="../../index.html">Форум</a></li>
    <li class=""><a href="../../../blogs/index.html">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_(Русский)">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="../../../irc/index.html#chat">IRC</a></li>
      <li class="dropdown">
        <a href="../../../accounts/login/index.html" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="../../../accounts/login/index.html">Вход</a></li>
          <li><a href="../../../accounts/register/index.html">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="../../../messages/inbox/index.html" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="../../../index.html">ArchLinux.org.ru</a></li>


    <li><a href="../../index.html">Начало</a> <span class="divider">/</span></li>
    
        
            
                <li><a href="../../category/6/index.html">Разработка</a> <span class="divider">/</span></li>
            
                <li><a href="../../forum/21/index.html">Разработки арчеводов</a> <span class="divider">/</span></li>
            
        
        
            <li>Настройка сети gtk интерфейс</li>
        
    
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    
    <div class="topic">
        <h1>Настройка сети gtk интерфейс</h1>
        
            <div class="text-center">
    



</div>

        

        

        <div class="posts">
            
            
                
                




<table class="table table-bordered post post-row
       "
       id="post-38976"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/aivs/index.html">
                <span class="post-username">aivs</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/38976/index.html">#</a>
            11 лет назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/aivs/topics/index.html">
                    62
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/aivs/posts/index.html">
                    261
                </a>
            </div>
            <div>
                Участник с: 31 октября 2006
            </div>
            
        </td>
        <td class="post-content">
            Появилась задача настраивать сеть через гуёвое приложение, ни gtk ни qt не знаю, нагуглил gtkdialog, на нем и написал.<br/><br/><strong>Требуется пакет gtkdialog !!</strong><br/><img src="http://dl.dropbox.com/u/25895838/archnetcfg.jpg"></img><br/><br/>Как работает программа:<br/>Если вы перешли на новый вид оформления настроек сети в /etc/rc.conf, то программа вам подойдет.<br/>Программа парсит rc.conf на наличие строк<br/><br/><ul><li>address=<br/>netmask=<br/>gateway=<br/><br/>Комментарии обходит, найдя строки, показывает их значения.<br/>Параметры записываются в rc.conf (используется sudo, в консоли спросит пароль).<br/>Если нажали &ldquo;Автоматически&rdquo;, то после нажатия Сохранить, в rc.conf параметры сотрутся (это требуется для dhcp настройки).<br/><br/>При заполнении полей DNS, программа перезаписывает /etc/resolv.conf, если вы очистили все поля, и у вас выбран режим статической настройки, то resolv.conf не изменится (защита от случаяного стирания). Когда вы выбираете Автоматическую (DHCP) настройку, файл resolv.conf вообще не трогается, т.к. после перезапуска сети, он все равно перезапишется.<br/><br/><strong>После нажатия на кнопку &ldquo;Сохранить&rdquo; все параметры записываются в rc.conf и resolv.conf и перезапускается сеть (/etc/rc.d/network restart)!!!</strong><br/><br/>Вот сам скрипт:<br/><br/><div class="code"><pre>#!/bin/bash
#archnetcfg by aivs from archlinux.org.ru
export MAIN_DIALOG='
&lt;window title="Сетевые настройки" resizable="false"&gt;
&lt;vbox&gt;
 &lt;radiobutton active="false"&gt;
  &lt;label&gt;Автоматическая настройка&lt;/label&gt;
  &lt;variable&gt;RADIOBUTTON2&lt;/variable&gt;
  &lt;action&gt;Disable:IP&lt;/action&gt;
  &lt;action&gt;Disable:NETMASK&lt;/action&gt;
  &lt;action&gt;Disable:GATEWAY&lt;/action&gt;
  &lt;action&gt;Disable:DNS1&lt;/action&gt;
  &lt;action&gt;Disable:DNS2&lt;/action&gt;
  &lt;action&gt;Disable:DNS3&lt;/action&gt;
 &lt;/radiobutton&gt;
 
 &lt;radiobutton active="true"&gt;
  &lt;label&gt;Ручная настройка&lt;/label&gt;
  &lt;variable&gt;RADIOBUTTON1&lt;/variable&gt;
  &lt;action&gt;Enable:IP&lt;/action&gt;
  &lt;action&gt;Enable:NETMASK&lt;/action&gt;
  &lt;action&gt;Enable:GATEWAY&lt;/action&gt;
  &lt;action&gt;Enable:DNS1&lt;/action&gt; 
  &lt;action&gt;Enable:DNS2&lt;/action&gt;
  &lt;action&gt;Enable:DNS3&lt;/action&gt;
 &lt;/radiobutton&gt;
 
 
 &lt;hbox&gt;
 &lt;text&gt;
  &lt;label&gt;IP адрес&lt;/label&gt;
 &lt;/text&gt;
 &lt;entry&gt;
  &lt;input&gt;sed -n "/^[^#]*address=/ ! d; s/.*=//p" /etc/rc.conf&lt;/input&gt;
  &lt;variable&gt;IP&lt;/variable&gt;
 &lt;/entry&gt;
 &lt;/hbox&gt;
 
 &lt;hbox&gt;
 &lt;text&gt;
  &lt;label&gt;Маска сети&lt;/label&gt;
 &lt;/text&gt;
 &lt;entry&gt;
  &lt;input&gt;sed -n "/^[^#]*netmask=/ ! d; s/.*=//p" /etc/rc.conf&lt;/input&gt;
  &lt;variable&gt;NETMASK&lt;/variable&gt;
 &lt;/entry&gt;
 &lt;/hbox&gt;
 
 &lt;hbox&gt;
 &lt;text&gt;
  &lt;label&gt;Шлюз&lt;/label&gt;
 &lt;/text&gt;
 &lt;entry&gt;
  &lt;input&gt;sed -n "/^[^#]*gateway=/ ! d; s/.*=//p" /etc/rc.conf&lt;/input&gt;
  &lt;variable&gt;GATEWAY&lt;/variable&gt;
 &lt;/entry&gt;
 &lt;/hbox&gt;
 
 &lt;hbox&gt;
 &lt;text&gt;
  &lt;label&gt;DNS1&lt;/label&gt;
 &lt;/text&gt;
 &lt;entry&gt;
  &lt;input&gt;sed -e '/^#/d' /etc/resolv.conf | sed -n '1p'| sed -e "s/nameserver //g"&lt;/input&gt;
  &lt;variable&gt;DNS1&lt;/variable&gt;
 &lt;/entry&gt;
 &lt;/hbox&gt;
 
 &lt;hbox&gt;
 &lt;text&gt;
  &lt;label&gt;DNS2&lt;/label&gt;
 &lt;/text&gt;
 &lt;entry&gt;
  &lt;input&gt;sed -e '/^#/d' /etc/resolv.conf | sed -n '2p'| sed -e "s/nameserver //g"&lt;/input&gt;
  &lt;variable&gt;DNS2&lt;/variable&gt;
 &lt;/entry&gt;
 &lt;/hbox&gt;
 &lt;hbox&gt;
 &lt;text&gt;
  &lt;label&gt;DNS3&lt;/label&gt;
 &lt;/text&gt;
 &lt;entry&gt;
  &lt;input&gt;sed -e '/^#/d' /etc/resolv.conf | sed -n '3p'| sed -e "s/nameserver //g"&lt;/input&gt;
  &lt;variable&gt;DNS3&lt;/variable&gt;
 &lt;/entry&gt;
 &lt;/hbox&gt;
 &lt;hbox&gt;
  &lt;button&gt;
  &lt;label&gt;Сохранить&lt;/label&gt;
  &lt;action&gt; [ "$RADIOBUTTON2" = "true" ] &amp;&amp;  sudo sed -i 's/^[^#]*address=.*/address=/' /etc/rc.conf&lt;/action&gt;
  &lt;action&gt; [ "$RADIOBUTTON2" = "true" ] &amp;&amp;  sudo sed -i 's/^[^#]*netmask=.*/netmask=/' /etc/rc.conf&lt;/action&gt;
  &lt;action&gt; [ "$RADIOBUTTON2" = "true" ] &amp;&amp;  sudo sed -i 's/^[^#]*gateway=.*/gateway=/' /etc/rc.conf&lt;/action&gt;
  &lt;action&gt; [ "$RADIOBUTTON2" = "true" ] &amp;&amp;  sudo /etc/rc.d/network restart &amp;&lt;/action&gt;
  &lt;action&gt; [ "$RADIOBUTTON1" = "true" ] &amp;&amp;  sudo sed -i "s/^[^#]*address=.*/address=$IP/" /etc/rc.conf&lt;/action&gt;
  &lt;action&gt; [ "$RADIOBUTTON1" = "true" ] &amp;&amp;  sudo sed -i "s/^[^#]*netmask=.*/netmask=$NETMASK/" /etc/rc.conf&lt;/action&gt;
  &lt;action&gt; [ "$RADIOBUTTON1" = "true" ] &amp;&amp;  sudo sed -i "s/^[^#]*gateway=.*/gateway=$GATEWAY/" /etc/rc.conf&lt;/action&gt;
  &lt;action&gt; [ -n "$DNS1" ] || [ -n "$DNS2" ] || [ -n "$DNS3" ] &amp;&amp; echo "#Generated by archnetcfg.sh" | sudo tee /etc/resolv.conf&lt;/action&gt;
  &lt;action&gt; [ "$RADIOBUTTON1" = "true" ] &amp;&amp;  [ -n "$DNS1" ] &amp;&amp; echo "nameserver $DNS1" | sudo tee -a /etc/resolv.conf &lt;/action&gt;
  &lt;action&gt; [ "$RADIOBUTTON1" = "true" ] &amp;&amp;  [ -z "$DNS1" ] &amp;&amp; : &lt;/action&gt;
  &lt;action&gt; [ "$RADIOBUTTON1" = "true" ] &amp;&amp;  [ -n "$DNS2" ] &amp;&amp; echo "nameserver $DNS2" | sudo tee -a /etc/resolv.conf &lt;/action&gt;
  &lt;action&gt; [ "$RADIOBUTTON1" = "true" ] &amp;&amp;  [ -z "$DNS2" ] &amp;&amp; : &lt;/action&gt;
  &lt;action&gt; [ "$RADIOBUTTON1" = "true" ] &amp;&amp;  [ -n "$DNS3" ] &amp;&amp; echo "nameserver $DNS3" | sudo tee -a /etc/resolv.conf &lt;/action&gt;
  &lt;action&gt; [ "$RADIOBUTTON1" = "true" ] &amp;&amp;  [ -z "$DNS3" ] &amp;&amp; : &lt;/action&gt;
  &lt;action&gt; [ "$RADIOBUTTON1" = "true" ] &amp;&amp;  sudo /etc/rc.d/network restart &amp;&lt;/action&gt;
  &lt;action type="exit"&gt;OK&lt;/action&gt;
  &lt;/button&gt;
  &lt;button cancel&gt;
  &lt;label&gt;Отменить&lt;/label&gt;
  &lt;/button&gt;
 &lt;/hbox&gt;
&lt;/vbox&gt;
&lt;/window&gt;
'
gtkdialog --program=MAIN_DIALOG</pre></div></li></ul>
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
        </div>
        <div>&nbsp;</div>
        
            <div class="text-center">
    



</div>

        

        

        
            
<a href="../../../accounts/register/index.html">Зарегистрироваться</a> или <a href="../../../accounts/login/index675d.html?next=/forum/topic/3852/">войдите</a> чтобы оставить сообщение.

        

        
    </div>

        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

</body>

<!-- Mirrored from archlinux.org.ru/forum/topic/3852/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 04:35:10 GMT -->
</html>
