


<!DOCTYPE html>
<html lang="ru">

<!-- Mirrored from archlinux.org.ru/forum/topic/18082/?page=1 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 04:18:10 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        bspwm - делимся полезными наработками
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://storage.yandexcloud.net/aor-static/static/css/default.css">
    
    
    

    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="../../feeds/posts/index.html" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="../../feeds/topics/index.html" title="Последние темы на форуме" >

    
    
    
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/jquery.formset.min.js"></script>

</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="../../../index.html">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="../../../news/index.html">Новости</a></li>
    <li class="active"><a href="../../index.html">Форум</a></li>
    <li class=""><a href="../../../blogs/index.html">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_(Русский)">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="../../../irc/index.html#chat">IRC</a></li>
      <li class="dropdown">
        <a href="../../../accounts/login/index.html" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="../../../accounts/login/index.html">Вход</a></li>
          <li><a href="../../../accounts/register/index.html">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="../../../messages/inbox/index.html" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="../../../index.html">ArchLinux.org.ru</a></li>


    <li><a href="../../index.html">Начало</a> <span class="divider">/</span></li>
    
        
            
                <li><a href="../../category/4/index.html">Рабочие Среды / Менеджеры Окон</a> <span class="divider">/</span></li>
            
                <li><a href="../../forum/18/index.html">Другие WM/DE</a> <span class="divider">/</span></li>
            
        
        
            <li>bspwm - делимся полезными наработками</li>
        
    
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    
    <div class="topic">
        <h1>bspwm - делимся полезными наработками</h1>
        
            <div class="text-center">
    


    <nav>
        <ul class="pagination">
            
                <li class="previous disabled">
                    <span>
                        <span aria-hidden="true">&laquo;</span>
                        <span class="hidden-xs">предыдущая страница</span>
                    </span>
                </li>
            

            
                
                    
                        <li class="active">
                            <a href="index2679.html?page=1">1 <span class="sr-only">(текущая страница)</span></a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index4658.html?page=2">2</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index9ba9.html?page=3">3</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexfdb0.html?page=4">4</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexaf4d.html?page=5">5</a>
                        </li>
                    
                
            

            
                <li class="next">
                    <a href="index4658.html?page=2" aria-label="следующая страница">
                        <span class="hidden-xs">следующая страница</span>
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            
        </ul>
    </nav>


</div>

        

        

        <div class="posts">
            
            
                
                




<table class="table table-bordered post post-row
       "
       id="post-198465"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/s-ugra%40ya.ru/index.html">
                <span class="post-username">s-ugra@ya.ru</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/198465/index.html">#</a>
            4 года, 8 месяцев назад
            
                (отредактировано
                
                    4 года, 8 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/93/a4/93a46d9eac5ebd0cca83f310f72f0f10.png" alt="s-ugra@ya.ru avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/s-ugra%40ya.ru/topics/index.html">
                    11
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/s-ugra%40ya.ru/posts/index.html">
                    763
                </a>
            </div>
            <div>
                Участник с: 15 ноября 2016
            </div>
            
        </td>
        <td class="post-content">
            Предлагаю размещать здесь у кого что есть интересного по bspwm<br /><br /><a href="index2679.html?page=1#post-198467">Скрипт погоды для polybar</a> и <a href="index2679.html?page=1#post-198471"> Погода с яндекса</a>, дополнение (спасибо <a href="../../users/patashnik/index.html">patashnik</a>), значительно упрощающее задачу<br /><a href="index9ba9.html?page=3#post-198557">&quot;Сворачивание&quot; окон на панель</a><br />Планируется:<br />Разные режимы создания новых окон а автоматическом режиме и их смена &quot;на лету&quot; (layouts)<br />Выпадающий терминал<br />Scratchpads - вызов во float режиме и скрытие любых окон на текущем workspase
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-198466"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/s-ugra%40ya.ru/index.html">
                <span class="post-username">s-ugra@ya.ru</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/198466/index.html">#</a>
            4 года, 8 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/93/a4/93a46d9eac5ebd0cca83f310f72f0f10.png" alt="s-ugra@ya.ru avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/s-ugra%40ya.ru/topics/index.html">
                    11
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/s-ugra%40ya.ru/posts/index.html">
                    763
                </a>
            </div>
            <div>
                Участник с: 15 ноября 2016
            </div>
            
        </td>
        <td class="post-content">
            Зарезервировано...
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-198467"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/s-ugra%40ya.ru/index.html">
                <span class="post-username">s-ugra@ya.ru</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/198467/index.html">#</a>
            4 года, 8 месяцев назад
            
                (отредактировано
                
                    4 года, 8 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/93/a4/93a46d9eac5ebd0cca83f310f72f0f10.png" alt="s-ugra@ya.ru avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/s-ugra%40ya.ru/topics/index.html">
                    11
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/s-ugra%40ya.ru/posts/index.html">
                    763
                </a>
            </div>
            <div>
                Участник с: 15 ноября 2016
            </div>
            
        </td>
        <td class="post-content">
            <strong>Скрипт погоды для polybar</strong><br /><br />Давно хотел сделать погоду на панели WM такую как хочется. А именно - чтобы без сторонних приложений, без погодных сервисов, исходя из того что сайт погоды есть в свободном доступе, брать с него данные и выводить на панель. Вот и сделал. Данный вариант работает с панелью polybar, но его при желании можно легко приспособить и для xmobar, и для dzen, и для других подобных панелей. По клику на панели погода переключается в краткий формат (только иконка и температура) и развернутый формат (краткий + влажность + направление и скорость ветра + давление + тенденция давления: растет/падает)<br /><br /><a href="https://itmages.ru/image/view/6343643/14d5a2dd"><img src="http://storage2.static.itmages.ru/i/17/1219/s_1513667678_9407314_14d5a2ddf7.png"></a><br /><br />Конструкция состоит из 4 файлов с данными - это промежуточный и конечный с данными веб-страницы, pipe канал, конф-файл состояния кратко/подробно,<br />~/.config/.curweath-tmp<br />~/.config/.curweath-web<br />/tmp/.weather-pipe<br />~/.config/.pb-weather-mode<br /><br />3 небольших скриптов:<br />Скрипт 1 ~/.bin/pb-get-weather<br />Запускается каждые 10 мин., если есть пинг<br />Качает страницу, запускает Скрипт 2<br />Скрипт 2 ~/.bin/pb-superweather<br />парсит страницу и загоняет данные в pipe, читая конф-файл<br />Скрипт 3 (по клику) ~/.bin/toggle-pb-weather<br />Переключает параметр конф-файла и запускает Скрипт 2<br /><br />и двух модулей панели polybar:<br />Модуль 1<br />Ничего не выводит, а только запускает Скрипт 1 с заданным интервалом<br />Модуль 2<br />Читает pipe и выводит на панель, по клику запускает Скрипт 3<br /><br />Данные о погоде берутся с сайта accuweather.com<br />Используется шрифт <a href="https://erikflowers.github.io/weather-icons/">Weather Icons</a><br /><br />Итак, по порядку:<br />1. <strong>Именованный канал</strong>.<br />Создаем канал где-нибудь в автозагрузке (например, в .xinitrc)<br /><pre><code>mkfifo /tmp/.weather-pipe &amp;</code></pre><br />2. <strong>Скрипт 1</strong> ~/.bin/pb-get-weather<br /><pre><code>#!/usr/bin/bash
# Search for your city at <a href="http://www.accuweather.com/">http://www.accuweather.com</a> and replace the URL in the following script with the URL for your city

~/.bin/pb-superweather $(cat ~/.config/.pb-weather-mode) &amp;&amp; wget -q -O ~/.config/.curweath-tmp &quot;<a href="http://www.accuweather.com/ru/ru/surgut/288459/current-weather/288459">http://www.accuweather.com/ru/ru/surgut/288459/current-weather/288459</a>&quot; &amp;&amp; cp ~/.config/.curweath-tmp ~/.config/.curweath-web &amp;&amp; ~/.bin/pb-superweather $(cat ~/.config/.pb-weather-mode)</code></pre><br />Почему мы здесь сначала запускаем Скрипт 2, затем качаем страницу и потом повторно запускаем Скрипт 2? Потому что Скрипт 1 запускается при старте/перезагрузке панели (системы) и нужно сразу вывести данные на панель, пусть даже устаревшие, но они отобразятся сразу, а потом пусть неспешно (ведь инет не всегда быстрый) обновятся. А почему 2 файла ~/.config/.curweath-tmp и ~/.config/.curweath-web? Так инет жеж не всегда быстрый, и если wget будет работать несколько секунд, а в это время сработает Скрипт 2, то в pipe полетит ошибка, копирование же произойдет мгновенно и ошибка вылезти не успеет.<br /><br />Адрес &quot;<a href="http://www.accuweather.com/ru/ru/surgut/288459/current-weather/288459">http://www.accuweather.com/ru/ru/surgut/288459/current-weather/288459</a>&quot; - это Сургут, пройдите по ссылке, выберите свое место и скопируйте адресную строку браузера в скрипт.<br /><br />Если вы используете не polybar, то можете в автозагрузку поставить примерно такой скрипт:<br /><pre><code>#!/usr/bin/bash
# Search for your city at <a href="http://www.accuweather.com/">http://www.accuweather.com</a> and replace the URL in the following script with the URL for your city
SLEEP_INTERVAL=60

while :
do
if `ping -c 1 -w 5 8.8.8.8 &amp;&gt; /dev/null`
then
    SLEEP_INTERVAL=600
     ~/.bin/pb-superweather $(cat ~/.config/.pb-weather-mode) &amp;&amp; wget -q -O ~/.config/.curweath-tmp
&quot;<a href="http://www.accuweather.com/ru/ru/surgut/288459/current-weather/288459">http://www.accuweather.com/ru/ru/surgut/288459/current-weather/288459</a>&quot; &amp;&amp; cp ~/.config/.curweath-tmp ~/.config/.curweath-web &amp;&amp; ~/.bin/pb-superweather $(cat ~/.config/.pb-weather-mode)
fi
    sleep $SLEEP_INTERVAL
done</code></pre><br /><strong>Скрипт 2</strong> ~/.bin/pb-superweather<br /><pre><code>#!/usr/bin/bash

if ! [ -f &quot;$HOME/.config/.pb-weather-mode&quot; ]; then
	touch $HOME/.config/.pb-weather-mode
fi

if ! [ -f &quot;$HOME/.config/.curweath-web&quot; ]; then
	echo &quot;%{F#2587CB}%{T5}%{T-}%{F-}&quot;
	exit 0
fi

# температура
WTEMP=&quot;$(cat ~/.config/.curweath-web | awk -F\&#39; &#39;/acm_RecentLocationsCarousel\.push/{print $10&quot;°C&quot;}&#39;| head -1)&quot;

# погода
WCONDI=&quot;$(cat ~/.config/.curweath-web | awk -F\&#39; &#39;/acm_RecentLocationsCarousel\.push/{print $13}&#39; | head -1 | cut -c 10- | rev | cut -c 5- | rev | sed &#39;s/.*/\L&amp;/&#39;)&quot;

# направление ветра
# скорость ветра м/с
WSP=&quot;$(echo &quot;$(grep км/ч ~/.config/.curweath-web | cut -c 26- | rev | cut -c 24- | rev) * 1000 / 3600&quot; | bc)&quot;
if grep -q Безветренно  ~/.config/.curweath-web
then
  WSPEED=&quot;&quot;;
  WWINGH=&quot;С&quot;
else
  WSPEED=&quot;$(echo &quot; $WSP m/s&quot;)&quot;;
  WWINGH=&quot;$(grep wind-point ~/.config/.curweath-web | cut -c 28- | rev | cut -c 10- | rev)&quot;
fi

# давление мм/рт.ст
WPRESS=&quot;$(echo &quot;$(grep Давление ~/.config/.curweath-web | cut -c 59- | cut -c 1-7) * 750064 / 1000000&quot; | bc)&quot;

# давление растет/парадает
if grep -q uarr  ~/.config/.curweath-web
then
   WPREST=&quot; &quot;;
elif grep -q darr  ~/.config/.curweath-web
then
   WPREST=&quot; &quot;;
else
   WPREST=&quot;&quot;;
fi

#влажность %
WETNES=&quot;$(grep Влажность ~/.config/.curweath-web | cut -c 61- | rev | cut -c 17- | rev)&quot;

# N — обозначает северный ветер, Е — востчный, S — южный, W — западный, С — затишье (нет ветра).
# NE — северо-восток, SE — юго-восток, SW — юго-запад, NW — северо-запад.
# NNE — обозначает северо-северо-восток, ENE — востоко-северо-восток, ESE — востоко-юго-восток и т. д.
WI=(&quot;N&quot; &quot;E&quot; &quot;S&quot; &quot;W&quot; &quot;С&quot; &quot;NE&quot; &quot;SE&quot; &quot;SW&quot; &quot;NW&quot; &quot;NNE&quot; &quot;ENE&quot; &quot;ESE&quot; &quot;SSE&quot; &quot;SSW&quot; &quot;WSW&quot; &quot;WNW&quot; &quot;NNW&quot; &quot;*&quot;)
WO=(&quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot;)
for i in $(seq 0 ${#WI[@]}); do
    if [[ &quot;$WWINGH&quot; == &quot;${WI[$i]}&quot; ]]; then
      WINGICON=&quot;${WO[$i]}&quot;
    fi
done
TIMESDAY=&quot;ITSNIGHT&quot;
    HOUR=$(date +&quot;%-H&quot;)
    MONTH=$(date +&quot;%-m&quot;)

# time is relevant for 60 parallels, for other places it is necessary to set an appropriate time of sunrise and sunset for each month of the year
    if [[ 6 = &quot;$MONTH&quot; || 7 = &quot;$MONTH&quot; ]]; then
      if (( $HOUR &gt;= 3 &amp;&amp; $HOUR &lt;= 23 )); then
        TIMESDAY=&quot;ITSDAY&quot;
      fi
    elif [[ 5 = &quot;$MONTH&quot; || 8 = &quot;$MONTH&quot; ]]; then
      if (( $HOUR &gt;= 4 &amp;&amp; $HOUR &lt;= 22 )); then
        TIMESDAY=&quot;ITSDAY&quot;
      fi
    elif [[ 4 = &quot;$MONTH&quot; || 9 = &quot;$MONTH&quot; ]]; then
      if (( $HOUR &gt;= 5 &amp;&amp; $HOUR &lt;= 20 )); then
        TIMESDAY=&quot;ITSDAY&quot;
      fi
    elif [[ 3 = &quot;$MONTH&quot; || 10 = &quot;$MONTH&quot; ]]; then
      if (( $HOUR &gt;= 6 &amp;&amp; $HOUR &lt;= 18 )); then
        TIMESDAY=&quot;ITSDAY&quot;
      fi
    elif [[ 2 = &quot;$MONTH&quot; || 11 = &quot;$MONTH&quot; ]]; then
      if (( $HOUR &gt;= 7 &amp;&amp; $HOUR &lt;= 16 )); then
        TIMESDAY=&quot;ITSDAY&quot;
      fi
    else [[ 1 = &quot;$MONTH&quot; || 12 = &quot;$MONTH&quot; ]]
      if (( $HOUR &gt;= 8 &amp;&amp; $HOUR &lt;= 15 )); then
        TIMESDAY=&quot;ITSDAY&quot;
      fi
    fi

II=(&quot;преимущественно ясно&quot; &quot;ясно&quot; &quot;солнечно&quot; &quot;слабый туман&quot; &quot;слабый снег и туман&quot; &quot;слабый снегопад&quot; &quot;небольшой снег&quot; &quot;сильный снегопад&quot; &quot;снегопад&quot; &quot;снег с дождем&quot; &quot;снег&quot; &quot;значительная облачность&quot; &quot;облачно с прояснениями&quot; &quot;небольшая облачность&quot; &quot;преимущественно облачно&quot; &quot;малооблачно&quot; &quot;облачно&quot; &quot;метель&quot; &quot;дождь&quot; &quot;ливень с грозой&quot; &quot;ливень&quot; &quot;гроза&quot; &quot;небольшой туман&quot; &quot;*&quot;)

S2=&quot;ITSDAY&quot;
if [ $TIMESDAY = $S2 ]; then
IO=(&quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot;)
else
IO=(&quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot;)
fi

for i in $(seq 0 ${#II[@]}); do
    if [[ &quot;$WCONDI&quot; == &quot;${II[$i]}&quot; ]]; then
      WICON=&quot;${IO[$i]}&quot;
    fi
done

FULLMODE=&quot;full&quot;
APPLICATION=$1

if [[ &quot;$APPLICATION&quot; == &quot;$FULLMODE&quot; ]]; then
   echo &quot;%{T5}$WICON%{T-} $WTEMP %{F#55}%{T5}%{T-}%{F-} $WETNES %{F#9F78E1}%{T5}$WINGICON%{T-}%{F-}$WSPEED %{F#55}%{T5}%{T-}%{F-} $WPRESS%{T5}$WPREST%{T-}&quot; &gt; /tmp/.weather-pipe
else
  echo &quot;%{T5}$WICON%{T-} $WTEMP&quot; &gt; /tmp/.weather-pipe
fi

exit 0</code></pre><br />Как вы поняли, погодные иконки рисуются разные для дня и ночи и в блоке где определяется день сейчас или ночь<br /><pre><code>if [[ 6 = &quot;$MONTH&quot; || 7 = &quot;$MONTH&quot; ]]; then
      if (( $HOUR &gt;= 3 &amp;&amp; $HOUR &lt;= 23 )); then
        TIMESDAY=&quot;ITSDAY&quot;</code></pre>у меня указано, что в месяцах 6 и 7 днем считать время от 3 до 23 часов и т.д., вы, конечно же, должны проставить свои параметры.<br /><br /><strong>Скрипт 3</strong> ~/.bin/toggle-pb-weather<br /><pre><code>#!/usr/bin/bash

WMODE=&quot;$(cat ~/.config/.pb-weather-mode)&quot;
FLMODE=&quot;full&quot;

if [[ &quot;$WMODE&quot; == &quot;$FLMODE&quot; ]]; then
  echo &quot;&quot; &gt; ~/.config/.pb-weather-mode
else
  echo &quot;full&quot; &gt; ~/.config/.pb-weather-mode
fi

~/.bin/pb-superweather $(cat ~/.config/.pb-weather-mode)
exit 0</code></pre><br /><strong>Модули панели</strong><br /><pre><code>.....
modules-right = ... get-weather weather...
.....
;=====================================================
; Module get-weather
;=====================================================
[module/get-weather]
type = custom/script
format = &lt;label&gt;
label =
exec = ~/.bin/pb-get-weather
exec-if = ping -c 1 -w 5 8.8.8.8 &amp;&gt; /dev/null
interval = 600

;=====================================================
; Module weather
;=====================================================
[module/weather]
type = custom/script
exec = tail -F /tmp/.weather-pipe
exec-if = [ -p /tmp/.weather-pipe ]
tail = true
format = &lt;label&gt;
label = %output%
click-left = ~/.bin/toggle-pb-weather
click-right =
label-padding    = 2
label-background = #55

.....
</code></pre>Еще один момент: у меня в polybar шрифты заданы в следующем порядке:<br /><pre><code>.....
font-0 = Play:pixelsize=11:antialias=false;3
font-1 = unifont:fontformat=truetype:size=8:antialias=false;0
font-2 = Symbola:pixelsize=12;3
font-3 = FontAwesome:pixelsize=10:antialias=false;3
font-4 = Weather Icons:pixelsize=12:antialias=false;4
font-5 = fixed:pixelsize=10;3
font-6 = siji:pixelsize=10;1
font-7 = Symbola:pixelsize=13;3
.....</code></pre><br />Стало быть шрифт Weather Icons у меня пятый, и он выводится в ~/.bin/pb-superweather следующим образом<br />echo &quot;%{T5}$WICON%{T-}....<br />Если у вас другой порядок шрифтов, замените 5 на свое значение.<br /><br />Ну вот кажется и все, буду рад дельным советам :)<br />--<br />p.s. Если пропадет иконка состояния погоды, значит на сайте появилась новая фраза. Зайдите на сайт, посмотрите что там, например, не &quot;Солнечно&quot;, а &quot;Грибной дождик&quot;, и допишите в массивы скрипта ~/.bin/pb-superweather новую фразу и соответствующую ей иконку.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-198469"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/SirKittyKnight/index.html">
                <span class="post-username">SirKittyKnight</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/198469/index.html">#</a>
            4 года, 8 месяцев назад
            
                (отредактировано
                
                    4 года, 8 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/SirKittyKnight/topics/index.html">
                    5
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/SirKittyKnight/posts/index.html">
                    51
                </a>
            </div>
            <div>
                Участник с: 17 декабря 2017
            </div>
            
        </td>
        <td class="post-content">
            Тема &quot;bspwm - делимся полезными наработками&quot;, а написано про polybar. И зачем так мучаться с погодой, если можно: а) закурлить со спец.ресурсов, б) запарсить по человечески, в) использовать пакеты из аура, которые погоду в терминал кидают, г) на каком-нибудь яп с поддержкой модулей/сторонних библиотек по ключу выводить погоду.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-198470"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/s-ugra%40ya.ru/index.html">
                <span class="post-username">s-ugra@ya.ru</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/198470/index.html">#</a>
            4 года, 8 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/93/a4/93a46d9eac5ebd0cca83f310f72f0f10.png" alt="s-ugra@ya.ru avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/s-ugra%40ya.ru/topics/index.html">
                    11
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/s-ugra%40ya.ru/posts/index.html">
                    763
                </a>
            </div>
            <div>
                Участник с: 15 ноября 2016
            </div>
            
        </td>
        <td class="post-content">
            <strong>SirKittyKnight</strong>, я же написал чего хотел: &quot;чтобы без сторонних приложений, без погодных сервисов&quot;, если бы я хотел с ключами/пакетами/в терминал, то сделал бы по-другому.<br /><blockquote><em>SirKittyKnight</em><br>запарсить по человечески,</blockquote>Если есть предложение по оптимизации кода - буду рад...
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-198471"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/patashnik/index.html">
                <span class="post-username">patashnik</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/198471/index.html">#</a>
            4 года, 8 месяцев назад
            
                (отредактировано
                
                    4 года, 8 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/patashnik/topics/index.html">
                    4
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/patashnik/posts/index.html">
                    198
                </a>
            </div>
            <div>
                Участник с: 29 августа 2009
            </div>
            
        </td>
        <td class="post-content">
            Погода с яндекса<br /><br /><pre><code>#!/bin/bash
# установить xmlstarlet

region=1 # <a href="https://tech.yandex.ru/xml/doc/dg/reference/regions-docpage/">https://tech.yandex.ru/xml/doc/dg/reference/regions-docpage/</a>
curl -s &quot;<a href="https://export.yandex.ru/bar/reginfo.xml?region=$region">https://export.yandex.ru/bar/reginfo.xml?region=$region</a>&quot; -o /tmp/weather.xml

xml_sel() {
  xmlstarlet sel -t -m &quot;info/weather/day/day_part[1]&quot; -v &quot;$1&quot; /tmp/weather.xml
}

cond=&quot;$(xml_sel weather_type)&quot;   # погода
wind=&quot;$(xml_sel wind_speed)&quot;     # ветер м/с
dire=&quot;$(xml_sel wind_direction)&quot; # направление
damp=&quot;$(xml_sel dampness)&quot;       # влажность %
pres=&quot;$(xml_sel pressure)&quot;       # давление рт. ст.
temp=&quot;$(xml_sel temperature)&quot;    # температура С°
icon=&quot;$(xml_sel image)&quot;          # иконка

# пример
echo -e &quot;Погода:\\t\\t$cond
Ветер:\\t\\t$wind м/с ($dire)
Влажность:\\t$damp %
Давление:\\t$pres рт. ст.
Температура:\\t$temp С°
Картинка:\\t$icon&quot;</code></pre><br /><pre><code>$ yandex_weather
Погода:         облачно
Ветер:          2.8 м/с (восток)
Влажность:      94 %
Давление:       748 рт. ст.
Температура:    +10 С°
Картинка:       <a href="https://yastatic.net/weather/i/icons/blueye/24/ovc.png">https://yastatic.net/weather/i/icons/blueye/24/ovc.png</a></code></pre>
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-198472"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/s-ugra%40ya.ru/index.html">
                <span class="post-username">s-ugra@ya.ru</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/198472/index.html">#</a>
            4 года, 8 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/93/a4/93a46d9eac5ebd0cca83f310f72f0f10.png" alt="s-ugra@ya.ru avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/s-ugra%40ya.ru/topics/index.html">
                    11
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/s-ugra%40ya.ru/posts/index.html">
                    763
                </a>
            </div>
            <div>
                Участник с: 15 ноября 2016
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>patashnik</em><br>Погода с яндекса</blockquote>Спасибо огромное! Давно искал нечто подобное. Добавлю в шапку и потестирую.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-198476"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/gentux/index.html">
                <span class="post-username">gentux</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/198476/index.html">#</a>
            4 года, 8 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/54/58/5458597645a072ee3603e4269bdd3692.png" alt="gentux avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/gentux/topics/index.html">
                    3
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/gentux/posts/index.html">
                    115
                </a>
            </div>
            <div>
                Участник с: 15 января 2015
            </div>
            
        </td>
        <td class="post-content">
            Благодарю.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-198477"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/SirKittyKnight/index.html">
                <span class="post-username">SirKittyKnight</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/198477/index.html">#</a>
            4 года, 8 месяцев назад
            
                (отредактировано
                
                    4 года, 8 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../../users/SirKittyKnight/topics/index.html">
                    5
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/SirKittyKnight/posts/index.html">
                    51
                </a>
            </div>
            <div>
                Участник с: 17 декабря 2017
            </div>
            
        </td>
        <td class="post-content">
            <strong>s-ugra@ya.ru,</strong><br />по-поводу сторонних сервисов, вы же в своем же скрипте используете сторонний сервис. Если у вас нет собственных датчиков, то зачем придумывать велосипед, если есть готовый. Как написали выше, через яндекс. Можно через<br /><pre><code>curl <a href="http://wttr.in/Moscow">wttr.in/Moscow</a></code></pre>Можно через яп, например, у меня через питон:<br /><pre><code>#!/usr/bin/env python3

import pyowm

owm = pyowm.OWM(&#39;*******&#39;)
place = owm.weather_at_place(&#39;Moscow,ru&#39;)
weather = place.get_weather()
temp = str(round(int(weather.get_temperature(&#39;celsius&#39;)[&#39;temp&#39;]), 0)) + &#39;°C&#39;
#wind = str(weather.get_wind()[&#39;speed&#39;]) + &#39;m/s&#39;
status = str(weather).split(&#39;,&#39;)[-1].replace(&#39;status=&#39;, &#39;&#39;).replace(&#39;&gt;&#39;, &#39;&#39;)
print(status, temp)

</code></pre><pre><code>Drizzle 0°C</code></pre>
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-198479"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../../users/s-ugra%40ya.ru/index.html">
                <span class="post-username">s-ugra@ya.ru</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../post/198479/index.html">#</a>
            4 года, 8 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/93/a4/93a46d9eac5ebd0cca83f310f72f0f10.png" alt="s-ugra@ya.ru avatar" />
    
</div>

            <div>
                Темы:
                <a href="../../users/s-ugra%40ya.ru/topics/index.html">
                    11
                </a>
            </div>
            <div>
                Сообщения:
                <a href="../../users/s-ugra%40ya.ru/posts/index.html">
                    763
                </a>
            </div>
            <div>
                Участник с: 15 ноября 2016
            </div>
            
        </td>
        <td class="post-content">
            <strong>SirKittyKnight</strong>, говоря о сервисах, я имел в виду <a href="https://www.accuweatherglobal.com/default.php#">вот это</a>, где &quot;Fast, Low Priced and Automated, the simplest way to get AccuWeather?s Weather Data at your end, starting at US$0.69 per month.&quot;, а читать страницу, которая в открытом доступе - не есть использование какого-то сервиса.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
        </div>
        <div>&nbsp;</div>
        
            <div class="text-center">
    


    <nav>
        <ul class="pagination">
            
                <li class="previous disabled">
                    <span>
                        <span aria-hidden="true">&laquo;</span>
                        <span class="hidden-xs">предыдущая страница</span>
                    </span>
                </li>
            

            
                
                    
                        <li class="active">
                            <a href="index2679.html?page=1">1 <span class="sr-only">(текущая страница)</span></a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index4658.html?page=2">2</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index9ba9.html?page=3">3</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexfdb0.html?page=4">4</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexaf4d.html?page=5">5</a>
                        </li>
                    
                
            

            
                <li class="next">
                    <a href="index4658.html?page=2" aria-label="следующая страница">
                        <span class="hidden-xs">следующая страница</span>
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            
        </ul>
    </nav>


</div>

        

        

        
            
<a href="../../../accounts/register/index.html">Зарегистрироваться</a> или <a href="../../../accounts/login/index7faf.html?next=/forum/topic/18082/">войдите</a> чтобы оставить сообщение.

        

        
    </div>

        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

</body>

<!-- Mirrored from archlinux.org.ru/forum/topic/18082/?page=1 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 04:18:10 GMT -->
</html>
