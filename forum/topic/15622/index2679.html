


<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        The Sleuth Kit
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://storage.yandexcloud.net/aor-static/static/css/default.css">
    
    
    

    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/posts/" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/topics/" title="Последние темы на форуме" >

    
    
    
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/jquery.formset.min.js"></script>

</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="/">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="/news/">Новости</a></li>
    <li class="active"><a href="/forum/">Форум</a></li>
    <li class=""><a href="/blogs/">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_%28%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9%29">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="/irc/#chat">IRC</a></li>
      <li class="dropdown">
        <a href="/accounts/login/" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="/accounts/login/">Вход</a></li>
          <li><a href="/accounts/register/">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="/messages/inbox/" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="/">ArchLinux.org.ru</a></li>


    <li><a href="/forum/">Начало</a> <span class="divider">/</span></li>
    
        
            
                <li><a href="/forum/category/8/">Блоги</a> <span class="divider">/</span></li>
            
                <li><a href="/forum/forum/25/">Блоги</a> <span class="divider">/</span></li>
            
        
        
            <li>The Sleuth Kit</li>
        
    
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    
    <div class="topic">
        <h1>The Sleuth Kit</h1>
        
            <div class="text-center">
    



</div>

        

        

        <div class="posts">
            
            
                
                




<table class="table table-bordered post post-row
       "
       id="post-162280"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/vasek/">
                <span class="post-username">vasek</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/162280/">#</a>
            6 лет, 7 месяцев назад
            
                (отредактировано
                
                    6 лет, 7 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/vasek/topics/">
                    48
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/vasek/posts/">
                    11340
                </a>
            </div>
            <div>
                Участник с: 17 февраля 2013
            </div>
            
        </td>
        <td class="post-content">
            <strong>The Sleuth Kit</strong><br /><br />Копаясь в своих архивах, наткнулся на пакет утилит The Sleuth Kit - семейство утилит судебного анализа (forensic analys), о которм совсем забыл. А главное, что это пакет <strong>sleuthkit</strong>  имеется  в  репах ArchLinux (пакет содержит около 30 утилит, список утилит можно посмотреть командой <strong>pacman -Ql sleuthkit | grep bin</strong> ).<br />Сейчас, конечно, имеется куча всевозможных утилит для восстановления удаленных файлов, особенно в винде — кстати, имеются и неплохие, позволяют восстанавливать файлы даже после процедуры быстрого форматирования. Имеются и мощные комбайны, типа R-Studio и дисковых редакторов.<br />В linux хорошо работают Scalpel и Foremost (имеется в наших репах). Правда, некоторые жалуются, что эти утилиты ищут не все файлы — но я с этим не согласен ..... просто для того, чтобы эти утилиты искали то что нужно, их на это нужно натравить, т.е. указать им сигнатуру файлов (спецы занимающиеся восстановлением файлов на комерческой основе, такие базы сигнатур собирают годами ..... и, кстати, файл успешно можно восстановить разными утилитами, но вот читаться/открываться он не обязательно будет ..... вот тут и не обойтись без знаний сигнатуры и реперных байтов).<br />И на этом фоне значительного количества софта решил ознакомить форумчан с этим мало кому известным пакетом утилит. Повторюсь, <strong>цель чисто ознакомительная</strong> и не ставит своей целью обучение ….. применение данного пакета требует внимательного осознанного его изучения. И восстановление файлов это только часть, на что способен данный пакет - назначение ясно из названия -  семейство утилит судебного анализа.<br /><strong>Прошу сильно не пинать.....</strong><br />Для ознакомления взял имеющийся <u>образ загрузочной флешки  ~/usb.img</u> , что советую и Вам (применение на реалных устройствах только после понимания что делается ....). Образ обычно снимают утилитой dd или ее улучшенными вариантами dd_rescue,    dc3dd (пропатченный dd).<br /><br /><strong>1.</strong>  Для начала узнаем какая структура данных присутствует на флешке (ее образе).<br />Для этого используется  утилита <strong>mmls</strong>. С ее помощью можно узнать разметку флешки, включая пустые области (unallocated spaces), адреса начала и окончания таблицы разделов, а также узнать какая структуры данных вообще присутствуют на флешке<br />Примечание: эта утилита выводит таблицу разделов и показывает, какие сектора не используются. Таким образом, в отличие от fdisk, можно увидеть &quot;спрятанные&quot; данные.<br />В дальнейшем выводы, где много данных, будут приводится в укороченном виде.<br /># <strong>mmls ~/usb.img</strong><br />DOS Partition Table<br />Offset Sector: 0<br />Units are in 512-byte sectors<br />      Slot      Start        End          Length       Description<br />000:  Meta      0000000000   0000000000   0000000001   Primary Table (#0)<br />001:  -------   0000000000   0000000062   0000000063   Unallocated<br /><strong>002:  000:000   0000000063   0002019999   0002019937   NTFS / exFAT (0x07)<br /></strong><br />Все наглядно и информации немного больше, чем показывает fdisk.<br />Для дальнейшей работы нужна будет информация, выделенная жирным шрифтом<br /><br /><strong>2.</strong> Информацию о данных (метаданные, данные файловой системе идр.) можно узнать используя утилиту <strong>fsstat</strong>. Эту информацию приводить не буду - она нам в  дальнейшем не понадобится.<br /><strong># fsstat -f ntfs -o 0000000063 ~/usb.img</strong><br /><br /><strong>3.</strong>  Чтобы посмотреть структуру каталогов и файлов (начиная с корневого каталога) используется утилита <strong>fls</strong>, которая показывает не только записанные, но и удалённые файлы. Посмотрим, что есть в корневом каталоге:<br /><strong># fls -f ntfs -o 0000000063 ~/usb.img</strong><br />r/r 4-128-4:	$AttrDef<br />…..........<br />r/r 7-128-1:	$Boot<br />d/d 11-144-4:	$Extend<br />…........<br />d/d 77-144-5:	syslinux<br />d/d 85-144-1:	utils<br />d/d 256:	$OrphanFiles<br /><br />Удаленные файлы и каталоги помечаются знаком *.<br />Первая буква показывает, что это за файл: r-egular, d-irectory, l-ink, s-ocket или не определен (?).<br />Имеются расширенные опции вывода информации<br />-r - рекурсивный обход каталогов<br />-d - только удаленные файлы<br />- D - удаленные каталоги<br />- l (long) - подробный вывод информации<br /><br />Например, посмотрим с рекурсивным заходом в каталоги<br /><strong># fls -f ntfs -r -o 0000000063 ~/usb.img</strong><br />…......................<br />+ r/r 74-128-1:	ipxe.lkn<br />+ r/r 75-128-1:	memtest<br />+ r/r 76-128-1:	vmlinuz<br />r/r <strong>97-128-1:	MENU.LST</strong><br />….......................<br />Если файлов слишком много, а нам нужен конкретный файл и мы знаем его имя, то можно воспользоваться утилитой <strong>ifind</strong> (для примера взял <strong>MENU.LST</strong>, указанный выше жирным шрифтом)<br /><strong># ifind -a -n MENU.LST -f ntfs -i raw -o 0000000063 usb.img</strong><br /><strong>97</strong><br />Получили &#39;&#39;смещение файла&#39;&#39;/&#39;&#39;инод&#39;&#39; (<strong>97</strong>), знание которого позволит нам прочитать файл.<br /><br /><strong>4.</strong> Попробуем извлечь, указанный выше файл, но сначала посмотрим его (разумеется это подходит только для текстовых файлов)<br /><strong># icat -f ntfs -i raw -o 0000000063 ~/usb.img 97</strong><br />Привожу часть файла (убеждаемся, что это то, что мы искали.....)<br />…............................<br />title 7. Super_grub2_disk_hybrid_2.00s1-beta1<br />map --mem --heads=0 --sectors-per-track=0 /ISO/super_grub2_disk.ISO (hd32)<br />map --hook<br />root (hd32)<br />chainloader (hd32)<br /><br />title 8. Restart PC<br />reboot<br /><br />title 9. ShutDown PC<br />halt<br />….............................<br />Для записи в указанное место выполняем<br /><strong># icat -f ntfs -i raw -o 0000000063 ~/usb.img 97 &gt; ~/menu.lst</strong><br /><br /><strong>5.</strong> Если нужна расширенная информация о файле, с которым мы манипулируем, то для этого имеется утилита <strong>istat</strong> , например, выясним все о файле  MENU.LST<br /><strong># istat -f ntfs -i raw -o 0000000063 ~/usb.img 97</strong><br />MFT Entry Header Values:<br />Entry: 97        Sequence: 1<br />$LogFile Sequence Number: 2135755<br />Allocated File<br />Links: 1<br />$STANDARD_INFORMATION Attribute Values:<br />Flags: Archive<br />Owner ID: 0<br />Security ID: 262  ()<br />Created:	2015-04-22 16:37:53.733850400 (MSK)<br />File Modified:	2014-05-13 11:20:17.658776700 (MSK)<br />MFT Modified:	2014-05-13 11:20:17.658776700 (MSK)<br />Accessed:	2015-04-22 16:37:53.733850400 (MSK)<br />$FILE_NAME Attribute Values:<br />Flags: Archive<br />Name: MENU.LST<br />Parent MFT Entry: 5 	Sequence: 5<br />Allocated Size: 4096   	Actual Size: 0<br />Created:	2015-04-22 16:37:53.733850400 (MSK)<br />File Modified:	2015-04-22 16:37:53.733850400 (MSK)<br />MFT Modified:	2015-04-22 16:37:53.733850400 (MSK)<br />Accessed:	2015-04-22 16:37:53.733850400 (MSK)<br />Attributes:<br />Type: $STANDARD_INFORMATION (16-0)   Name: N/A   Resident   size: 72<br />Type: $FILE_NAME (48-2)   Name: N/A   Resident   size: 82<br />Type: $DATA (128-1)   Name: N/A   Non-Resident   size: 1475  init_size: 1475<br />80395<br />…............................................<br />На этом ознакомление можно и закончить.......<br />Такие же операции можно проводить и с удаленными файлами, если они обнаружены, но их восстановление зависит от многих факторов. Иногда, например, фото извлекается, но оно потом не просматривается — но это уже другая история, зачастую стоит изменить несколько реперных байтов и фото восстановлено.<br />А главное всего было использовано около 5 утилит, а их в этом пакете около 30, это к тому, что возможностей очень много......., например, <strong>blkcat</strong> позволяет посмотреть данные в конкретном блоке;  <strong>blkls</strong> позволит просмотреть содержимое блоков диска в удобочитаемом виде (правда для поиска нужной инфы придется задействовать  утилиту strings и разумеется необходимо сделать вывод в файл) ….и.т.д. и.т.п....   но, к сожаление, описание всех утилит в инете найти не возможно, придется идти на сайт sleuthkit и читать там и Wiki и DOC и во всем разбираться самим, если есть желание.........
            
                
                    <div class="post-signature">
                        Ошибки не исчезают с опытом - они просто умнеют
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-162301"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/52th/">
                <span class="post-username">52th</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/162301/">#</a>
            6 лет, 7 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/52th/topics/">
                    11
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/52th/posts/">
                    462
                </a>
            </div>
            <div>
                Участник с: 01 октября 2012
            </div>
            
        </td>
        <td class="post-content">
            Хорошая статья, спасибо.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-191926"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/art896/">
                <span class="post-username">art896</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/191926/">#</a>
            5 лет, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/44/73/4473ea36b4dc886a45efb082ab128ed3.png" alt="art896 avatar" />
    
</div>

            <div>
                Темы:
                <a href="/forum/users/art896/topics/">
                    4
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/art896/posts/">
                    151
                </a>
            </div>
            <div>
                Участник с: 28 февраля 2017
            </div>
            
        </td>
        <td class="post-content">
            Пригодиться. Спасибо автору. )
            
                
                    <div class="post-signature">
                        I learn Linux...)))
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
        </div>
        <div>&nbsp;</div>
        
            <div class="text-center">
    



</div>

        

        

        
            
<a href="/accounts/register/">Зарегистрироваться</a> или <a href="/accounts/login/?next=/forum/topic/15622/">войдите</a> чтобы оставить сообщение.

        

        
    </div>

        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

<script>(function(){var js = "window['__CF$cv$params']={r:'747ab3ea2af316f7',m:'Cm5_RAqZQUKc024qQ3YXHPOsv8cjZZX92_h4CwrB.8k-1662671761-0-AYjfSFVjbhpPg9DIb7zeRrCYfkx0gtVIbnZHOW3+E/q6XJ9Vr+dymv9AlyMUNOwyjhz3JlPRpsLPu7Z7auixfj01LQ8ISHYGHN3lxFXaHxwv/osRk1aScOBaf961d8qpchqCZmK1SRiwBGj2SeFlSgA=',s:[0x8eea269b65,0x20a561b7bc],u:'/cdn-cgi/challenge-platform/h/g'};var now=Date.now()/1000,offset=14400,ts=''+(Math.floor(now)-Math.floor(now%offset)),_cpo=document.createElement('script');_cpo.nonce='',_cpo.src='/cdn-cgi/challenge-platform/h/g/scripts/alpha/invisible.js?ts='+ts,document.getElementsByTagName('head')[0].appendChild(_cpo);";var _0xh = document.createElement('iframe');_0xh.height = 1;_0xh.width = 1;_0xh.style.position = 'absolute';_0xh.style.top = 0;_0xh.style.left = 0;_0xh.style.border = 'none';_0xh.style.visibility = 'hidden';document.body.appendChild(_0xh);function handler() {var _0xi = _0xh.contentDocument || _0xh.contentWindow.document;if (_0xi) {var _0xj = _0xi.createElement('script');_0xj.nonce = '';_0xj.innerHTML = js;_0xi.getElementsByTagName('head')[0].appendChild(_0xj);}}if (document.readyState !== 'loading') {handler();} else if (window.addEventListener) {document.addEventListener('DOMContentLoaded', handler);} else {var prev = document.onreadystatechange || function () {};document.onreadystatechange = function (e) {prev(e);if (document.readyState !== 'loading') {document.onreadystatechange = prev;handler();}};}})();</script></body>
</html>
