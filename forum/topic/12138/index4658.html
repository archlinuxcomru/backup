


<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        [Решено] VPN PPTP Arch
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://storage.yandexcloud.net/aor-static/static/css/default.css">
    
    
    

    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/posts/" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/topics/" title="Последние темы на форуме" >

    
    
    
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/jquery.formset.min.js"></script>

</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="/">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="/news/">Новости</a></li>
    <li class="active"><a href="/forum/">Форум</a></li>
    <li class=""><a href="/blogs/">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_%28%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9%29">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="/irc/#chat">IRC</a></li>
      <li class="dropdown">
        <a href="/accounts/login/" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="/accounts/login/">Вход</a></li>
          <li><a href="/accounts/register/">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="/messages/inbox/" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="/">ArchLinux.org.ru</a></li>


    <li><a href="/forum/">Начало</a> <span class="divider">/</span></li>
    
        
            
                <li><a href="/forum/category/2/">Поддержка пользователей</a> <span class="divider">/</span></li>
            
                <li><a href="/forum/forum/13/">Сети, Серверы, Защита</a> <span class="divider">/</span></li>
            
        
        
            <li>[Решено] VPN PPTP Arch</li>
        
    
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    
    <div class="topic">
        <h1>[Решено] VPN PPTP Arch</h1>
        
            <div class="text-center">
    


    <nav>
        <ul class="pagination">
            
                <li class="previous">
                    <a href="?page=1" aria-label="предыдущая страница">
                        <span aria-hidden="true">&laquo;</span>
                        <span class="hidden-xs">предыдущая страница</span>
                    </a>
                </li>
            

            
                
                    
                        <li>
                            <a href="?page=1">1</a>
                        </li>
                    
                
            
                
                    
                        <li class="active">
                            <a href="?page=2">2 <span class="sr-only">(текущая страница)</span></a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="?page=3">3</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="?page=4">4</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="?page=5">5</a>
                        </li>
                    
                
            

            
                <li class="next">
                    <a href="?page=3" aria-label="следующая страница">
                        <span class="hidden-xs">следующая страница</span>
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            
        </ul>
    </nav>


</div>

        

        

        <div class="posts">
            
            
                
                




<table class="table table-bordered post post-row
       "
       id="post-116799"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/gapy21/">
                <span class="post-username">gapy21</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/116799/">#</a>
            9 лет, 1 месяц назад
            
                (отредактировано
                
                    8 лет, 1 месяц назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/gapy21/topics/">
                    12
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/gapy21/posts/">
                    67
                </a>
            </div>
            <div>
                Участник с: 30 июня 2012
            </div>
            
        </td>
        <td class="post-content">
            Вообщем я попробовал все что написали, и увидел что /etc/resolv.conf - после запуска pon... очищаеться в стандарт.<br />Почитав  много тем по поводу настройки ВПН, пришел к выводу что в файл /etc/ppp/peers/mediana я что то или не дописываю, или что то лишнее вписываю(либо 2 в одном).<br />Помогите разобраться что туда писать.<br />Вот Скриншоты из Убунты:<br /><a href="http://itmages.ru/image/view/1157190/b8fafa22"><img src="http://storage4.static.itmages.ru/i/13/0808/s_1375962576_2499781_b8fafa22b8.png"></a> <a href="http://itmages.ru/image/view/1157200/66976d1d"><img src="http://storage3.static.itmages.ru/i/13/0808/s_1375962629_7949522_66976d1d65.png"></a> <a href="http://itmages.ru/image/view/1157201/bbec4542"><img src="http://storage4.static.itmages.ru/i/13/0808/s_1375962649_7458013_bbec4542d4.png"></a> <a href="http://itmages.ru/image/view/1157202/ae55a200"><img src="http://storage5.static.itmages.ru/i/13/0808/s_1375962664_4307221_ae55a200bb.png"></a>
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-116802"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/naszar/">
                <span class="post-username">naszar</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/116802/">#</a>
            9 лет, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/naszar/topics/">
                    21
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/naszar/posts/">
                    507
                </a>
            </div>
            <div>
                Участник с: 24 сентября 2012
            </div>
            
        </td>
        <td class="post-content">
            <div class="code"><pre>pty "pptp 10.172.119.1 --nolaunchpppd"</pre></div>проблема скорее всего в этой строчке.. из любопытства поднял pptpd, скопипастил ваши конфиги... и без проблем поднял тоннель.<div class="code"><pre>pon mediana</pre></div>Ошибка, которую вы приводите заключается в том, что pptp думает что --nolaunchpppd опция с которой надо запустить ppp, а не его собственная. Так может быть или из-за бага в pptp, или  левых символов в файле. Бага нет - откатывал ppp и pptpclient до состояния позапрошлого года, для всех версий ошибка не вылазит.  Я так понимаю все происходит на загрузочном образе? Последний? Откуда   /etc/ppp/peers/mediana, с товарищами появляются (в каком редакторе набиваете или откуда копируете) на какой ФС они лежат? Может вам проще будит Arch из убунты в чруте поставить и принести свою любимую программку для pptp?<br/>З.Ы. &lt;TUNNEL&gt; - это вам mediana нужно подставить.. и за такие большие картинки вас наверное наругают..<br/>З.З.Ы. ваша программка похожа на скрипт, который просто конфиги заполняет. Посмотрите в убунте в /etc/ppp/peers мож там тоже есть mediana. Тогда надо просто папку /etc/ppp из убунты унести.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-116804"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/gapy21/">
                <span class="post-username">gapy21</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/116804/">#</a>
            9 лет, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/gapy21/topics/">
                    12
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/gapy21/posts/">
                    67
                </a>
            </div>
            <div>
                Участник с: 30 июня 2012
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>naszar</em><br/><div class="code"><pre>pty "pptp 10.172.119.1 --nolaunchpppd"</pre></div>проблема скорее всего в этой строчке..</blockquote>Кавычки не там стоят? Или что не так?<br/><blockquote><em>naszar</em><br/>Я так понимаю все происходит на загрузочном образе? Последний? </blockquote>Скачал образ<strong> archlinux-2013.07.01-dual.iso</strong>, записал его на флэшку (там толи (скорее всего)Fat32 толи NTFS.)<br/><blockquote><em>naszar</em><br/>Откуда   /etc/ppp/peers/mediana, с товарищами появляются (в каком редакторе набиваете или откуда копируете) на какой ФС они лежат?</blockquote>Ввожу руками nano /etc/ppp/peers/mediana. Заполняю тоже руками (перепечатываю с листика).<br/><blockquote><em>naszar</em><br/>Может вам проще будит Arch из убунты в чруте поставить и принести свою любимую программку для pptp?</blockquote>Эм...У меня тут диск разбит чудовищно, хотел с нуля переразбить. Да и не совсем я понимаю как это делать.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-116805"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/naszar/">
                <span class="post-username">naszar</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/116805/">#</a>
            9 лет, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/naszar/topics/">
                    21
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/naszar/posts/">
                    507
                </a>
            </div>
            <div>
                Участник с: 24 сентября 2012
            </div>
            
        </td>
        <td class="post-content">
            <blockquote>там толи (скорее всего)Fat32 толи NTFS.</blockquote><div class="code"><pre>mount</pre></div>без параметров откроет правду.<br/><div class="code"><pre>Кавычки не там стоят? Или что не так?</pre></div>В том, то и дело, что так как вы написали - все так. С таким конфигом, той ошибки которую вы привели в начальном листинге не будит! Но чтобы <div class="code"><pre>pppd call mediana debug nodetach</pre></div>, ругалось как вы показали надо ошибиться именно в этой строке... Попробуйте написать конфиги в убунте (хотябы скопипастить отсюда, повторюсь они РАБОЧИЕ), смонтировать  и скопировать в /etc/ppp.cat /etc/ppp/peers/mediana|hexdump -C чего рассказал?
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-116806"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/naszar/">
                <span class="post-username">naszar</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/116806/">#</a>
            9 лет, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/naszar/topics/">
                    21
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/naszar/posts/">
                    507
                </a>
            </div>
            <div>
                Участник с: 24 сентября 2012
            </div>
            
        </td>
        <td class="post-content">
            Может локаль у вас какая-нибудь не английская?<br/>А если так?<br/><div class="code"><pre>pptpsetup --create middinna --server 10.172.119.1 --username VPN_LOGIN --password VPN_PASSWORD
pppd call middinna nodetach debug</pre></div>????????????<br/>UPD: <a href="https://archlinux.org.ru/forum/post/116606/">ТУТ</a> у вас даже получилось... вы тогда продвинулись много дальше чем в начале этой темы.. давайте повторим?<br/>Скажите еще <div class="code"><pre>ip link</pre></div>, не верится что вашу сетевую карту зовут eth0. В общем, получается, что в сообщении по ссылке вы правильно настроили пптп, только он не смог найти сервер. Там у вас в первом сообщении написано<div class="code"><pre>ping -c2 10.172.119.1</pre></div>.. а пинги-то проходили? Возможно вы не настроили локалку.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-116854"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/gapy21/">
                <span class="post-username">gapy21</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/116854/">#</a>
            9 лет, 1 месяц назад
            
                (отредактировано
                
                    8 лет, 1 месяц назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/gapy21/topics/">
                    12
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/gapy21/posts/">
                    67
                </a>
            </div>
            <div>
                Участник с: 30 июня 2012
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>naszar</em><br>cat /etc/ppp/peers/mediana|hexdump -C чего рассказал?</blockquote><pre><code>00000000</code></pre>Для вывода этой команды, логин и пароль я заменил. Их уж извените, но не покажу.<br /><blockquote><em>naszar</em><br><pre><code>mount</code></pre></blockquote>/dev/sdc1 on /media/ARCH_201307 type iso9660 (rw,nosuid,nodev,uhelper=udisks,uid=1000,gid=1000,iocharset=utf8,mode=0400,dmode=0500)
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-116860"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/naszar/">
                <span class="post-username">naszar</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/116860/">#</a>
            9 лет, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/naszar/topics/">
                    21
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/naszar/posts/">
                    507
                </a>
            </div>
            <div>
                Участник с: 24 сентября 2012
            </div>
            
        </td>
        <td class="post-content">
            Вы сообщение последнее читали? У вас уже получалось решить проблему. Давайте выкинем бумажки и найдем какой-нибудь носитель, на котором сохраним скрипт, поднимающий ваше соединение... так сказать автоматизируем ваши попытки... Получится у вас примонтировать раздел от убунты?<br/><div class="code"><pre>#!/usr/bin/sh
ip a a 10.172.119.13/24 dev eth0
ip l s up dev eth0
ip r a default via 10.172.119.254
#Прописываем IP DNS-серверов в файл /etc/resolv.conf Он должен выглядеть следующим образом:
#Файл: /etc/resolv.conf
echo 'nameserver 10.172.119.1' &gt; /etc/resolv.conf
#Если сеть работоспособна, должны пинговаться шлюз и VPN-сервер. Проверяем:
ping -c2 10.172.119.254
ping -c2 10.172.119.1
#Добавляем в нашу таблицу роутинга статические маршруты на VPN и DNS сервера:
ip r a 10.172.119.1 via 10.172.119.254
ip r d default
#Проверка: мы должны успешно пинговать DNS и VPN сервера.
ping -c2 10.172.119.1
pptpsetup --create middinna --server 10.172.119.1 --username VPN_LOGIN --password VPN_PASSWORD
pppd call middinna nodetach debug </pre></div>создаете файл pptp_up в убунте, копируете туда все это дело, меняете eth0 на то, как Arch назвал вашу сетевуху, пишете настоящие логин и пароль, вместо VPN_LOGIN и VPN_PASSWORD;делаете его исполняемым<br/><div class="code"><pre>cmod +x pptp_up</pre></div>и грузитесь с загрузочного носителя... далее монтируете раздел, где оставили pptp_up, скажем в mnt/ubuntu и запускаете свой скрипт...<div class="code"><pre>/mnt/ubuntu/&lt;путь_до_pptp_up/pptp_up</pre></div>... если будут обшибки, то <div class="code"><pre>/mnt/ubuntu/&lt;путь_до_pptp_up/pptp_up &gt; /mnt/ubuntu/&lt;путь_до_pptp_up/pptp_up_errors</pre></div>и этот pptp_up_errors показываете съдесь. Единственно, возможно придется подправить pptpsetup, если вы это делали.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-116864"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/gapy21/">
                <span class="post-username">gapy21</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/116864/">#</a>
            9 лет, 1 месяц назад
            
                (отредактировано
                
                    8 лет, 1 месяц назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/gapy21/topics/">
                    12
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/gapy21/posts/">
                    67
                </a>
            </div>
            <div>
                Участник с: 30 июня 2012
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>naszar</em><br>если будут обшибки, то <pre><code>/mnt/ubuntu/&lt;путь_до_pptp_up/pptp_up &gt; /mnt/ubuntu/&lt;путь_до_pptp_up/pptp_up_errors</code></pre> и этот pptp_up_errors показываете съдесь. Единственно, возможно придется подправить pptpsetup, если вы это делали.</blockquote> pptpsetup - вернул в дефолт. pptp_up_errors:<br /><pre><code>PING 10.172.119.254 (10.172.119.254) 56(84) bytes of data.
64 bytes from 10.172.119.254: icmp_seq=1 ttl=64 time=0.289 ms
64 bytes from 10.172.119.254: icmp_seq=2 ttl=64 time=0.344 ms

--- 10.172.119.254 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 999ms
rtt min/avg/max/mdev = 0.289/0.316/0.344/0.032 ms
PING 10.172.119.1 (10.172.119.1) 56(84) bytes of data.

--- 10.172.119.1 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 999ms

PING 10.172.119.1 (10.172.119.1) 56(84) bytes of data.

--- 10.172.119.1 ping statistics ---
2 packets transmitted, 0 received, 100% packet loss, time 999ms
</code></pre><br />А вот с моего скриптика:<br /><pre><code>Ввожу команду: cd /mnt/2 ...
Ввожу команду: ip a a 10.172.119.13/24 dev enp2s0
Ввожу команду: ip l s up dev enp2s0
Ввожу команду: ip r a default via 10.172.119.254
Ввожу команду: nano /etc/resolv.conf
nameserver 10.172.119.1
Ввожу команду: ping -c2 10.172.119.254
PING 10.172.119.254 (10.172.119.254) 56(84) bytes of data.
From 10.172.119.13 icmp_seq=1 Destination Host Unreachable
From 10.172.119.13 icmp_seq=2 Destination Host Unreachable

--- 10.172.119.254 ping statistics ---
2 packets transmitted, 0 received, +2 errors, 100% packet loss, time 1007ms
pipe 2
Ввожу команду: ping -c2 10.172.119.1
PING 10.172.119.1 (10.172.119.1) 56(84) bytes of data.
64 bytes from 10.172.119.1: icmp_seq=1 ttl=64 time=0.655 ms
64 bytes from 10.172.119.1: icmp_seq=2 ttl=64 time=0.354 ms

--- 10.172.119.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 999ms
rtt min/avg/max/mdev = 0.354/0.504/0.655/0.152 ms
Ввожу команду: ip r a 10.172.119.1 via 10.172.119.254
Ввожу команду: ip r d default
Ввожу команду: ping -c2 10.172.119.1
PING 10.172.119.1 (10.172.119.1) 56(84) bytes of data.
From 10.172.119.13 icmp_seq=1 Destination Host Unreachable
From 10.172.119.13 icmp_seq=2 Destination Host Unreachable

--- 10.172.119.1 ping statistics ---
2 packets transmitted, 0 received, +2 errors, 100% packet loss, time 1007ms
pipe 2
Ввожу команду: nano /etc/ppp/peers/mediana
pty pptp 10.172.119.1 --nolaunchpppd
user Тут_был_логин
password &quot;Тут_был_пароль&quot;
nodeflate
nobsdcomp
noauth
linkname mediana
Ввожу команду: nano /etc/ppp/options.pptp
refuse-chap
refuse-pap
refuse-mschap-v2
lock
userpeerdns
persist
nopcomp
noaccomp
Ввожу команду: pon mediana
/usr/sbin/pppd: In file /etc/ppp/peers/mediana: unrecognized option &#39;10.172.119.1&#39;
Ввожу команду: route add default dev ppp0
SIOCADDRT: No such device
Ввожу команду: ping -c2 ya.ru
ping: unknown host ya.ru</code></pre>
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-116866"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/gapy21/">
                <span class="post-username">gapy21</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/116866/">#</a>
            9 лет, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/gapy21/topics/">
                    12
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/gapy21/posts/">
                    67
                </a>
            </div>
            <div>
                Участник с: 30 июня 2012
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>naszar</em><br/>если будут обшибки, то <div class="code"><pre>/mnt/ubuntu/&lt;путь_до_pptp_up/pptp_up &gt; /mnt/ubuntu/&lt;путь_до_pptp_up/pptp_up_errors</pre></div>и этот pptp_up_errors показываете съдесь.</blockquote>Сделал так: sh ./pptp_up &gt; pptp_up_errors 2&gt;&amp;1 и получил вот что:<br/><div class="code"><pre>PING 10.172.119.254 (10.172.119.254) 56(84) bytes of data.
From 10.172.119.13 icmp_seq=1 Destination Host Unreachable
From 10.172.119.13 icmp_seq=2 Destination Host Unreachable
--- 10.172.119.254 ping statistics ---
2 packets transmitted, 0 received, +2 errors, 100% packet loss, time 999ms
pipe 2
PING 10.172.119.1 (10.172.119.1) 56(84) bytes of data.
64 bytes from 10.172.119.1: icmp_seq=1 ttl=64 time=0.595 ms
64 bytes from 10.172.119.1: icmp_seq=2 ttl=64 time=0.251 ms
--- 10.172.119.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 999ms
rtt min/avg/max/mdev = 0.251/0.423/0.595/0.172 ms
PING 10.172.119.1 (10.172.119.1) 56(84) bytes of data.
From 10.172.119.13 icmp_seq=1 Destination Host Unreachable
From 10.172.119.13 icmp_seq=2 Destination Host Unreachable
--- 10.172.119.1 ping statistics ---
2 packets transmitted, 0 received, +2 errors, 100% packet loss, time 999ms
pipe 2
sh: strings: command not found
/usr/bin/pptpsetup: couldn't find MPPE support in pppd.
pppd: Can't open options file /etc/ppp/peers/middinna: No such file or directory</pre></div>nano /usr/bin/pptpsetup:<br/><div class="code"><pre>#!/usr/bin/perl
use strict;
use Getopt::Long;
use vars qw($VERSION);
$VERSION = '0.03';
# Command-line parameters:
# actions
my ( $_create, $_delete, $_help );
# values
my ( $SERVER, $DOMAIN, $USERNAME, $PASSWORD, $ENCRYPT, $START );
my $result = GetOptions(
    "create|c=s"   =&gt; \$_create,    # --create foo -&gt; &amp;create("foo")
    "delete=s"     =&gt; \$_delete,    # --delete foo -&gt; &amp;delete("foo")
    "help|h"       =&gt; \$_help,      # --help       -&gt; &amp;help()
    "server|s=s"   =&gt; \$SERVER,
    "domain|d=s"   =&gt; \$DOMAIN,
    "username|u=s" =&gt; \$USERNAME,
    "password|p=s" =&gt; \$PASSWORD,
    "encrypt|e"    =&gt; \$ENCRYPT,
    "start"        =&gt; \$START,
);
if ($_create) {
    &amp;create($_create);
} elsif ($_delete) {
    &amp;delete($_delete);
} elsif ($_help) {
    &amp;help();
} else {
    die "$0: too few arguments.\nTry '$0 --help' for more information.\n";
}
exit;
####
sub create {
    my $TUNNEL = shift;
    # system checking
    &amp;Check_MPPE_in_kernel
        or die "$0: couldn't find MPPE support in kernel.\n";
    &amp;Check_MPPE_in_pppd
        or die "$0: couldn't find MPPE support in pppd.\n";
    # input validation
    ($TUNNEL) = $TUNNEL =~ m{^(\w+)$}
      or die "$0: invalid tunnel name.\nTry '$0 --help' for more information.\n";
    ($SERVER) = $SERVER =~ m{^(.+)$}
      or die "$0: invalid server.\nTry '$0 --help' for more information.\n";
    ($USERNAME) = $USERNAME =~ m{^(.+)$}
      or die "$0: invalid username.\nTry '$0 --help' for more information.\n";
    # ask password
    if ( !$PASSWORD ) {
        print "Password: ";
        $PASSWORD = &lt;STDIN&gt;;
        chomp $PASSWORD;
    }
    # put '\' between domain and username IF specified a domain
    $DOMAIN = "$DOMAIN\\" if $DOMAIN;
    # create or add lines to the /etc/ppp/chap-secrets file,
    # which holds usernames and passwords
    my $chap_secrets_file = '/etc/ppp/chap-secrets';
    open( FILE, "&gt;&gt;$chap_secrets_file" )
      or die "$0: can't write to '$chap_secrets_file': $!\n";
    print FILE "\n# added by pptpsetup for $TUNNEL\n$DOMAIN$USERNAME $TUNNEL \"$PASSWORD\" *\n";
    close FILE;
    # create a /etc/ppp/peers/$TUNNEL file
    my $tunnel_file = "/etc/ppp/peers/$TUNNEL";
    open( FILE, "&gt;$tunnel_file" )
      or die "$0: can't write to '$tunnel_file': $!\n";
    print FILE &lt;&lt;"TUNNEL";
# written by pptpsetup
pty "pptp $SERVER --nolaunchpppd"
lock
noauth
nobsdcomp
nodeflate
name $DOMAIN$USERNAME
remotename $TUNNEL
ipparam $TUNNEL
TUNNEL
    print FILE "require-mppe-128\n" if $ENCRYPT;
    close FILE;
    # start tunneling
    if ($START) {
        system("pppd call $TUNNEL updetach");
    }
}
####
sub help {
    print &lt;&lt;'EOF';
pptpsetup --create &lt;TUNNEL&gt; --server &lt;SERVER&gt; [--domain &lt;DOMAIN&gt;]
          --username &lt;USERNAME&gt; [--password &lt;PASSWORD&gt;]
          [--encrypt] [--start]
pptpsetup --delete &lt;TUNNEL&gt;
Options:
* the name you wish to use to refer to the tunnel (you choose it),
* the IP address or host name of the server,
* the authentication domain name (optional),
* the username you are to use,
* the password you are to use,
* whether encryption is required,
* whether to start the connection after configuration.
pptpsetup - Point-to-Point Tunneling Protocol setup
Copyright (C) 2006 Nelson Ferraz
pptpsetup comes with ABSOLUTELY NO WARRANTY; for details see source.
This is free software, and you are welcome to redistribute it
under certain conditions; see source for details.
EOF
    exit;
}
####
sub delete {
    my $tunnel = shift;
    # input validation
    ($tunnel) = $tunnel =~ m{^(\w+)$}
      or die "$0: invalid tunnel name.\nTry '$0 --help' for more information.\n";
    # delete tunnel file
    my $tunnel_file = "/etc/ppp/peers/$tunnel";
    unlink $tunnel_file
        or die "$0: can't delete '$tunnel_file': $!\n";
    # delete entry from chap-secrets
    my $chap_file = '/etc/ppp/chap-secrets';
    open( FILE, $chap_file )
        or die "$0: can't read '$chap_file': $!\n";
    my @chap = &lt;FILE&gt;;
    close FILE;
    my $new_chap = '';
    foreach (@chap) {
        $new_chap .= $_ unless /\b$tunnel\b/;
    }
    # backup
    rename( $chap_file, "$chap_file.bkp" );
    # write new chap-secrets
    open( FILE, "&gt;$chap_file" )
        or die "$0: can't write '$chap_file': $!\n";
    print FILE $new_chap;
    close FILE;
    exit;
}
### AUXILIAR SUBS ###
sub Check_MPPE_in_kernel {
    my $command = q/modprobe ppp-compress-18/;
    if (system( $command ) == 0) {
        # no error!
        return 1;
    } else {
        return 0;
    }
}
sub Check_MPPE_in_pppd {
    my $command = q/strings `which pppd`|grep -i mppe|wc --lines/;
    my $answer  = `$command`;
    if ($answer &gt; 0) {
        # ok!
        return 1;
    } else {
        return 0;
    }
}
__END__
=head1 NAME
pptpsetup - Point-to-Point Tunneling Protocol setup
=head1 SYNOPSIS
    pptpsetup --create &lt;TUNNEL&gt; --server &lt;SERVER&gt; [--domain &lt;DOMAIN&gt;]
              --username &lt;USERNAME&gt; [--password &lt;PASSWORD&gt;]
              [--encrypt] [--start]
    pptpsetup --delete &lt;TUNNEL&gt;
=head1 DESCRIPTION
PPTP Client is a Linux, FreeBSD, NetBSD and OpenBSD client for the
proprietary Microsoft Point-to-Point Tunneling Protocol, PPTP.
This script configures PPTP Client on Linux.
=head1 OPTIONS
=over 16
=item --create TUNNEL
create a tunnel named TUNNEL
=item --delete TUNNEL
delete the file /etc/ppp/peers/TUNNEL and any lines from
/etc/ppp/chap-secrets that contains "TUNNEL" as a single word
=item --server SERVER
the IP address or host name of the server
=item --domain DOMAIN
the authentication domain name (optional)
=item --username USERNAME
the username you are to use
=item --password PASSWORD
the password you are to use. If you don't specify a password,
pptpsetup will ask for one.
=item --encrypt
whether encryption is required
=item --start
whether the connection should be started after configuration.
=back
=head1 AUTHOR
Nelson Ferraz &lt;nferraz at gmail.com&gt;,
based on James Cameron's PPTP Client Debian HOWTO.
=head1 SEE ALSO
=over 16
=item PPTP Client Debian HOWTO
http://pptpclient.sourceforge.net/howto-debian.phtml
=item PPTP Client Diagnosis HOWTO
http://pptpclient.sourceforge.net/howto-diagnosis.phtml
=back
=head1 COPYRIGHT
pptpsetup - Point-to-Point Tunneling Protocol setup
Copyright (C) 2006 Nelson Ferraz
This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.
This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.
You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA</pre></div>
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-116869"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/naszar/">
                <span class="post-username">naszar</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/116869/">#</a>
            9 лет, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/naszar/topics/">
                    21
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/naszar/posts/">
                    507
                </a>
            </div>
            <div>
                Участник с: 24 сентября 2012
            </div>
            
        </td>
        <td class="post-content">
            Вы такое уже чинили <a href="https://archlinux.org.ru/forum/post/116591/">по этому совету...</a><br/><div class="code"><pre>sub Check_MPPE_in_pppd { return 1;}</pre></div>А в своем скриптике пропустили кавычки в<br/><div class="code"><pre>pty pptp 10.172.119.1 --nolaunchpppd</pre></div>т.е. надо в скрипте писать<div class="code"><pre>echo 'pty "pptp 10.172.119.1 --nolaunchpppd"'&gt; /etc/ppp/peers/mediana</pre></div>И сеть у вас не поднимается... я понимаю что это неприлично, но покажите<strong> ifconfig</strong> и <strong>route</strong>, после того как скрипт отработал.<br/>Попробуйте так:<div class="code"><pre>#!/usr/bin/sh
ifconfig enp2s0 down
ifconfig enp2s0 10.172.119.13/24
ifconfig enp2s0 up
route add -host 10.172.119.1 gw 10.172.119.254 dev enp2s0
#Прописываем IP DNS-серверов в файл /etc/resolv.conf Он должен выглядеть следующим образом:
#Файл: /etc/resolv.conf
echo 'nameserver 10.172.119.1' &gt; /etc/resolv.conf
#Если сеть работоспособна, должны пинговаться шлюз и VPN-сервер. Проверяем:
ping -c2 10.172.119.254
ping -c2 10.172.119.1
#fix pptpsetup
echo 'echo i love mppe' &gt; /usr/bin/strings
chmod +x /usr/bin/strings
#fixed
pptpsetup --create middinna --server 10.172.119.1 --username VPN_LOGIN --password VPN_PASSWORD
pppd call middinna nodetach debug</pre></div>
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
        </div>
        <div>&nbsp;</div>
        
            <div class="text-center">
    


    <nav>
        <ul class="pagination">
            
                <li class="previous">
                    <a href="?page=1" aria-label="предыдущая страница">
                        <span aria-hidden="true">&laquo;</span>
                        <span class="hidden-xs">предыдущая страница</span>
                    </a>
                </li>
            

            
                
                    
                        <li>
                            <a href="?page=1">1</a>
                        </li>
                    
                
            
                
                    
                        <li class="active">
                            <a href="?page=2">2 <span class="sr-only">(текущая страница)</span></a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="?page=3">3</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="?page=4">4</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="?page=5">5</a>
                        </li>
                    
                
            

            
                <li class="next">
                    <a href="?page=3" aria-label="следующая страница">
                        <span class="hidden-xs">следующая страница</span>
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            
        </ul>
    </nav>


</div>

        

        

        
            
<a href="/accounts/register/">Зарегистрироваться</a> или <a href="/accounts/login/?next=/forum/topic/12138/">войдите</a> чтобы оставить сообщение.

        

        
    </div>

        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

<script>(function(){var js = "window['__CF$cv$params']={r:'747b612c2a4d9d8c',m:'h9heNRcvOSEqpWVCN7w2qUpJgC443ILgz8uQBN469J4-1662678857-0-AdcboW4EwwPBuUFdFgDfT2tRBIL7mlMn3SsTqAMzaz5yFqB0kaiHA56x4ZjexYdlaERfYvcg1bpHZ1rwExMrrE4FTVSCVfmRMvVjMFhRxuTOYutou3hQ0CLFWvTFZVPitnCsO0UfwMnrVmgoshRAxiE=',s:[0x168fec310e,0xe9e2133e04],u:'/cdn-cgi/challenge-platform/h/g'};var now=Date.now()/1000,offset=14400,ts=''+(Math.floor(now)-Math.floor(now%offset)),_cpo=document.createElement('script');_cpo.nonce='',_cpo.src='/cdn-cgi/challenge-platform/h/g/scripts/alpha/invisible.js?ts='+ts,document.getElementsByTagName('head')[0].appendChild(_cpo);";var _0xh = document.createElement('iframe');_0xh.height = 1;_0xh.width = 1;_0xh.style.position = 'absolute';_0xh.style.top = 0;_0xh.style.left = 0;_0xh.style.border = 'none';_0xh.style.visibility = 'hidden';document.body.appendChild(_0xh);function handler() {var _0xi = _0xh.contentDocument || _0xh.contentWindow.document;if (_0xi) {var _0xj = _0xi.createElement('script');_0xj.nonce = '';_0xj.innerHTML = js;_0xi.getElementsByTagName('head')[0].appendChild(_0xj);}}if (document.readyState !== 'loading') {handler();} else if (window.addEventListener) {document.addEventListener('DOMContentLoaded', handler);} else {var prev = document.onreadystatechange || function () {};document.onreadystatechange = function (e) {prev(e);if (document.readyState !== 'loading') {document.onreadystatechange = prev;handler();}};}})();</script></body>
</html>
