


<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Arch в качестве гипервизора?
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://storage.yandexcloud.net/aor-static/static/css/default.css">
    
    
    

    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/posts/" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/topics/" title="Последние темы на форуме" >

    
    
    
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/jquery.formset.min.js"></script>

</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="/">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="/news/">Новости</a></li>
    <li class="active"><a href="/forum/">Форум</a></li>
    <li class=""><a href="/blogs/">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_%28%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9%29">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="/irc/#chat">IRC</a></li>
      <li class="dropdown">
        <a href="/accounts/login/" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="/accounts/login/">Вход</a></li>
          <li><a href="/accounts/register/">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="/messages/inbox/" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="/">ArchLinux.org.ru</a></li>


    <li><a href="/forum/">Начало</a> <span class="divider">/</span></li>
    
        
            
                <li><a href="/forum/category/5/">Разное</a> <span class="divider">/</span></li>
            
                <li><a href="/forum/forum/4/">/dev/null</a> <span class="divider">/</span></li>
            
        
        
            <li>Arch в качестве гипервизора?</li>
        
    
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    
    <div class="topic">
        <h1>Arch в качестве гипервизора?</h1>
        
            <div class="text-center">
    



</div>

        

        

        <div class="posts">
            
            
                
                




<table class="table table-bordered post post-row
       "
       id="post-86364"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/srs2k/">
                <span class="post-username">srs2k</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/86364/">#</a>
            13 лет, 10 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/srs2k/topics/">
                    1
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/srs2k/posts/">
                    1
                </a>
            </div>
            <div>
                Участник с: 25 октября 2008
            </div>
            
        </td>
        <td class="post-content">
            <strong>Вступление</strong><br/><br/>В настоящее время только глухой не слышал про виртуализацию, а любой кто имеет хоть какое-то отношение к IT-индустрии уже испытал её на практике. Сейчас в этом секторе рынка предлагается множество решений на любой вкус и цвет и под разные задачи - свободные и проприетарные, с разными технологическими подходами (эмуляция, паравиртуализация, полная виртуализациия), ориентированные на серверы или десктопы и работающие под разным окружением (OS-hosted и bare-metal).<br/>Вот о последнем различии я и хотел поговорить. Насколько я понимаю, оно заключается в использовании ОС общего назначения либо специализированной системы, заточенной для работы именно в качестве хоста для гипервизора. Самый яркий пример такого продукта это VMware ESX(i), который использует переработанный RHEL. С точки зрения производительности и накладных расходов это лидирующий продукт, вот только использовать его на десктопе не получится вследствие его ориентированности на серверные платформы (требует аппаратную виртуализацию, поддерживает в основном серверное железо, работать с гостевыми ОС можно только удаленно).<br/><br/><br/><strong>А вот если бы&#8230;</strong><br/><br/>Я посмотрел <a href="https://ru.youtube.com/watch?v=acDS7DmHC_g">презентацию</a> <a href="http://www.splashtop.com/">Splashtop</a> (см. также <a href="https://www.phoenix.com/en/Products/Browse%2Bby%2BProducts/Phoenix%2BHyperSpace/default.htm">Phoenix HyperSpace</a>) и обратил внимание на одну деталь - эта встраиваемая ОС поддерживает запуск гостевых ОС &ldquo;из коробки&rdquo; (в данном случае в качестве коробки выступает FlashBIOS). Если все эти медиаплейеры, скайпы и прочие огнелисы выбросить, то в остатке получается desktop-oriented bare-metal hypervisor! <br/>Такая концепция &ldquo;супер-BIOS'а&rdquo; с необходимым минимумом софта + что-то похожее на VirtualBox мне кажется весьма привлекательной, будь она реализована в виде оптимизированного под это дело Linux-дистрибутива с полной и актуальной базой драйверов и некоторым количеством базовых virtual appliances (даже не знаю как адекватно перевести этот термин). К большому сожалению Splashtop - продукт закрытый и переделать его под другую платформу нет никакой возможности  :( <br/><br/><br/><strong>Идея</strong><br/><br/>Состоит в создании десктоп-ориентированного гипервизора  со следующими возможностями:<br/><br/><ol><li>Использование в качестве хостовой ОС модифицированного Archlinux и по-возможности свободной системы виртуализации<br/></li><li>Поддержка обычного десктопного железа<br/></li><li>Минимальное количество необходимых компонентов хостовой ОС<br/></li><li>Минимизация использования ресурсов хостовой ОС<br/></li><li>Использование быстрого и максимально облегченного WM<br/></li><li>Установка и настройка гипервизора а так же гостевых ОС через GUI<br/></li><li>Экспорт/импорт гостевых ОС по сети или на внешние носители<br/></li><li>Динамическое распределение и расшаривание дискового пространства между гостевыми ОС<br/></li><li>Включение в дистрибутив преднастроенных гостевых ОС (a.k.a. virtual appliances)<br/></li><li>Возможность использования ОС семейства Windows в качестве гостевой системы (с поддержкой аппаратного ускорения Direct3D/OpenGL)*<br/><br/><br/><strong>Подробнее</strong><br/><br/>Рассмотрим эти пункты более детально.<br/><br/></li><li><strong>Использование в качестве хостовой ОС модифицированного Archlinux и по возможности свободной системы виртуализации</strong> Причина выбора в качестве хостовой ОС именно Арча состоит исключительно в моем субъективном ощущении что это сообщество довольно динамично развивается; ну и конечно есть небольшой опыт использования - я оценил его простоту и скорость работы. Если мне кто-нибудь авторитетно докажет что для этих целей лучше взять Debian или Gentoo - я против не буду, вот только Генту я не знаю. Далее, что касается модификации - что именно придется пилить и переделывать я пока даже не имею представления, но чую что без этого не обойтись. Ну а в качестве ядра гипервизора я думаю использовать Xen (но тут есть одно большое НО - как быть тем у кого процессоры и материнские платы не поддерживают технологию Intel-VT или аналогичную от AMD?) или VirtualBox OSE (который даже не поддерживает USB для гостей). А может взять VMware Server?..<br/><br/></li><li><strong>Поддержка обычного десктопного железа</strong> На сегодняшний день в ядре присутствуют драйверы почти что для всего современного железа, но сложность состоит в прокидывании нестандартных PCI-устройств в гостевые системы. Что делать с веб-камерами, WiFi/блютус-адаптерами, карт-ридерами, FireWire и т.п. устройствами - непонятно.<br/><br/></li><li><strong>Минимальное количество необходимых компонентов хостовой ОС</strong> Этот пункт тесно связан с предыдущим. Если какую-либо железку не удасться виртуализовать то, видимо, придется добавлять в хост прикладной софт для работы с ней и это не есть гут. Идеальный вариант к которому надо стремиться - это драйверы, гипервизор, X-Server + WM и GUI-утилита для настройки и управления хостом и гостями.<br/><br/></li><li><strong>Минимизация использования ресурсов хостовой ОС</strong> Ну тут все очевидно - чем меньше лишнего будет крутиться на хосте тем привольнее будет гостям. Разумеется, тюнинг ядра и необходимых служб приветствуется.<br/><br/></li><li><strong>Использование быстрого и максимально облегченного WM</strong> В выборе оптимального оконного менеджера я принципиальных сложностей не вижу - можно взять, к примеру, AfterStep.<br/><br/></li><li><strong>Установка и настройка гипервизора а так же гостевых ОС через GUI</strong> Только пересборкой и shell-скриптами обойтись не удастся, очевидно что какой-то GUI back-end для управления системой придется писать, если не найдется подходящего в составе WM. Гуй для гипервизора - это вообще отдельная песня, надо сначала определиться с первым пунктом.<br/><br/></li><li><strong>Экспорт/импорт гостевых ОС по сети или на внешние носители</strong> Сам по-себе экспорт/импорт виртуальных хостов представляет собой тривиальное копирование образа виртуальной машины (возможно, в сжатом виде), если бы ещё при этом был какой-то унифицированный формат образа&#8230; <br/><br/></li><li><strong>Динамическое распределение и расшаривание дискового пространства между гостевыми ОС</strong> Эту возможность можно попробовать реализовать с помощью LVM (некоторые гипервизоры позволяют использовать динамически расширяющиеся образы дисков, вот только могут ли они динамически уменьшаться?). Так же необходима возможность использования общих для нескольких гостей виртуальных дисков (эмулировать сетевые диски/тома с помощью хоста?).<br/><br/></li><li><strong>Включение в дистрибутив преднастроенных гостевых ОС (a.k.a. virtual appliances)</strong> Сам по-себе &ldquo;голый&rdquo; гипервизор мало кому нужен, а включение в дистрибутив того же, скажем, PuppyLinux даст возможность сразу приступить к использованию системы (как минимум, скачать нужный установочный образ или virtual appliance)<br/><br/></li><li><strong>Возможность использования ОС семейства Windows в качестве гостевой системы (с поддержкой аппаратного ускорения Direct3D/OpenGL)*</strong> На любителя. Или для игр под Windows. *<em>Поддержка аппаратного ускорения Direct3D/OpenGL остается исключительно на совести разработчика системы виртуализации (и железа).</em><br/><br/><br/><strong>Итак</strong><br/><br/>По поводу написанного хотелось бы получить следующие комментарии:<br/></li><li><strong>&ldquo;Баян&rdquo;</strong> - если я изобретаю очередной &ldquo;велосипед&rdquo; - пожалуйста, укажите на похожий проект (похожий - это такой, который ставит перед собой те же или почти те же самые цели).<br/></li><li><strong>Поправки и исправления</strong>- вполне допускаю, что в моих знаниях по этому материалу есть существенные пробелы, поэтому если Вы считаете что я где-то ошибся или использовал неправильный термин буду только рад исправить статью с Вашей помощью.<br/></li><li><strong>Концептуальные замечания</strong> - если можете, предложите более стройную или гибкую модель проекта, или помогите откалибровать акценты на задачи - как известно, самые грубые ошибки допускаются на этапе проектирования.<br/></li><li><strong>Детализация</strong> - если Вам интересен этот проект, Вы можете помочь мне сделать следующий шаг - дробление задач на простые подзадачи и составление плана реализации.<br/></li><li><strong>Технические howto</strong> - в сообществе активных пользователей Linux каждый человек начинает с азов и постепенно но неуклонно прогрессирует в направлении эксперта/гуру/бога в познании пути дао-линукс, так что я буду очень признателен каждому просветленному за любую техническую информацию, касающуюся способа реализации той или иной фичи этого проекта.<br/><br/>P.S. Это первое &ldquo;сочинение&rdquo; такого рода которое я написал, я сейчас даже не уверен что запостил его в подходящий раздел или даже сайт.  :) </li></ol>
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
        </div>
        <div>&nbsp;</div>
        
            <div class="text-center">
    



</div>

        

        

        
            
<a href="/accounts/register/">Зарегистрироваться</a> или <a href="/accounts/login/?next=/forum/topic/9147/">войдите</a> чтобы оставить сообщение.

        

        
    </div>

        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

<script>(function(){var js = "window['__CF$cv$params']={r:'747a9a637deb7a6d',m:'LBX5YWlE2SUUEVPSJuZ9QuaS5Vd0rYoa0ykNh5eEaVc-1662670715-0-AYFo+RqZMvtAg+5DisqXd5BgXJlkeCIbCqXUILxq0bj27b94KklKBHPXxT2zUwZxtpvQoWCLmWbSvfn2/T9ZiFhAfE6LHO0nDTMwIRUGV9y5g7S+xp3n9dWQJTAooTbqnQdp1ElN4ipyW8/h2vx7kvU=',s:[0x35fdd9017d,0x49e30db188],u:'/cdn-cgi/challenge-platform/h/g'};var _cpo=document.createElement('script');_cpo.nonce='',_cpo.src='/cdn-cgi/challenge-platform/h/g/scripts/cb/invisible.js?cb=747a9a637deb7a6d',document.getElementsByTagName('head')[0].appendChild(_cpo);";var _0xh = document.createElement('iframe');_0xh.height = 1;_0xh.width = 1;_0xh.style.position = 'absolute';_0xh.style.top = 0;_0xh.style.left = 0;_0xh.style.border = 'none';_0xh.style.visibility = 'hidden';document.body.appendChild(_0xh);function handler() {var _0xi = _0xh.contentDocument || _0xh.contentWindow.document;if (_0xi) {var _0xj = _0xi.createElement('script');_0xj.nonce = '';_0xj.innerHTML = js;_0xi.getElementsByTagName('head')[0].appendChild(_0xj);}}if (document.readyState !== 'loading') {handler();} else if (window.addEventListener) {document.addEventListener('DOMContentLoaded', handler);} else {var prev = document.onreadystatechange || function () {};document.onreadystatechange = function (e) {prev(e);if (document.readyState !== 'loading') {document.onreadystatechange = prev;handler();}};}})();</script></body>
</html>
