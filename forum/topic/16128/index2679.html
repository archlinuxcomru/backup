


<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        [РЕШЕНО] ALSA + JACKD (FFADO) и Steam. Непонятные проблемы. Возможно ли подружить?
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://storage.yandexcloud.net/aor-static/static/css/default.css">
    
    
    

    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/posts/" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/topics/" title="Последние темы на форуме" >

    
    
    
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/jquery.formset.min.js"></script>

</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="/">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="/news/">Новости</a></li>
    <li class="active"><a href="/forum/">Форум</a></li>
    <li class=""><a href="/blogs/">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_%28%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9%29">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="/irc/#chat">IRC</a></li>
      <li class="dropdown">
        <a href="/accounts/login/" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="/accounts/login/">Вход</a></li>
          <li><a href="/accounts/register/">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="/messages/inbox/" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="/">ArchLinux.org.ru</a></li>


    <li><a href="/forum/">Начало</a> <span class="divider">/</span></li>
    
        
            
                <li><a href="/forum/category/2/">Поддержка пользователей</a> <span class="divider">/</span></li>
            
                <li><a href="/forum/forum/10/">Мультимедиа</a> <span class="divider">/</span></li>
            
        
        
            <li>[РЕШЕНО] ALSA + JACKD (FFADO) и Steam. Непонятные проблемы. Возможно ли подружить?</li>
        
    
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    
    <div class="topic">
        <h1>[РЕШЕНО] ALSA + JACKD (FFADO) и Steam. Непонятные проблемы. Возможно ли подружить?</h1>
        
            <div class="text-center">
    



</div>

        

        

        <div class="posts">
            
            
                
                




<table class="table table-bordered post post-row
       "
       id="post-170049"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/lyghters/">
                <span class="post-username">lyghters</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/170049/">#</a>
            6 лет, 3 месяца назад
            
                (отредактировано
                
                    6 лет, 3 месяца назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/cd/e3/cde3e9dd31df24478984b09acbca3357.png" alt="lyghters avatar" />
    
</div>

            <div>
                Темы:
                <a href="/forum/users/lyghters/topics/">
                    4
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/lyghters/posts/">
                    40
                </a>
            </div>
            <div>
                Участник с: 01 июня 2016
            </div>
            
        </td>
        <td class="post-content">
            Всем доброго времени суток.<br />Проблема довольно обширная, сам я нуб и лишь осваиваю как арч так и линукс в целом, и у меня уже пухнет голова от целого дня, проведенного в попытках данную проблему решить, так что пардоньте меня за тафтологию либо за упущение какой-либо информации. Заранее благодарю тех, кому под силу окажется прочитать сии мемуары.<br /><br />В общем я довольно долгое время пытался завести Focusrite Saffire Pro 14 на арче.<br />На днях мне это удалось, да так, что уже и не понятно, в чем были проблемы изначально. Работает все это дело через jackd (qjackctl) по firewire в реалтайме, с поднятым ffado-dbus-server.<br />Звук работает без проблем, за некоторыми исключениями.<br />В плеерах, браузерах и, к примеру, в Xonotic звук работает. В том же Warsow, чтобы накрутить звук, пришлось снести pulseaudio (в котором я и не нуждаюсь). И тут я подумал, что наконец решил все проблемы, пока не открыл Steam.<br />Имею в виду я линуксовский стим, ни о каких вайнах речи не идет. Насколько мне известно стим дружит только с pulseaudio. Во всяком случае со звуком в нем у меня действительно проблемы. В самом клиенте стима никакие звуки не функционируют, ровно как и в играх. В каких-то случаях помогает прописать в параметрах запуска<br /><pre><code>LD_LIBRARY_PATH=&quot;/usr/lib:$LD_LIBRARY_PATH&quot; %command%</code></pre>в каких-то случаях звука как не было, так и нет. Пробовал я и другие варианты, найденные на просторах интернета, в том числе запуск стима следующим образом<br /><pre><code>SDL_AUDIODRIVER=alsa steam</code></pre>отдельно игры таким образом запускать я тоже пробовал.<br />В случае с игрой Eldritch в консоли я обнаружил несколько особенностей.<br />Во-первых, в ней используется libfmod, который стучится по дефолту в pulseaudio, благодаря чему успешно фэйлится.<br />Во-вторых, при SDL_AUDIODRIVER=alsa, после попыток подрубить pulseaudio он выдавал вот такое дело<br /><pre><code>Cannot open shared library /usr/lib32/alsa-lib/libasound_module_pcm_jack.so</code></pre>В обоих случаях игра функционировала нормально, без звука разумеется.<br />Сам же libasound_module_pcm_jack.so находился на своем месте, я даже перенакатывал lib32-alsa-plugins и alsa-plugins по несколько раз.<br />В процессе танцев с бубном эта ошибка перестала появляться в консоли, и совсем не понятно, решена ли проблема (и каким образом), так как в консоли теперь ни следа об обращении к libasound_module_pcm_jack.so.<br /><br />Разумеется, далеко не факт что проблема вообще в этом. Одно я могу сказать точно - пока стим запущен, консоль jackd регулярно выдает XRUN callback&#39;и и unknown request&#39;ы, особенно при запуске игр. Вот вам &quot;вырванный из контекста&quot; консоли пример:<br /><pre><code>Cannot read socket fd = 59 err = No such file or directory
20:39:55.625 XRUN callback (1).
20:40:23.377 Смена графа соединений JACK.
20:40:23.529 Смена соединений JACK.
20:40:39.320 XRUN callback (2).
20:40:43.661 XRUN callback (3).
CheckSize error size = 1634954337 Size() = 81
CheckRead error
Unknown request 1667328557
Unknown request 1634872939
Unknown request 1667328631
Unknown request 909004907
Unknown request 774911797
Unknown request 50
CheckSize error size = -448991334 Size() = 8
CheckRead error</code></pre><br />Я перепробовал столько всего, что большая часть уже вылетела из головы.<br />Если кто-то сталкивался с подобной ситуацией или у кого-то есть идеи по данной проблеме - буду крайне рад вашей помощи.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-170066"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/lyghters/">
                <span class="post-username">lyghters</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/170066/">#</a>
            6 лет, 3 месяца назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/cd/e3/cde3e9dd31df24478984b09acbca3357.png" alt="lyghters avatar" />
    
</div>

            <div>
                Темы:
                <a href="/forum/users/lyghters/topics/">
                    4
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/lyghters/posts/">
                    40
                </a>
            </div>
            <div>
                Участник с: 01 июня 2016
            </div>
            
        </td>
        <td class="post-content">
            В общем, как я понял, проблемы именно с jackd.<br /><br />В принципе при запуске всех игр, в которых нету звука, jack орет в консоли подобные вещи:<br /><pre><code>CheckSize error size = 1634954337 Size() = 81
CheckRead error
Unknown request 1667328557
Unknown request 1634872939
Unknown request 1667328631
Unknown request 875450475
Unknown request 775369529
Unknown request 48
CheckSize error size = -373723238 Size() = 8
CheckRead error
Unknown request 3921217273
Unknown request 3921305588
Unknown request 4293736968
Unknown request 3921305588
Unknown request 108328
Unknown request 1986356271
Unknown request 1835561775
Unknown request 2095
Unknown request 256
Unknown request 4294967040
Unknown request 511
Cannot read socket fd = 53 err = No such file or directory</code></pre><br />Я уже писал об этом выше, однако я хочу сконцентрировать на этом внимание.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-170067"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/nafanja/">
                <span class="post-username">nafanja</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/170067/">#</a>
            6 лет, 3 месяца назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/8b/bf/8bbfdb897f0c37710a7d8b4dc072bea1.png" alt="nafanja avatar" />
    
</div>

            <div>
                Темы:
                <a href="/forum/users/nafanja/topics/">
                    94
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/nafanja/posts/">
                    9252
                </a>
            </div>
            <div>
                Участник с: 02 июня 2012
            </div>
            
                <div class="label label-warning">заблокирован</div>
            
        </td>
        <td class="post-content">
            как мне кажется тебе нужно подружить пульс с джеком.<br />сам же пишешь<br /><blockquote><em>lyghters</em><br>Насколько мне известно стим дружит только с pulseaudio.</blockquote>
            
                
                    <div class="post-signature">
                        <a href="https://archlinux.org.ru/forum/topic/10992/">Псевдографический инсталлятор Arch Linux ver. 3.8.2</a><br />Благодарности принимаются на ЯД <strong>410012815723874</strong>
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-170068"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/vasek/">
                <span class="post-username">vasek</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/170068/">#</a>
            6 лет, 3 месяца назад
            
                (отредактировано
                
                    6 лет, 3 месяца назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/vasek/topics/">
                    48
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/vasek/posts/">
                    11340
                </a>
            </div>
            <div>
                Участник с: 17 февраля 2013
            </div>
            
        </td>
        <td class="post-content">
            Встретился на <a href="https://bbs.archlinux.org/viewtopic.php?id=193962">BBS</a>  топик с похожей проблемой (ошибки почти один в один....) и ТС помогло решение, которое применил и ты (в части  прописки в параметрах запуска LD_LIBRARY_PATH= …. ), поэтому соглашусь с высказыванием <strong>nafanja</strong> про pulseaudio<br />Вдобавок к этому ….. еще встретилось пояснение по поводу <strong>checkSize erros</strong> -<br /><em>&quot;The checkSize erros usually happen when there&#39;s errors sending or receiving data from the JACK server.&quot;</em><br /><br /><em>PS..... для большей информативности (куда лезет, чего не хватает и.т.д. и.т.п. ) можно потрейсить (strace, sysdig) …...... может натолкнет на какие-нибудь мысли.....</em>
            
                
                    <div class="post-signature">
                        Ошибки не исчезают с опытом - они просто умнеют
                    </div>
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
                
                




<table class="table table-bordered post post-row
       "
       id="post-170076"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/lyghters/">
                <span class="post-username">lyghters</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/170076/">#</a>
            6 лет, 3 месяца назад
            
                (отредактировано
                
                    6 лет, 3 месяца назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
        <img src="https://storage.yandexcloud.net/aor-static/media/cache/cd/e3/cde3e9dd31df24478984b09acbca3357.png" alt="lyghters avatar" />
    
</div>

            <div>
                Темы:
                <a href="/forum/users/lyghters/topics/">
                    4
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/lyghters/posts/">
                    40
                </a>
            </div>
            <div>
                Участник с: 01 июня 2016
            </div>
            
        </td>
        <td class="post-content">
            Решил проблему.<br /><br />Как бы мне не хотелось, но я все же поставил себе pulseaudio.<br />Вместо qjackctl теперь использую Cadence.<br />Перед использованием удалил .asoundrc, в котором было следующее:<br /><pre><code>pcm.rawjack {
    type jack
    playback_ports {
        0 system:playback_1
        1 system:playback_2
    }
    capture_ports {
        0 system:capture_1
        1 system:capture_2
    }
}

pcm.jack {
    type plug
    slave { pcm &quot;rawjack&quot; }
    hint {
        description &quot;JACK Audio Connection Kit&quot;
    }
}

pcm.!default {
    type plug
    slave { pcm &quot;rawjack&quot; }
}</code></pre>удалил я его, так как Cadence отказывался менять настройки alsa бриджа (файл был только для чтения)<br />В cadence подключаюсь все так же по firewire<br />alsa bridge стоит ALSA &gt; PulseAudio &gt; JACK<br />pulseaudio bridge запущен и стартует по дефолту<br /><br />Отказаться от пульсы не получилось, но в данной связке все работает, так что тему можно считать закрытой.<br />Может кому-нибудь поможет. Всем спасибо.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

            
        </div>
        <div>&nbsp;</div>
        
            <div class="text-center">
    



</div>

        

        

        
            
<a href="/accounts/register/">Зарегистрироваться</a> или <a href="/accounts/login/?next=/forum/topic/16128/">войдите</a> чтобы оставить сообщение.

        

        
    </div>

        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

<script>(function(){var js = "window['__CF$cv$params']={r:'747b9df55e33169b',m:'6CHk3m98mQY7SdcotwVOyPsFc94aZz_0J1m8zOi8t80-1662681348-0-AckegjY8Ue7E2w15ZZrv5nK3cYbFn+OT4GuedovTIzMdgQkkC0ovr8Y+sJX4x1ccXAzBvBN2vZY70vLcYObwMH4jHrAs0mupI5gshqF442qmaYhIU7um7ULJy+JNlGgDmAZKfvqqEgOdR0sUmTPClnI=',s:[0x168fec310e,0x4280471ed0],u:'/cdn-cgi/challenge-platform/h/g'};var now=Date.now()/1000,offset=14400,ts=''+(Math.floor(now)-Math.floor(now%offset)),_cpo=document.createElement('script');_cpo.nonce='',_cpo.src='/cdn-cgi/challenge-platform/h/g/scripts/alpha/invisible.js?ts='+ts,document.getElementsByTagName('head')[0].appendChild(_cpo);";var _0xh = document.createElement('iframe');_0xh.height = 1;_0xh.width = 1;_0xh.style.position = 'absolute';_0xh.style.top = 0;_0xh.style.left = 0;_0xh.style.border = 'none';_0xh.style.visibility = 'hidden';document.body.appendChild(_0xh);function handler() {var _0xi = _0xh.contentDocument || _0xh.contentWindow.document;if (_0xi) {var _0xj = _0xi.createElement('script');_0xj.nonce = '';_0xj.innerHTML = js;_0xi.getElementsByTagName('head')[0].appendChild(_0xj);}}if (document.readyState !== 'loading') {handler();} else if (window.addEventListener) {document.addEventListener('DOMContentLoaded', handler);} else {var prev = document.onreadystatechange || function () {};document.onreadystatechange = function (e) {prev(e);if (document.readyState !== 'loading') {document.onreadystatechange = prev;handler();}};}})();</script></body>
</html>
