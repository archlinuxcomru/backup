


<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Andy_Vetrov Сообщения
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://archlinuxcomru.github.io/backup/src/css/bootstrap.css">
    
    
    <script type="text/javascript" src="https://archlinuxcomru.github.io/backup/src/js/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://archlinuxcomru.github.io/backup/src/js/bootstrap.js"></script>
    <script type="text/javascript" src="https://archlinuxcomru.github.io/backup/src/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/posts/" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/topics/" title="Последние темы на форуме" >

    
</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="/">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="/news/">Новости</a></li>
    <li class="active"><a href="/forum/">Форум</a></li>
    <li class=""><a href="/blogs/">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_%28%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9%29">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="/irc/#chat">IRC</a></li>
      <li class="dropdown">
        <a href="/accounts/login/" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="/accounts/login/">Вход</a></li>
          <li><a href="/accounts/register/">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="/messages/inbox/" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="/">ArchLinux.org.ru</a></li>


    <li><a href="/forum/">Начало</a> <span class="divider">/</span></li>
    
    
        <li>Сообщения</li>
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    <div class="posts">
        
            




<table class="table table-bordered post post-row
       "
       id="post-214183"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/Andy_Vetrov/">
                <span class="post-username">Andy_Vetrov</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/214183/">#</a>
            3 года, 6 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/Andy_Vetrov/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/Andy_Vetrov/posts/">
                    27
                </a>
            </div>
            <div>
                Участник с: 09 февраля 2019
            </div>
            
        </td>
        <td class="post-content">
            2 <strong>anode</strong>: Понимаете в чем странность ситуации - в Arch&#39;е есть как пакеты собранные с более-менее нормальной (IMHO) разбивкой на части - например тот же <a href="https://www.archlinux.org/packages/core/x86_64/linux/">Linux Kernel</a> - отдельно мухи, отдельно котлеты, отдельно вишенки, можно сказать даже с практически нормальными настройками (за исключением разве что <a href="https://github.com/systemd/systemd/commit/edda44605f06a41fb86b7ab8128dcf99161d2344">этого странноватого workaround&#39;а</a> :D) или <a href="https://www.archlinux.org/packages/core/x86_64/dbus/">dbus</a>, а есть тот же <a href="https://www.archlinux.org/packages/extra/x86_64/gtk3/">gtk3</a>, в котором все запихнуто в одну кучу. Особую пикантность ситуации придает тот факт что все три пакета собраны Jan&#39;ом Steffens&#39;оном ;) Оно конечно понятно, что это опенсорс, детка, и здесь тебе никто ничего не должен, но списать разницу в организации пакетов на различия в менталитете в данном случае не получится :D<br />P.S. Честно говоря не представляю как грамотно автоматически подтягивать зависимости ядрёных модулей, если они ставятся отдельными пакетами. Как установщик сам может решить  что нужно юзеру?
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-214012"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/Andy_Vetrov/">
                <span class="post-username">Andy_Vetrov</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/214012/">#</a>
            3 года, 6 месяцев назад
            
                (отредактировано
                
                    3 года, 6 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/Andy_Vetrov/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/Andy_Vetrov/posts/">
                    27
                </a>
            </div>
            <div>
                Участник с: 09 февраля 2019
            </div>
            
        </td>
        <td class="post-content">
            Небольшое дополнение для тех, кто хочет подчистить систему от не сильно нужных пакетов. Связано с Cinnamon не совсем напрямую, но все же. Как известно Cinnamon требует установки оконного менеджера Muffin, у которого в зависимостях стоит zenity, который в свою очередь hardlinked с пакетом webkit2gtk, который по-бОльшему-то счету ни Muffin&#39;у ни Cinnamon&#39;у - не нужен, да и вообще не много кому требуется, хотя отжирает ни много ни мало - 127 МБ.  В соответствующее время сакральный вопрос &quot;а нафига?&quot; <a href="https://bugs.archlinux.org/task/50548">даже задавался Jan de Groot&#39;у</a>, но ответил: &quot;не нравится - сами выпиливайте&quot;. Ну мы - люди не гордые, выпилили: <a href="https://aur.archlinux.org/packages/zenity-git">https://aur.archlinux.org/packages/zenity-git</a><br /><br />P.S. Млин, сколько же барахла понапихано в стандартные Arch Linux&#39;овые пакеты - и заголовки, и документация и еще чёрт знает чё. Апофеозом на мой взгляд является linux-firmware, приближающийся вплотную к половине гига и имеющий в своем составе прошивки для железа, 99% которого являются махровой экзотикой. В этом отношении подход Debian&#39;овцев, разбивающих данный пакет по производителям, явно более здравый.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-213855"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/Andy_Vetrov/">
                <span class="post-username">Andy_Vetrov</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/213855/">#</a>
            3 года, 6 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/Andy_Vetrov/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/Andy_Vetrov/posts/">
                    27
                </a>
            </div>
            <div>
                Участник с: 09 февраля 2019
            </div>
            
        </td>
        <td class="post-content">
            Для упрощения установки закинул в AUR:<br /><br /><a href="https://aur.archlinux.org/packages/cinnamon-control-center-slim/">https://aur.archlinux.org/packages/cinnamon-control-center-slim/</a><br /><a href="https://aur.archlinux.org/packages/cinnamon-slim/">https://aur.archlinux.org/packages/cinnamon-slim/</a>
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-213841"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/Andy_Vetrov/">
                <span class="post-username">Andy_Vetrov</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/213841/">#</a>
            3 года, 6 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/Andy_Vetrov/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/Andy_Vetrov/posts/">
                    27
                </a>
            </div>
            <div>
                Участник с: 09 февраля 2019
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>Aivar</em><br>Зачем???</blockquote><br />Мне проще разбивать работу на этапы, дабы если возникнет проблема было проще определить, на каком шаге она проявилась. А так да, всё это можно сделать одной транзакцией.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-213840"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/Andy_Vetrov/">
                <span class="post-username">Andy_Vetrov</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/213840/">#</a>
            3 года, 6 месяцев назад
            
                (отредактировано
                
                    3 года, 6 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/Andy_Vetrov/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/Andy_Vetrov/posts/">
                    27
                </a>
            </div>
            <div>
                Участник с: 09 февраля 2019
            </div>
            
        </td>
        <td class="post-content">
            Тэээкс. Как выяснилось гвозди, которыми прибит <em>NetworkManager</em> к <em>Cinnamon&#39;у</em> не такие уж и длинные ;-) Первоначальное решение также имеет право на жизнь, т.к. оно позволяет остаться на официальном канале обновлений, если же кто хочет выжечь NM из системы калёным железом - я сейчас покажу как,  однако в этом случае придется пересобирать пакеты <em>cinnamon</em> и <em>cinnamon-control-center</em> каждый раз самостоятельно при обновлении версий исходников (благо они не такие уж и объемные).<br /><br />Исходные данные - те же:<br />Cinnamon 4.09<br />Cinnamon-control-center 4.01<br />NetworkManager (уже убит и не шевелится), вместо него - <a href="https://wiki.archlinux.org/index.php/list_of_applications#Network_managers">любой по вкусу</a><br /><br />Итак, создаем пустую директорию <em>cinnamon</em>. В нее складываем все файлы для этого пакета, взятые с <a href="https://git.archlinux.org/svntogit/community.git/tree/trunk?h=packages/cinnamon">официального сайта Arch Linux</a>, за исключением файла PKGBUILD. Он у нас будет свой, вот такой:<br /><br /><pre><code>
pkgname=cinnamon-slim
pkgver=4.0.9
pkgrel=1
pkgdesc=&quot;Innovative Linux desktop. Slim version.&quot;
arch=(&#39;x86_64&#39;)
url=&quot;<a href="https://github.com/linuxmint/Cinnamon">https://github.com/linuxmint/Cinnamon</a>&quot;
license=(&#39;GPL2&#39;)
provides=(&quot;cinnamon=$pkgver&quot;)
conflicts=(&#39;cinnamon&#39;)
replaces=(&#39;cinnamon&#39;)
depends=(&#39;accountsservice&#39; &#39;caribou&#39; &#39;cinnamon-control-center&#39; &#39;cinnamon-menus&#39; &#39;cinnamon-screensaver&#39;
         &#39;cinnamon-session&#39; &#39;cinnamon-settings-daemon&#39; &#39;cjs&#39; &#39;gnome-backgrounds&#39; &#39;gnome-themes-extra&#39;
         &#39;gstreamer&#39; &#39;libgnomekbd&#39; &#39;libkeybinder3&#39; &#39;librsvg&#39; &#39;muffin&#39; &#39;nemo&#39; &#39;polkit-gnome&#39;
         &#39;python-cairo&#39; &#39;python-dbus&#39; &#39;python-gobject&#39; &#39;python-pam&#39; &#39;python-pexpect&#39; &#39;python-pillow&#39;
         &#39;python-pyinotify&#39; &#39;xapps&#39;)
optdepends=(&#39;blueberry: Bluetooth support&#39;
            &#39;cinnamon-translations: i18n&#39;
            &#39;gnome-panel: fallback mode&#39;
            &#39;metacity: fallback mode&#39;
            &#39;system-config-printer: printer settings&#39;)
makedepends=(&#39;intltool&#39; &#39;gtk-doc&#39; &#39;gobject-introspection&#39;)
options=(&#39;!emptydirs&#39;)
source=(&quot;${pkgname%-*}-${pkgver}.tar.gz::${url}/archive/${pkgver}.tar.gz&quot;
        &#39;0001-cinnamon-settings-don-t-rely-on-the-presence-of-cinn.patch&#39;
        &#39;set_wheel.patch&#39;
        &#39;default-theme.patch&#39;
        &#39;remove-networkmanager.patch&#39;)

sha512sums=(&#39;SKIP&#39; &#39;SKIP&#39; &#39;SKIP&#39; &#39;SKIP&#39; &#39;SKIP&#39;)

prepare() {
    cd &quot;${srcdir}&quot;/Cinnamon-${pkgver}

    # Remove NetworkManager
    # This patch must be applied before adding polkit agent to required components
    patch -Np1 -i ../remove-networkmanager.patch
    rm -rf &quot;${srcdir}/Cinnamon-${pkgver}/files/usr/share/cinnamon/applets/<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="117f7465667e637a5172787f7f707c7e7f3f7e6376">[email&#160;protected]</a>&quot;

    # Check for the cc-panel module path, not for the irrelevant binary
    # <a href="https://github.com/linuxmint/Cinnamon/pull/7382">https://github.com/linuxmint/Cinnamon/pull/7382</a>
    patch -p1 -i ../0001-cinnamon-settings-don-t-rely-on-the-presence-of-cinn.patch

    # Use wheel group instread of sudo (taken from Fedora)
    patch -Np1 -i ../set_wheel.patch

    # Set default theme to &#39;cinnamon&#39;
    patch -Np1 -i ../default-theme.patch

    # Replace MintInstall with GNOME Software
    sed -i &#39;s/mintinstall.desktop/org.gnome.Software.desktop/&#39; data/org.cinnamon.gschema.xml.in

    # Add polkit agent to required components
    sed -i &#39;s/RequiredComponents=\(.*\)$/RequiredComponents=\1polkit-gnome-authentication-agent-1;/&#39; \
        files/usr/share/cinnamon-session/sessions/cinnamon*.session

    # <a href="https://github.com/linuxmint/Cinnamon/issues/3575#issuecomment-374887122">https://github.com/linuxmint/Cinnamon/issues/3575#issuecomment-374887122</a>
    # Cinnamon has no upstream backgrounds, use GNOME backgrounds instead
    sed -i &#39;s|/usr/share/cinnamon-background-properties|/usr/share/gnome-background-properties|&#39; \
        files/usr/share/cinnamon/cinnamon-settings/modules/cs_backgrounds.py

    NOCONFIGURE=1 ./autogen.sh
}

build() {
    cd &quot;${srcdir}&quot;/Cinnamon-${pkgver}

    ./configure --prefix=/usr \
                --sysconfdir=/etc \
                --libexecdir=/usr/lib/cinnamon \
                --localstatedir=/var \
                --disable-static \
                --disable-gtk-doc \
                --disable-schemas-compile \
                --enable-compile-warnings=yes

    # <a href="https://bugzilla.gnome.org/show_bug.cgi?id=656231">https://bugzilla.gnome.org/show_bug.cgi?id=656231</a>
    sed -i -e &#39;s/ -shared / -Wl,-O1,--as-needed\0/g&#39; libtool

  make
}
package() {
    cd &quot;${srcdir}&quot;/Cinnamon-${pkgver}

  make DESTDIR=&quot;${pkgdir}&quot; install
}
</code></pre><br />И рядом в эту же директорию кладем файл <em>remove-networkmanager.patch</em>:<br /><br /><pre><code>
--- a/js/ui/statusIconDispatcher.js
+++ b/js/ui/statusIconDispatcher.js
@@ -12,7 +12,6 @@
     &#39;gnome-volume-control-applet&#39;: &#39;volume&#39;, // renamed to gnome-sound-applet
                                              // when moved to control center
     &#39;gnome-sound-applet&#39;: &#39;volume&#39;,
-    &#39;nm-applet&#39;: &#39;network&#39;,
     &#39;gnome-power-manager&#39;: &#39;battery&#39;,
     &#39;keyboard&#39;: &#39;keyboard&#39;,
     &#39;a11y-keyboard&#39;: &#39;a11y&#39;,
--- a/src/Makefile.am
+++ b/src/Makefile.am
@@ -239,7 +239,7 @@
 libcinnamon_la_CPPFLAGS = $(MUFFIN_CFLAGS) $(cinnamon_cflags)

 Cinnamon-0.1.gir: libcinnamon.la St-1.0.gir
-Cinnamon_0_1_gir_INCLUDES = Clutter-0 ClutterX11-0 CoglPango-0 Cogl-0 Meta-Muffin.0 Soup-2.4 CMenu-3.0 NM-1.0
+Cinnamon_0_1_gir_INCLUDES = Clutter-0 ClutterX11-0 CoglPango-0 Cogl-0 Meta-Muffin.0 Soup-2.4 CMenu-3.0
 Cinnamon_0_1_gir_CFLAGS = $(libcinnamon_la_CPPFLAGS) -I $(srcdir)
 Cinnamon_0_1_gir_LIBS = libcinnamon.la
 Cinnamon_0_1_gir_FILES = $(libcinnamon_la_gir_sources)
--- a/configure.ac
+++ b/configure.ac
@@ -81,7 +81,7 @@
                                libstartup-notification-1.0 &gt;= $STARTUP_NOTIFICATION_MIN_VERSION
                                gobject-introspection-1.0 &gt;= $GOBJECT_INTROSPECTION_MIN_VERSION
                                polkit-agent-1 &gt;= $POLKIT_MIN_VERSION xfixes
-                               libnm atk-bridge-2.0)
+                               atk-bridge-2.0)

 PKG_CHECK_MODULES(CINNAMON_PERF_HELPER, gtk+-3.0 gio-2.0)
--- a/files/usr/share/cinnamon-session/sessions/cinnamon.session
+++ b/files/usr/share/cinnamon-session/sessions/cinnamon.session
@@ -1,6 +1,6 @@
 [Cinnamon Session]
 Name=Cinnamon
-RequiredComponents=cinnamon;cinnamon-screensaver;nemo-autostart;nm-applet;cinnamon-killer-daemon;
+RequiredComponents=cinnamon;cinnamon-screensaver;nemo-autostart;cinnamon-killer-daemon;
 DesktopName=X-Cinnamon
--- a/files/usr/share/cinnamon-session/sessions/cinnamon2d.session
+++ b/files/usr/share/cinnamon-session/sessions/cinnamon2d.session
@@ -1,6 +1,6 @@
 [Cinnamon Session]
 Name=Cinnamon (Software Rendering)
-RequiredComponents=cinnamon2d;cinnamon-screensaver;nemo-autostart;nm-applet;cinnamon-killer-daemon;
+RequiredComponents=cinnamon2d;cinnamon-screensaver;nemo-autostart;cinnamon-killer-daemon;
 DesktopName=X-Cinnamon
</code></pre><br />Дальше, как обычно, $ makepkg -s<br /><br />Однако кроме этого нам необходимо пересобрать cinnamon-control-center. Клемент Лефевр, как выяснилось, внял людским просьбам и добавил в него штатную возможность отключения <em>Network-</em> и <em>ModemManager</em>&#39;ов! Для этого необходимо в секцию <em>build</em> <a href="https://git.archlinux.org/svntogit/community.git/plain/trunk/PKGBUILD?h=packages/cinnamon-control-center">официального PKGBUILD&#39;а</a> добавить:<br /><br /><pre><code>
                --disable-networkmanager \
                --disable-modemmanager \
</code></pre><br />и, естественно, в секции <em>depends</em> удалить ставшие уже ненужными зависимости:<br /><br /><pre><code>
&#39;libmm-glib&#39; &#39;nm-connection-editor&#39;
</code></pre><br />после чего собрать обновленный пакет <em>cinnamon-control-center</em> (для удобства - лучше с другим именем, но тут for who how ;-))<br /><br />После всех вышеприведенных манипуляций Cinnamon начинает вести себя как любое приличное DE и перестает считать что какие-то нелепые NM являются уж совсем обязательной зависимостью ;-)<br /><br />Наверное стоит закинуть в AUR - ежели кому не лениво. Возможно сам сделаю чуть попозжее.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-213635"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/Andy_Vetrov/">
                <span class="post-username">Andy_Vetrov</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/213635/">#</a>
            3 года, 7 месяцев назад
            
                (отредактировано
                
                    3 года, 7 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/Andy_Vetrov/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/Andy_Vetrov/posts/">
                    27
                </a>
            </div>
            <div>
                Участник с: 09 февраля 2019
            </div>
            
        </td>
        <td class="post-content">
            1. К сожалению именно к Cinnamon&#39;у NetworkManager прибит гвоздями и штатным образом его снести не получится - снесется и DE. Поэтому-то и пришлось городить огород.<br />2. Кроме непосредственно самого NM там еще куча барахла в зависимостях - в сумме получается чуть ли не на порядок больше занятого места. А так - я не вижу смысла держать у себя установленными пакеты, которыми я не пользуюсь.<br /><br />P.S. @Moderator, похоже я ошибся с разделом. Переместите, пожалуйста, тему в <a href="https://archlinux.org.ru/forum/forum/20/">GNOME 3 &amp; Cinnamon</a> - там для нее похоже более подходящее место.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-213631"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/Andy_Vetrov/">
                <span class="post-username">Andy_Vetrov</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/213631/">#</a>
            3 года, 7 месяцев назад
            
                (отредактировано
                
                    3 года, 6 месяцев назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/Andy_Vetrov/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/Andy_Vetrov/posts/">
                    27
                </a>
            </div>
            <div>
                Участник с: 09 февраля 2019
            </div>
            
        </td>
        <td class="post-content">
            Небольшое руководство для тех, кто хочет полностью удалить NetworkManager из Arch Linux, но продолжить пользоваться Cinnamon&#39;ом. Как известно, NM является обязательной зависимостью для Cinnamon&#39;а и по этой причине отдельно не удаляется, но, при определенном желании это ограничение вполне можно обойти.<br /><br />Начальные условия:<br />Arch Linux (канал обновления - stable) up2date<br />Cinnamon 4.0.9<br />NetworkManager 1.14.5<br />ConnMan 1.36 (переходить будем на него, но, в принципе, может быть и wicd или systemd-networkd)<br />connman-git 1.1.1<br /><br />1. Устанавливаем пакет connman из официального репозитория Arch Linux и пакет connman-git из AUR (по желанию).<br /><br />2. Переключаемся с NetworkManager&#39;а на ConnMan:<br /><br />$ sudo systemctl stop NetworkManager.service &amp;&amp; sudo systemctl disable NetworkManager.service<br />$ sudo systemctl enable connman.service &amp;&amp; sudo systemctl start connman.service<br /><br />Перезагружаемся.<br /><br />3. После перезагрузки можно <a href="https://wiki.archlinux.org/index.php/Cinnamon#Disable_the_NetworkManager_applet">ограничиться отключением автозагрузки network-manager-applet</a> и на этом успокоиться, но наша цель - полностью удалить NM из системы. Для этого нам придется создать пакет-заглушку, который заменит собой все компоненты NetworkManager&#39;а.<br /><br />4. Создаем директорию networkmanager-dummy<br /><br />5. Копируем в нее файл /usr/lib/girepository-1.0/NM-1.0.typelib (это один из двух файлов, требующихся для обмана Cinnamon. Второй файл мы создадим непосредственно в самом PKGBUILD)<br /><br />6. Создаем в директории networkmanager-dummy файл PKGBUILD со следующим содержимым:<br /><br /><pre><code>
pkgname=networkmanager-dummy
pkgver=0.0.1
pkgrel=1
pkgdesc=&quot;Something to trick Cinnamon into thinking it has NetworkManager package installed&quot;
url=&quot;<a href="http://127.0.0.1">http://127.0.0.1</a>&quot;
arch=(&#39;any&#39;)
license=(&#39;GPL&#39;)
depends=()
optdepends=()
makedepends=()
replaces=()
conflicts=(&#39;networkmanager&#39; &#39;network-manager-applet&#39; &#39;nm-connection-editor&#39; &#39;libnm-glib&#39; &#39;libmm-glib&#39; &#39;libnma&#39; &#39;libnm&#39;)
provides=(&#39;networkmanager&#39; &#39;network-manager-applet&#39; &#39;nm-connection-editor&#39; &#39;libnm-glib&#39; &#39;libmm-glib&#39; &#39;libnma&#39; &#39;libnm&#39;)
source=(&#39;NM-1.0.typelib&#39;)
md5sums=(&#39;SKIP&#39;)

build() {
   echo &quot;Nothing to build&quot;
}

package() {
   install -Dm644 ../NM-1.0.typelib &quot;${pkgdir}/usr/lib/girepository-1.0/NM-1.0.typelib&quot;
   install -Dm644 /dev/stdin &quot;${pkgdir}/usr/share/applications/nm-applet.desktop&quot; &lt;&lt;END
[Desktop Entry]
Name=Network
Comment=Manage your network connections
Icon=nm-device-wireless
Exec=nm-applet
Terminal=false
Type=Application
NoDisplay=true
NotShowIn=KDE;GNOME;
X-GNOME-Bugzilla-Bugzilla=GNOME
X-GNOME-Bugzilla-Product=NetworkManager
X-GNOME-Bugzilla-Component=nm-applet
X-GNOME-UsesNotifications=true
END

}
</code></pre><br />7. Собираем наш пакет-заглушку:<br /><br />$ cd networkmanager-dummy<br />$ makepkg<br /><br />8. Устанавливаем свежесобранный пакет networkmanager-dummy-0.0.1-1-any.pkg.tar.xz, перезагружаемся, дочищаем наш Arch Linux от orphan&#39;ов.<br /><br />9. Наводим косметику: в стартовом меню Cinnamon Настройка -&gt; Меню -&gt; Открыть редактор меню -&gt; Параметры отключаем отображение пунктов &quot;Сетевые соединения&quot; и &quot;Сеть&quot; и переименовываем &quot;Connman Setting&quot; в &quot;Сетевые настройки&quot;. Также можно удалить апплет NM для панели задач:<br /><br />$ sudo rm -rf /usr/share/cinnamon/applets/<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="bbd5decfccd4c9d0fbd8d2d5d5dad6d4d595d4c9dc">[email&#160;protected]</a><br /><br />однако после этого при следующем обновлении Cinnamon ругнется на отсутствующие файлы.<br /><br />В общем где-то так. На все про все - не более 10 минут. Проверено на 4-х домашних машинах.<br /><br />P.S. В <a href="https://archlinux.org.ru/forum/topic/19040/?page=2#post-213840">сообщении на второй странице данной темы</a> приведен рецепт по сборке пакетов <em>cinnamon-slim</em> и <em>cinnamon-control-center-slim</em> с полностью удаленными зависимостями от NetworkManager. Также данные пакеты доступны в AUR.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
    </div>
    <div>&nbsp;</div>
    
        <div class="text-center">
    


    <nav>
        <ul class="pagination">
            
                <li class="previous">
                    <a href="?page=2" aria-label="предыдущая страница">
                        <span aria-hidden="true">&laquo;</span>
                        <span class="hidden-xs">предыдущая страница</span>
                    </a>
                </li>
            

            
                
                    
                        <li>
                            <a href="?page=1">1</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="?page=2">2</a>
                        </li>
                    
                
            
                
                    
                        <li class="active">
                            <a href="?page=3">3 <span class="sr-only">(текущая страница)</span></a>
                        </li>
                    
                
            

            
                <li class="next disabled">
                    <span>
                        <span class="hidden-xs">следующая страница</span>
                        <span aria-hidden="true">&raquo;</span>
                    </span>
                </li>
            
        </ul>
    </nav>


</div>

    


        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>(function(){var js = "window['__CF$cv$params']={r:'747ab1844e6e9d4c',m:'fo0PzcFIFLhviRxe_dK9.8opZ21RY.P1db86NCclp2c-1662671663-0-Aafw8VX88owdRWSC04zreVda2831Nz0VUpsGL9w9rjCZ+Vlp0Z7oJMKonpUS+gUjgxJHmCqQu0G976O1ERriRlWSod/aIf0MaomEDzq3W9rqKnz4YQwpYLz+Wjfe6OI/mlCe8Uc3qrREyWQQxyjSIxks0IFbnsdyk8P7VzGbY/wN',s:[0x70164b8a03,0x2439fc3fb9],u:'/cdn-cgi/challenge-platform/h/g'};var now=Date.now()/1000,offset=14400,ts=''+(Math.floor(now)-Math.floor(now%offset)),_cpo=document.createElement('script');_cpo.nonce='',_cpo.src='/cdn-cgi/challenge-platform/h/g/scripts/alpha/invisible.js?ts='+ts,document.getElementsByTagName('head')[0].appendChild(_cpo);";var _0xh = document.createElement('iframe');_0xh.height = 1;_0xh.width = 1;_0xh.style.position = 'absolute';_0xh.style.top = 0;_0xh.style.left = 0;_0xh.style.border = 'none';_0xh.style.visibility = 'hidden';document.body.appendChild(_0xh);function handler() {var _0xi = _0xh.contentDocument || _0xh.contentWindow.document;if (_0xi) {var _0xj = _0xi.createElement('script');_0xj.nonce = '';_0xj.innerHTML = js;_0xi.getElementsByTagName('head')[0].appendChild(_0xj);}}if (document.readyState !== 'loading') {handler();} else if (window.addEventListener) {document.addEventListener('DOMContentLoaded', handler);} else {var prev = document.onreadystatechange || function () {};document.onreadystatechange = function (e) {prev(e);if (document.readyState !== 'loading') {document.onreadystatechange = prev;handler();}};}})();</script></body>
</html>
