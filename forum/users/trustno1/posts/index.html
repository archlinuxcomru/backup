


<!DOCTYPE html>
<html lang="ru">

<!-- Mirrored from archlinux.org.ru/forum/users/trustno1/posts/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 09:00:54 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        trustno1 Сообщения
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://storage.yandexcloud.net/aor-static/static/css/default.css">
    
    
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="../../../feeds/posts/index.html" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="../../../feeds/topics/index.html" title="Последние темы на форуме" >

    
</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="../../../../index.html">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="../../../../news/index.html">Новости</a></li>
    <li class="active"><a href="../../../index.html">Форум</a></li>
    <li class=""><a href="../../../../blogs/index.html">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_(Русский)">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="../../../../irc/index.html#chat">IRC</a></li>
      <li class="dropdown">
        <a href="../../../../accounts/login/index.html" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="../../../../accounts/login/index.html">Вход</a></li>
          <li><a href="../../../../accounts/register/index.html">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="../../../../messages/inbox/index.html" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="../../../../index.html">ArchLinux.org.ru</a></li>


    <li><a href="../../../index.html">Начало</a> <span class="divider">/</span></li>
    
    
        <li>Сообщения</li>
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    <div class="posts">
        
            




<table class="table table-bordered post post-row
       "
       id="post-67112"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../index.html">
                <span class="post-username">trustno1</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../../post/67112/index.html">#</a>
            11 лет, 7 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../topics/index.html">
                    0
                </a>
            </div>
            <div>
                Сообщения:
                <a href="index.html">
                    2
                </a>
            </div>
            <div>
                Участник с: 11 января 2011
            </div>
            
        </td>
        <td class="post-content">
            <blockquote>По делу: почему не используете xl2tpd?<br/>Ладно. <br/>Не понял, почему в скрипте дважды openl2tp stop через sleep 4?<br/>Почему просто не</blockquote><strong>bobart</strong><br/>Всё просто, xl2tpd не завелся сразу после изменений со стороны провайдера, хотя всё делалось как всегда. Потом спустя какое то был настроен openl2td, скорость выше, все работает терпимо. Udpxy это замена igmproxy по сути, работает иначе, но смысл тот же - прием и раздача IPTV в локальную сеть.<br/>Эти sleep потому что оно не выгружается как надо, иногда нужно сделать повторный stop.<br/>Возможности? Перейти на что еще? - сколько угодно в моем регионе, но пока работает, будут еще проблемы можно будет подумать и потом не думаю что при переходе не возникнет других проблем на другом провайдере(у другого провайдера). <br/>Не похоже на то чтобы <strong>PoZiTPoH</strong> горел желанием помочь, вы долго правили скрипт и поэтому была надежда что смогли бы немного допилить его.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-67109"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../index.html">
                <span class="post-username">trustno1</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../../post/67109/index.html">#</a>
            11 лет, 7 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../topics/index.html">
                    0
                </a>
            </div>
            <div>
                Сообщения:
                <a href="index.html">
                    2
                </a>
            </div>
            <div>
                Участник с: 11 января 2011
            </div>
            
        </td>
        <td class="post-content">
            <strong>bobart</strong><br/>Благодарю за скрипт.<br/><div class="code"><pre>#!/bin/sh
INETFILE=~/.conncheck.corbina.log
ping -c 4 -w 10 <a href="http://tp.corbina.net/">tp.corbina.net</a> &amp;&gt; /dev/null || /etc/rc.d/network restart &amp;&amp; 
ping -c4 <a href="https://google.com/">google.com</a> &amp;&gt; /dev/null
if [ $? -eq 0 ];then
   echo "[`date`] [TP.CORBINA.NET] available, [GOOGLE.RU] available" &gt;&gt; $INETFILE 
   exit 0
else
   echo "[`date`] [GOOGLE.RU] not available, try again (after NETWORK daemon restart)" &gt;&gt; $INETFILE
   /etc/rc.d/openl2tp stop
   sleep 4
   /etc/rc.d/openl2tp stop
   sleep 1
   /etc/rc.d/openl2tp start
   sleep 15
   /etc/rc.d/udpxy restart
   sleep 1
   ping -c4 <a href="https://google.com/">google.com</a> &amp;&gt; /dev/null
   if [ $? -eq 0 ];then
       echo "[`date`] [TP.CORBINA.NET] available, [GOOGLE.RU] available" &gt;&gt; $INETFILE
       exit 0
   else
       echo "[`date`] [TP.CORBINA.NET] not available, [GOOGLE.RU] not available, try letter" &gt;&gt; $INETFILE
       exit 0
   fi
fi</pre></div>На данный момент наблюдаю следующую картину, если openl2tp отваливается то восстановить соединение не представляется возможным некоторое время, похоже на проблему провайдера (у меня билайно-корбина), приходиться поднимать vpn сессию. Можете ли вы помочь корректно добавить в приведенное выше нечто вроде - если после переподнятия openl2tp и ожидания в 15 секунд соединения всё еще нет то sudo pon provider. ? Потому что получается так: он пингует хост, ответа нет, перезапускает всю сеть, перезапускает демон openl2tpd и умолкает на этом, а соединения по прежнему нет, т.е дальнейших попыток не следует.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
    </div>
    <div>&nbsp;</div>
    
        <div class="text-center">
    



</div>

    


        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

<script>(function(){var js = "window['__CF$cv$params']={r:'745ed08b0a901616',m:'sdE3nCF.xrJfrKhtno66F4hjhULbT0.vGJ0zoFQwr4Q-1662379332-0-AW2CDYsUfgRtpSF3/AH29E42R2xIcDUoRhbqMTOVY56P/abAVYRQVuw+coADTO7vJFC887RXD9zHJhCCXBDYwsiZT9Ox2p/KpnRakIFdKh1F5eTc1Cl453Tp6Amd52NB/Wk8btr3nEBzMlqA4X+CJDc=',s:[0x284358718f,0x3f579cae02],u:'/cdn-cgi/challenge-platform/h/g'};var now=Date.now()/1000,offset=14400,ts=''+(Math.floor(now)-Math.floor(now%offset)),_cpo=document.createElement('script');_cpo.nonce='',_cpo.src='../../../../cdn-cgi/challenge-platform/h/g/scripts/alpha/invisible5615.js?ts='+ts,document.getElementsByTagName('head')[0].appendChild(_cpo);";var _0xh = document.createElement('iframe');_0xh.height = 1;_0xh.width = 1;_0xh.style.position = 'absolute';_0xh.style.top = 0;_0xh.style.left = 0;_0xh.style.border = 'none';_0xh.style.visibility = 'hidden';document.body.appendChild(_0xh);function handler() {var _0xi = _0xh.contentDocument || _0xh.contentWindow.document;if (_0xi) {var _0xj = _0xi.createElement('script');_0xj.nonce = '';_0xj.innerHTML = js;_0xi.getElementsByTagName('head')[0].appendChild(_0xj);}}if (document.readyState !== 'loading') {handler();} else if (window.addEventListener) {document.addEventListener('DOMContentLoaded', handler);} else {var prev = document.onreadystatechange || function () {};document.onreadystatechange = function (e) {prev(e);if (document.readyState !== 'loading') {document.onreadystatechange = prev;handler();}};}})();</script></body>

<!-- Mirrored from archlinux.org.ru/forum/users/trustno1/posts/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 09:00:54 GMT -->
</html>
