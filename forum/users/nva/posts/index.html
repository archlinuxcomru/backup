


<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        nva Сообщения
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://archlinuxcomru.github.io/backup/src/css/bootstrap.css">
    
    
    <script type="text/javascript" src="https://archlinuxcomru.github.io/backup/src/js/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://archlinuxcomru.github.io/backup/src/js/bootstrap.js"></script>
    <script type="text/javascript" src="https://archlinuxcomru.github.io/backup/src/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/posts/" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/topics/" title="Последние темы на форуме" >

    
</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="/">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="/news/">Новости</a></li>
    <li class="active"><a href="/forum/">Форум</a></li>
    <li class=""><a href="/blogs/">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_%28%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9%29">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="/irc/#chat">IRC</a></li>
      <li class="dropdown">
        <a href="/accounts/login/" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="/accounts/login/">Вход</a></li>
          <li><a href="/accounts/register/">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="/messages/inbox/" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="/">ArchLinux.org.ru</a></li>


    <li><a href="/forum/">Начало</a> <span class="divider">/</span></li>
    
    
        <li>Сообщения</li>
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    <div class="posts">
        
            




<table class="table table-bordered post post-row
       "
       id="post-82190"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/nva/">
                <span class="post-username">nva</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/82190/">#</a>
            13 лет, 6 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/nva/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/nva/posts/">
                    5
                </a>
            </div>
            <div>
                Участник с: 08 июля 2008
            </div>
            
        </td>
        <td class="post-content">
            Вообщем задача достаточно обыденная, надо пробросить порт со шлюза на внутрений сервер.<br/>В Iptables Правила примерно такие:<br/>*nat<br/>#input<br/>-A PREROUTING -i eth1 -d $out_ip/32 -p tcp &ndash;dport 8080 -j DNAT &ndash;to $internal_ip:8080<br/>#output<br/>-A POSTROUTING -s internal_ip/32 -p tcp -m tcp &ndash;sport 8080 -j SNAT &ndash;to out_ip:8080<br/><br/>*filter<br/>-A FORWARD -p tcp -s $out_ip &ndash;sport 8080 -j ACCEPT<br/>-A FORWARD -p tcp -d $internal_ip &ndash;dport 8080 -j ACCEPT<br/><br/>При этом не работает, подскажите что я делаю не так.<br/><br/>И в догонку как организовать логирование пакетов проходящих через iptables что бы понять какое правило не сработало.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-87944"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/nva/">
                <span class="post-username">nva</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/87944/">#</a>
            14 лет, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/nva/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/nva/posts/">
                    5
                </a>
            </div>
            <div>
                Участник с: 08 июля 2008
            </div>
            
        </td>
        <td class="post-content">
            Все заборол. Если кому интересно делается это так:<br/><ol><li>Ставится dhclient;<br/></li><li>в файл /etc/dhclient.conf прописываются примерно следующие настройки:<br/><div class="code"><pre>option rfc3442-classless-static-routes code [COLOR="Red"]249[/COLOR]  = array of unsigned integer 8;
request subnet-mask, broadcast-address, dhcp-lease-time, dhcp-message-type, dhcp-server-identifier, rfc3442-classless-static-routes;</pre></div>Прописан код 249, а не 121 как в rfc 3442 потому как провайдер не донастроил сервак. 249 это придумка мелкомягких, но опция с таким кодом аналогична той что в rfc.<br/></li><li>в файл /etc/dhclient-exit-hooks прописываются:<br/><div class="code"><pre>if [ x"$new_rfc3442_classless_static_routes" != x"" ]; then
  case $reason in BOUND|RENEW|REBIND|REBOOT)
    rfc_routes=($new_rfc3442_classless_static_routes)
    for(( i=0; i &lt; ${#rfc_routes[@]}; )); do
      net_length=${rfc_routes[$i]}
      ((i++))
      net_address=(0 0 0 0)
      for(( j=0; j &lt; $[$net_length / 8 + \
        ($net_length % 8 ? 1 : 0)]; j++, i++)); do
         net_address[$j]=${rfc_routes[$i]}
      done
      gateway=(0 0 0 0)
      for (( j=0; j &lt; 4; j++, i++ )); do
        gateway[$j]=${rfc_routes[$i]}
      done
      old_IFS="$IFS"
      IFS='.'
      if [ x"$net_length" == x"32" ]; then
        /sbin/route add -host "${net_address[*]}" gw "${gateway[*]}"
      else
        /sbin/route add -net "${net_address[*]}/$net_length" gw "${gateway[*]}"
      fi
      IFS="$old_IFS"
    done
  esac
fi</pre></div><br/>Amigo спасибо за подсказки  ;) </li></ol>
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-87943"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/nva/">
                <span class="post-username">nva</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/87943/">#</a>
            14 лет, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/nva/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/nva/posts/">
                    5
                </a>
            </div>
            <div>
                Участник с: 08 июля 2008
            </div>
            
        </td>
        <td class="post-content">
            Вообщем не получается, ставил dhclient (dhcp это сервер) прописывал конфиги реакции ноль. Даже дефолтный конфиг /etc/dhclient.conf не создается при установке через pacman
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-87941"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/nva/">
                <span class="post-username">nva</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/87941/">#</a>
            14 лет, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/nva/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/nva/posts/">
                    5
                </a>
            </div>
            <div>
                Участник с: 08 июля 2008
            </div>
            
        </td>
        <td class="post-content">
            На статьи по dhcp3 я в принципе наталкивался, но проблема в том что в arch только dhcpcd имеется. Или я не прав и можно утстановить dhcp3?
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-87939"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/nva/">
                <span class="post-username">nva</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/87939/">#</a>
            14 лет, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/nva/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/nva/posts/">
                    5
                </a>
            </div>
            <div>
                Участник с: 08 июля 2008
            </div>
            
        </td>
        <td class="post-content">
            Вообщем проблема в том что провайдер раздает маршруты для dhcp вместе с адресом, поддержка всего этого введена с 4й версии (rfc 3442 от декабря 2002 года), но под arch маршрут не получается, только адрес. Прописывать вручную нехорошо потому как адрес выдается лишь на сутки. Под фряхой видел патч на это дело. Может кто видел на линукс ? Ну или помогите как это можно сделать что бы потом не прописывать вручную периодически.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
    </div>
    <div>&nbsp;</div>
    
        <div class="text-center">
    



</div>

    


        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

<script>(function(){var js = "window['__CF$cv$params']={r:'747bc300793b1607',m:'yryDypIltnxqraEubuHFEyaRrovJw1xItgO9mhGIdgM-1662682864-0-ARTv7scaklnZiXHirDB9WVeY9OsEQ0yDYOLHlGVfN0CcSPeVHljbA1tDPnA7TvhTTu5DgNnibjYSy0yTdET1NdSiXpdue6QzlBwhJoA6PyLPUsVti/6S/f1lvA2I4/F9swk3bF8N6S9fivZjB7j2PXk=',s:[0x6a92269f48,0xdad0df6730],u:'/cdn-cgi/challenge-platform/h/g'};var now=Date.now()/1000,offset=14400,ts=''+(Math.floor(now)-Math.floor(now%offset)),_cpo=document.createElement('script');_cpo.nonce='',_cpo.src='/cdn-cgi/challenge-platform/h/g/scripts/alpha/invisible.js?ts='+ts,document.getElementsByTagName('head')[0].appendChild(_cpo);";var _0xh = document.createElement('iframe');_0xh.height = 1;_0xh.width = 1;_0xh.style.position = 'absolute';_0xh.style.top = 0;_0xh.style.left = 0;_0xh.style.border = 'none';_0xh.style.visibility = 'hidden';document.body.appendChild(_0xh);function handler() {var _0xi = _0xh.contentDocument || _0xh.contentWindow.document;if (_0xi) {var _0xj = _0xi.createElement('script');_0xj.nonce = '';_0xj.innerHTML = js;_0xi.getElementsByTagName('head')[0].appendChild(_0xj);}}if (document.readyState !== 'loading') {handler();} else if (window.addEventListener) {document.addEventListener('DOMContentLoaded', handler);} else {var prev = document.onreadystatechange || function () {};document.onreadystatechange = function (e) {prev(e);if (document.readyState !== 'loading') {document.onreadystatechange = prev;handler();}};}})();</script></body>
</html>
