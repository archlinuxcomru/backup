


<!DOCTYPE html>
<html lang="ru">

<!-- Mirrored from archlinux.org.ru/forum/users/Dobrov/posts/?page=15 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 05:54:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Dobrov Сообщения
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://storage.yandexcloud.net/aor-static/static/css/default.css">
    
    
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="../../../feeds/posts/index.html" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="../../../feeds/topics/index.html" title="Последние темы на форуме" >

    
</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="../../../../index.html">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="../../../../news/index.html">Новости</a></li>
    <li class="active"><a href="../../../index.html">Форум</a></li>
    <li class=""><a href="../../../../blogs/index.html">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_(Русский)">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="../../../../irc/index.html#chat">IRC</a></li>
      <li class="dropdown">
        <a href="../../../../accounts/login/index.html" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="../../../../accounts/login/index.html">Вход</a></li>
          <li><a href="../../../../accounts/register/index.html">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="../../../../messages/inbox/index.html" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="../../../../index.html">ArchLinux.org.ru</a></li>


    <li><a href="../../../index.html">Начало</a> <span class="divider">/</span></li>
    
    
        <li>Сообщения</li>
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    <div class="posts">
        
            




<table class="table table-bordered post post-row
       "
       id="post-209632"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../index.html">
                <span class="post-username">Dobrov</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../../post/209632/index.html">#</a>
            3 года, 11 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../topics/index.html">
                    15
                </a>
            </div>
            <div>
                Сообщения:
                <a href="index.html">
                    142
                </a>
            </div>
            <div>
                Участник с: 03 ноября 2017
            </div>
            
        </td>
        <td class="post-content">
            <strong>mpv</strong>, горячие клавиши скорости: [] BS<br /><pre><code>файл настроек: $HOME/.config/mpv/input.conf
[ multiply speed 0.9 # scale playback speed
] multiply speed 1.1
BS set speed 1.0 # reset speed to normal
</code></pre>или GUI для mpv: <strong>gnome-mpv</strong> и прочие…
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-207742"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../index.html">
                <span class="post-username">Dobrov</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../../post/207742/index.html">#</a>
            4 года, 1 месяц назад
            
                (отредактировано
                
                    4 года, 1 месяц назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../topics/index.html">
                    15
                </a>
            </div>
            <div>
                Сообщения:
                <a href="index.html">
                    142
                </a>
            </div>
            <div>
                Участник с: 03 ноября 2017
            </div>
            
        </td>
        <td class="post-content">
            <strong>Рабочий стол TDE + kwin_x11: адаптация скрипта запуска</strong> - наиболее подходит для перехода с Windows.<br />Преимущества - Рабочий стол Plasma заменяется на лёгкий TDE 14 со всеми преимуществами KDE (службы, настройки, приложения)<br />Отображение шкалы заполнения дисков, произвольная сетка Рабочего стола, не привязанная к размерам иконок (в отличии от XFCE) и более удобная организация Рабочего стола и Панели задач.<br />Необходимые пакеты: <strong>tde-tdebase, plasma</strong>.<br />Скрипт запуска подготавливает две рабочих среды, в частности меняет диспетчер окон TDE на современный kwin, который добавляет свои горячие клавиши, темы окон, графические эффекты, переключатель задач и рабочих столов (комнат нет) и многое другое.<br /><strong>Установка:</strong> скопировать starttde_kwin в /opt/trinity/bin/ и добавить новую сессию в /usr/share/xsessions/trinity-kwin.desktop<br /><em>[Desktop Entry]<br />Type=XSession<br />Exec=/opt/trinity/bin/starttde_kwin<br />Name=Trinity Plasma (kwin)</em><br /><strong># репозиторий TDE</strong><br /><em>[trinity]<br />SigLevel = Never<br />Server = <a href="http://repo.nasutek.com/arch/contrib/trinity/x86_64">http://repo.nasutek.com/arch/contrib/trinity/x86_64</a></em><br />превью <a href="https://imageban.ru/show/2018/08/01/98f3fae6f340d7ec637ea7baa28d8fb0/jpg"><img src="http://i6.imageban.ru/thumbs/2018.08.01/98f3fae6f340d7ec637ea7baa28d8fb0.jpg"></a><br />скрипт starttde_kwin<pre><code>#!/bin/sh
#  DEFAULT Plasma STARTUP SCRIPT ( 5.11.1 )  + TDE (TRINITY STARTUP SCRIPT)

# We need to create config folder so we can write startupconfigkeys
if [  ${XDG_CONFIG_HOME} ]; then
  configDir=$XDG_CONFIG_HOME;
else
  configDir=${HOME}/.config;
fi

mkdir -p $configDir

#This is basically setting defaults so we can use them with kstartupconfig5
cat &gt;$configDir/startupconfigkeys &lt;&lt;EOF
kcminputrc Mouse cursorTheme &#39;breeze_cursors&#39;
kcminputrc Mouse cursorSize &#39;&#39;
ksplashrc KSplash Theme Breeze
ksplashrc KSplash Engine KSplashQML
kdeglobals KScreen ScreenScaleFactors &#39;&#39;
kcmfonts General forceFontDPI 0
EOF

# preload the user&#39;s locale on first start
plasmalocalerc=$configDir/plasma-localerc
test -f $plasmalocalerc || {
cat &gt;$plasmalocalerc &lt;&lt;EOF
[Formats]
LANG=$LANG
EOF
}

# export LC_* variables set by kcmshell5 formats into environment so it can be picked up by QLocale and friends.
exportformatssettings=$configDir/plasma-locale-settings.sh
test -f $exportformatssettings &amp;&amp; {
    . $exportformatssettings
}

# Write a default kdeglobals file to set up the font
kdeglobalsfile=$configDir/kdeglobals
test -f $kdeglobalsfile || {
cat &gt;$kdeglobalsfile &lt;&lt;EOF
[General]
XftAntialias=true
XftHintStyle=hintmedium
XftSubPixel=none
EOF
}

kstartupconfig5
returncode=$?
if test $returncode -ne 0; then
    xmessage -geometry 500x100 &quot;kstartupconfig5 does not exist or fails. The error code is $returncode. Check your installation.&quot;
    exit 1
fi
[ -r $configDir/startupconfig ] &amp;&amp; . $configDir/startupconfig

if [ &quot;$kdeglobals_kscreen_screenscalefactors&quot; ]; then
    export QT_SCREEN_SCALE_FACTORS=&quot;$kdeglobals_kscreen_screenscalefactors&quot;
fi

# XCursor mouse theme needs to be applied here to work even for kded or ksmserver
if test -n &quot;$kcminputrc_mouse_cursortheme&quot; -o -n &quot;$kcminputrc_mouse_cursorsize&quot; ; then
    kapplymousetheme &quot;$kcminputrc_mouse_cursortheme&quot; &quot;$kcminputrc_mouse_cursorsize&quot;
    if test $? -eq 10; then
        XCURSOR_THEME=breeze_cursors
        export XCURSOR_THEME
    elif test -n &quot;$kcminputrc_mouse_cursortheme&quot;; then
        XCURSOR_THEME=&quot;$kcminputrc_mouse_cursortheme&quot;
        export XCURSOR_THEME
    fi
    if test -n &quot;$kcminputrc_mouse_cursorsize&quot;; then
        XCURSOR_SIZE=&quot;$kcminputrc_mouse_cursorsize&quot;
        export XCURSOR_SIZE
    fi
fi

if test &quot;$kcmfonts_general_forcefontdpi&quot; -ne 0; then
    xrdb -quiet -merge -nocpp &lt;&lt;EOF
Xft.dpi: $kcmfonts_general_forcefontdpi
EOF
fi

# Source scripts found in &lt;config locations&gt;/plasma-workspace/env/*.sh

scriptpath=`qtpaths --locate-dirs GenericConfigLocation plasma-workspace | tr &#39;:&#39; &#39;\n&#39;`

# Add /env/ to the directory to locate the scripts to be sourced
for prefix in `echo $scriptpath`; do
  for file in &quot;$prefix&quot;/env/*.sh; do
    test -r &quot;$file&quot; &amp;&amp; . &quot;$file&quot; || true
  done
done

xsetroot -cursor_name left_ptr

# Get Ghostscript to look into user&#39;s KDE fonts dir for additional Fontmap
if test -n &quot;$GS_LIB&quot; ; then
    GS_LIB=$usr_fdir:$GS_LIB
    export GS_LIB
else
    GS_LIB=$usr_fdir
    export GS_LIB
fi

echo &#39;startkde: Starting up...&#39;  1&gt;&amp;2

if test -z &quot;$XDG_DATA_DIRS&quot;; then
    XDG_DATA_DIRS=&quot;/usr/share:/usr/share:/usr/local/share&quot;
fi
export XDG_DATA_DIRS

# если установить: XDG_CURRENT_DESKTOP=KDE пропадают некоторые иконки в трее, но тема иконок в Qt приложениях применяется правильно
export XDG_CURRENT_DESKTOP=XFCE	# XDG_CURRENT_DESKTOP=KDE ; export XDG_CURRENT_DESKTOP=KDE

export KDE_SESSION_VERSION=5
xprop -root -f KDE_SESSION_VERSION 32c -set KDE_SESSION_VERSION 5
export KDE_SESSION_UID=`id -ru`

KSMSERVEROPTIONS=&quot;&quot;

#====================================================================

#  DEFAULT TRINITY STARTUP SCRIPT

# It should work for command line logins but graphical login managers might already source these files.
# Multiple sourcing is not a problem when the files are only containers for environment variables and such.
if [ -r /etc/xprofile ]; then
  source /etc/xprofile
fi
if [ -r $HOME/.xprofile ]; then
  source $HOME/.xprofile
fi

# Usage: is_in_path PATH /usr/bin
is_in_path() { var=&quot;$1&quot;; search=&quot;$2&quot;;
  if eval test -z \$$1; then return 1; fi
  ifs=&quot;$IFS&quot;; IFS=&quot;:&quot;; eval set \$$var; IFS=&quot;$ifs&quot;
  for i in $*; do
    [ &quot;${i}&quot; = &quot;${search}&quot; ] &amp;&amp; return 0
  done
  return 1
}

# Usage: is_before_in_path ENV_VAR var before_var
# Return 0 if &#39;var&#39; is before &#39;before_var&#39; in &#39;ENV_VAR&#39;, 1 otherwise
is_before_in_path() {
  [ $# -ge 3 ] || return 1
  var=&quot;$1&quot;; search=&quot;$2&quot;; before=&quot;$3&quot;
  ifs=&quot;$IFS&quot;; IFS=&quot;:&quot;; eval set \$$var; IFS=&quot;$ifs&quot;
  for i in $*; do
    [ &quot;${i}&quot; = &quot;${search}&quot; ] &amp;&amp; return 0
    [ &quot;${i}&quot; = &quot;${before}&quot; ] &amp;&amp; return 1
  done
  return 1
}

# Usage: place_before_in_path PATH /opt/trinity/games /usr/games
place_before_in_path() { var=&quot;$1&quot;; insert=&quot;$2&quot;;
  if eval test -z \$$1; then
    eval export $var=${insert}
  else
    before=&quot;$3&quot;; ifs=&quot;$IFS&quot;; IFS=&quot;:&quot;; eval set \$$var; IFS=&quot;$ifs&quot;
    NPATH=&quot;&quot;
    for i in $*; do
      [ &quot;${i}&quot; = &quot;${before}&quot; ] &amp;&amp; NPATH=&quot;${NPATH}:${insert}&quot;
      NPATH=&quot;${NPATH}:${i}&quot;
    done
    eval export $var=${NPATH#:}
  fi
}
# Usage: remove_from_path PATH /opt/trinity/games
remove_from_path() { var=&quot;$1&quot;; remove=&quot;$2&quot;;
  if eval test -z \$$1; then return 1; fi
  ifs=&quot;$IFS&quot;; IFS=&quot;:&quot;; eval set \$$var; IFS=&quot;$ifs&quot;
  NPATH=&quot;&quot;
  for i in $*; do
    [ &quot;${i}&quot; != &quot;${remove}&quot; ] &amp;&amp; NPATH=&quot;${NPATH}:${i}&quot;
  done
  eval export $var=${NPATH#:}
}

echo &quot;[starttde] Starting starttde.&quot; 1&gt;&amp;2
echo &quot;[starttde] This script is $0&quot; 1&gt;&amp;2

# The binaries for TDE are located in the same place as this script. To determine that location use the following method rather than presuming
# the existence of $TDEDIR. That environment variable might not be defined or defined to point to KDE4 binaries.
BIN_DIR=&quot;`dirname \`readlink -f $0\``&quot;
if [ -x $BIN_DIR/tde-config ]; then
  TDE_VERSION=$($BIN_DIR/tde-config --version | while IFS=: read a b; do [ &quot;${a#TDE}&quot; != &quot;$a&quot; ] &amp;&amp; echo $b; done)
  echo &quot;[starttde] TDE version is $TDE_VERSION&quot; 1&gt;&amp;2
  export TDEDIR=${BIN_DIR%/bin}
  echo &quot;[starttde] TDE base directory is $TDEDIR&quot; 1&gt;&amp;2
else
  echo &quot;[starttde] Unable to determine the TDE bin directory, where this script should be installed.&quot;
  echo &quot;[starttde] This script should be installed in the same directory.&quot;
  echo &quot;[starttde] Exiting.&quot;
  exit 1
fi
unset BIN_DIR

# When the X server dies we get a HUP signal from xinit. We must ignore it because we still need to do some cleanup.
trap &#39;echo &quot;[starttde] GOT SIGHUP&quot;&#39; HUP

# Check if a TDE session is already running.
if /opt/trinity/bin/kcheckrunning &gt;/dev/null 2&gt;&amp;1; then
  echo &quot;[starttde] TDE seems to be already running on this display.&quot;
  xmessage -center -geometry 500x100 &quot;TDE seems to be already running on this display.&quot; &gt; /dev/null 2&gt;/dev/null
  exit 1
fi

# We use colours from the standard TDE palette for those with palettised displays.
if test -z &quot;$XDM_MANAGED&quot; || echo &quot;$XDM_MANAGED&quot; | grep &quot;,auto&quot; &gt; /dev/null; then
  xsetroot -solid &quot;#003080&quot; # blue
fi

# Unset this for Darwin since it will screw up TDE&#39;s dynamic-loading.
unset DYLD_FORCE_FLAT_NAMESPACE

# Check whether prelinking is enabled. If yes, then exporting TDE_IS_PRELINKED improves loading TDE.
# The $TDE_IS_PRELINKED variable might already be set on some systems through /etc/profile.d. Therefore first check whether the variable exists.
if [ &quot;$TDE_IS_PRELINKED&quot; = &quot;&quot; ]; then
  if [ -r /etc/default/prelink ]; then
    . /etc/default/prelink
  elif [ -r /etc/sysconfig/prelink ]; then
    . /etc/sysconfig/prelink
  fi
  if [ &quot;$PRELINKING&quot; = &quot;yes&quot; ]; then
    export TDE_IS_PRELINKED=1
  fi
fi

# The user&#39;s personal TDE directory usually is $HOME/.trinity.
# This setting may be overridden by setting $TDEHOME. When migrating profiles must be careful here because $HOME/.kde was used commonly in the

if [ &quot;$TDEHOME&quot; != &quot;&quot; ]; then
  echo &quot;[starttde] TDEHOME is preset to $TDEHOME.&quot; 1&gt;&amp;2
  export TDEHOME=$TDEHOME
else
  echo &quot;[starttde] TDEHOME is not set.&quot; 1&gt;&amp;2
  export TDEHOME=$HOME/.trinity

  if [ ! -d $HOME/.trinity ] &amp;&amp; [ ! -f /usr/bin/kde4-config ] &amp;&amp; [ &quot;$TDEDIR&quot;=&quot;/usr&quot; ] &amp;&amp; [ -d $HOME/.kde ]; then
    export TDEHOME=$HOME/.kde
  fi
  echo &quot;[starttde] Set TDEHOME to $TDEHOME.&quot; 1&gt;&amp;2
fi

if [ &quot;$TDEROOTHOME&quot; = &quot;&quot; ]; then
  export TDEROOTHOME=/root/.trinity
  echo &quot;[starttde] Setting TDEROOTHOME to $TDEROOTHOME.&quot;
fi

# Modify the following environment variables only as necessary.
if [ -d $TDEDIR/games ]; then
  if ! is_in_path PATH &quot;$TDEDIR/games&quot; ; then
    if is_in_path PATH &quot;/usr/games&quot;; then
      place_before_in_path PATH &quot;$TDEDIR/games&quot; &quot;/usr/games&quot;
    else
      export PATH=$TDEDIR/games:$PATH
    fi
  fi
fi

if [ -d $TDEDIR/bin ]; then
  if ! is_in_path PATH &quot;$TDEDIR/bin&quot; ]; then
    if is_in_path PATH &quot;/usr/bin&quot;; then
#       place_before_in_path PATH &quot;$TDEDIR/bin&quot; &quot;/usr/bin&quot;
      export PATH=$PATH:$TDEDIR/bin		# так вместо konqueror TDE открывается konqueror Plasma (но его можно не ставить)
    else
      export PATH=$TDEDIR/bin:$PATH
    fi
  fi
fi
if [ -d $TDEDIR/share/man ]; then
  if [ -x /usr/bin/manpath ]; then
    if [ &quot;`manpath 2&gt;/dev/null | grep \&quot;$TDEDIR/share/man\&quot;`&quot; = &quot;&quot; ]; then
      export MANPATH=$TDEDIR/share/man:$MANPATH
    fi
  else
    if [ &quot;`echo $MANPATH | grep \&quot;$TDEDIR/share/man\&quot;`&quot; = &quot;&quot; ]; then
      export MANPATH=$TDEDIR/share/man:$MANPATH
    fi
  fi
fi

if [ &quot;$XDG_CONFIG_DIRS&quot; = &quot;&quot; ]; then
  if [ -d /etc/xdg ]; then
    XDG_CONFIG_DIRS=/etc/xdg
  fi
fi

if [ -d $TDEDIR/etc/xdg ]; then
  TDE_XDG_DIR=&quot;$TDEDIR/etc/xdg&quot;
fi
if [ -d $TDE_XDG_DIR ]; then
  if [ &quot;`echo $XDG_CONFIG_DIRS | grep \&quot;$TDE_XDG_DIR\&quot;`&quot; = &quot;&quot; ]; then
    if [ &quot;$XDG_CONFIG_DIRS&quot; = &quot;&quot; ]; then
      XDG_CONFIG_DIRS=$TDE_XDG_DIR
    else
      XDG_CONFIG_DIRS=$TDE_XDG_DIR:$XDG_CONFIG_DIRS
    fi
  fi
fi
if [ &quot;$XDG_CONFIG_DIRS&quot; != &quot;&quot; ]; then
  export XDG_CONFIG_DIRS
fi

if [ &quot;$TDEDIR&quot; != &quot;/usr&quot; ] &amp;&amp; [ -d $TDEDIR/share ]; then
  # If &#39;/usr/share&#39; is not already there, we include it at the last position.
  if ! is_in_path XDG_DATA_DIRS &quot;/usr/share&quot;; then
    if [ &quot;$XDG_DATA_DIRS&quot; = &quot;&quot; ]; then
      XDG_DATA_DIRS=/usr/share    # In case XDG_DATA_DIRS is empty, to avoid a leading :
    else
      XDG_DATA_DIRS=$XDG_DATA_DIRS:/usr/share
    fi
  fi
  # If &#39;/usr/local/share&#39; is not already there, we include it before &#39;/usr/share&#39;
  if ! is_in_path XDG_DATA_DIRS &quot;/usr/local/share&quot;; then
    place_before_in_path XDG_DATA_DIRS &quot;/usr/local/share&quot; &quot;/usr/share&quot;
  fi

  # Ensure that $TDEDIR/share is always before &#39;/usr/local/share&#39; and &#39;/usr/share&#39;.
  if ! is_in_path XDG_DATA_DIRS &quot;$TDEDIR/share&quot; ||
     is_before_in_path XDG_DATA_DIRS &quot;/usr/local/share&quot; &quot;$TDEDIR/share&quot; ||
     is_before_in_path XDG_DATA_DIRS &quot;/usr/share&quot; &quot;$TDEDIR/share&quot;; then
    remove_from_path XDG_DATA_DIRS &quot;$TDEDIR/share&quot;
    if is_before_in_path XDG_DATA_DIRS &quot;/usr/local/share&quot; &quot;/usr/share&quot;; then
      place_before_in_path XDG_DATA_DIRS &quot;$TDEDIR/share&quot; &quot;/usr/local/share&quot;
    else
      place_before_in_path XDG_DATA_DIRS &quot;$TDEDIR/share&quot; &quot;/usr/share&quot;
    fi
  fi
# Adds supplementary directories from TDEDIRS, if any, before TDEDIR.
  if [ &quot;$TDEDIRS&quot; != &quot;&quot; ]; then
    ifs=&quot;$IFS&quot;; IFS=&quot;:&quot;; set $TDEDIRS; IFS=&quot;$ifs&quot;
    for dir in $*; do
      if ! is_in_path XDG_DATA_DIRS &quot;$dir/share&quot; &amp;&amp; [ -d &quot;$dir/share&quot; ]; then
        XDG_DATA_DIRS=$dir/share:$XDG_DATA_DIRS
      fi
    done
  fi
  export XDG_DATA_DIRS
fi

echo &quot;[starttde] XDG_DATA_DIRS: $XDG_DATA_DIRS&quot; 1&gt;&amp;2
test -n &quot;$TDEHOME&quot; &amp;&amp; tdehome=`echo &quot;$TDEHOME&quot; | sed &quot;s,^~/,$HOME/,&quot;`

# Allow interested applications, such as the Plasma control wrapper, to know that this is a Trinity desktop and not a KDE one.
export DESKTOP_SESSION=trinity

# Create profile directory.
if [ ! -d &quot;$tdehome&quot; ]; then
  echo &quot;[starttde] Creating $tdehome&quot; 1&gt;&amp;2
  mkdir -m 700 -p &quot;$tdehome&quot;
fi
if [ -d &quot;$tdehome&quot; ]; then
  # Run some R14 updates.
  R14_UPDATED=&quot;`$TDEDIR/bin/kreadconfig --file kdeglobals --group &quot;R14 XDG Updates&quot; --key Updated --default false`&quot;
  R14_VERSION=&quot;`$TDEDIR/bin/kreadconfig --file kdeglobals --group &quot;R14 XDG Updates&quot; --key Version --default 0`&quot;
  if [ -e $TDEDIR/bin/r14-xdg-update ]; then
    # Script version index is used to allow automatic rerun
    R14_SCRIPT=&quot;`sed -n &quot;s/SCRIPT_VERSION=\([0-9]*\)/\1/p&quot; $TDEDIR/bin/r14-xdg-update`&quot;
  else
    R14_SCRIPT=0
  fi
  if [ &quot;$R14_UPDATED&quot; != &quot;true&quot; ] || [ &quot;$R14_VERSION&quot; -lt &quot;$R14_SCRIPT&quot; ]; then
    if [ -e $TDEDIR/bin/r14-xdg-update ]; then
      echo &quot;[starttde] Running $TDEDIR/bin/r14-xdg-update script.&quot; 1&gt;&amp;2
      sh $TDEDIR/bin/r14-xdg-update
      EXIT_CODE=&quot;$?&quot;
    else
      echo &quot;[starttde] $TDEDIR/bin/r14-xdg-update does not exist.&quot; 1&gt;&amp;2
      echo &quot;           Unable to perform a profile update for Trinity release R14.&quot;
    fi
    if [ &quot;$EXIT_CODE&quot; != &quot;0&quot; ]; then
      exit 1
    fi
  fi
fi
# Please see tdestartupconfig source for usage.
mkdir -m 700 -p &quot;$tdehome/share&quot;
mkdir -m 700 -p &quot;$tdehome/share/config&quot;
cat &gt;&quot;$tdehome/share/config/startupconfigkeys&quot; &lt;&lt;EOF
kcminputrc Mouse cursorTheme &#39;&#39;
kcminputrc Mouse cursorSize &#39;&#39;
kpersonalizerrc General FirstLogin true
ksplashrc KSplash Theme Default
kcmrandrrc Display ApplyOnStartup false
kcmrandrrc [Screen0]
kcmrandrrc [Screen1]
kcmrandrrc [Screen2]
kcmrandrrc [Screen3]
kcmfonts General forceFontDPI 0
EOF

$TDEDIR/bin/tdestartupconfig
if test $? -ne 0; then
  xmessage -center -geometry 500x100 &quot;Could not start tdestartupconfig. Check your installation.&quot;
fi
# $tdehome/share/config/startupconfig should exist but avoid script failure if not.
if [ -r &quot;$tdehome/share/config/startupconfig&quot; ]; then
  . &quot;$tdehome/share/config/startupconfig&quot;
fi

# Make sure a default wallpaper is set.
if [ ! -e &quot;$tdehome/share/config/kdesktoprc&quot; ]; then
 # With Trinity this file should exist, but test first.
  if [ -r $TDEDIR/share/wallpapers/Trinity-lineart.svg.desktop ]; then
cat &gt;&quot;$tdehome/share/config/kdesktoprc&quot; &lt;&lt;EOF
[Desktop0]
Wallpaper=Trinity-lineart.svg
WallpaperMode=Scaled
EOF
  fi
fi

# XCursor mouse theme needs to be applied here to work even for kded or ksmserver.

if test &quot;$kcmrandrrc_display_applyonstartup&quot; = &quot;true&quot;; then
  # 4 screens is hopefully enough.
  for scrn in 0 1 2 3; do
    args=
    width=&quot;\$kcmrandrrc_screen${scrn}_width&quot; ; eval &quot;width=$width&quot;
    height=&quot;\$kcmrandrrc_screen${scrn}_height&quot; ; eval &quot;height=$height&quot;
    if test -n &quot;${width}&quot; -a -n &quot;${height}&quot;; then
      args=&quot;$args -s ${width}x${height}&quot;
    fi
    refresh=&quot;\$kcmrandrrc_screen${scrn}_refresh&quot; ; eval &quot;refresh=$refresh&quot;
    if test -n &quot;${refresh}&quot;; then
      args=&quot;$args -r ${refresh}&quot;
    fi
    rotation=&quot;\$kcmrandrrc_screen${scrn}_rotation&quot; ; eval &quot;rotation=$rotation&quot;
    if test -n &quot;${rotation}&quot;; then
      case &quot;${rotation}&quot; in
        0)
          args=&quot;$args -o 0&quot;
          ;;
        90)
          args=&quot;$args -o 1&quot;
          ;;
        180)
          args=&quot;$args -o 2&quot;
          ;;
        270)
          args=&quot;$args -o 3&quot;
          ;;
      esac
    fi
    reflectx=&quot;\$kcmrandrrc_screen${scrn}_reflectx&quot; ; eval &quot;reflectx=$reflectx&quot;
    if test &quot;${refrectx}&quot; = &quot;true&quot;; then
      args=&quot;$args -x&quot;
    fi
    reflecty=&quot;\$kcmrandrrc_screen${scrn}_reflecty&quot; ; eval &quot;reflecty=$reflecty&quot;
    if test &quot;${refrecty}&quot; = &quot;true&quot;; then
      args=&quot;$args -y&quot;
    fi
    if test -n &quot;$args&quot;; then
      xrandr $args
    fi
  done
fi

dl=$DESKTOP_LOCKED
unset DESKTOP_LOCKED # Don&#39;t want it in the environment

if test -z &quot;$dl&quot; &amp;&amp; test &quot;$kpersonalizerrc_general_firstlogin&quot; != &quot;true&quot;; then
  case &quot;$ksplashrc_ksplash_theme&quot; in
    Simple)
      ksplashsimple
      ;;
    *)
      ;;
  esac
fi

# Configuration of the gtk_qt_engine if not already set.
if test -n &quot;$TDEDIRS&quot;; then
  tdedirs_first=${TDEDIRS%%:*}
  TGTK_RC_ENGINE=$tdedirs_first/share/kgtk/gtk-qt-engine.rc.sh
  TGTK_RC_TDE1=$tdedirs_first/share/kgtk/.gtkrc-2.0-kde4
  TGTK_RC_TDE2=$tdedirs_first/share/kgtk/.gtkrc-2.0-kde-kde4
else
  TGTK_RC_ENGINE=$TDEDIR/share/kgtk/gtk-qt-engine.rc.sh
  TGTK_RC_TDE1=$TDEDIR/share/kgtk/.gtkrc-2.0-kde4
  TGTK_RC_TDE2=$TDEDIR/share/kgtk/.gtkrc-2.0-kde-kde4
fi

if [ ! -e &quot;$tdehome/env/gtk-qt-engine.rc.sh&quot; ] &amp;&amp; [ -e $TGTK_RC_ENGINE ]; then
 mkdir -p &quot;$tdehome/env&quot;
 cp -f $TGTK_RC_ENGINE &quot;$tdehome/env&quot;
 chmod 755 &quot;$tdehome/env/gtk-qt-engine.rc.sh&quot;
fi

if [ ! -e $HOME/.gtkrc-2.0-kde4 ] &amp;&amp; [ -e $TGTK_RC_TDE1 ]
then
 cp -f $TGTK_RC_TDE1 $HOME
fi

if [ ! -e $HOME/.gtkrc-2.0-kde-kde4 ] &amp;&amp; [ -e $TGTK_RC_TDE2 ]
then
 cp -f $TGTK_RC_TDE2 $HOME
fi

exepath=`tde-config --path exe | tr : &#39;\n&#39;`

for prefix in `echo &quot;$exepath&quot; | sed -n -e &#39;s,/bin[^/]*/,/env/,p&#39;`; do
  for file in &quot;$prefix&quot;*.sh; do
    test -r &quot;$file&quot; &amp;&amp; . &quot;$file&quot;
  done
done

# Add any user-installed font directories to the X font path.

echo &quot;[starttde] TDEDIR: $TDEDIR&quot; 1&gt;&amp;2
echo &quot;[starttde] TDEDIRS: $TDEDIRS&quot; 1&gt;&amp;2

if test -n &quot;$TDEDIRS&quot;; then
  tdedirs_first=${TDEDIRS%%:*}
  echo &quot;[starttde] tdedirs_first: $tdedirs_first&quot;
  if [ -r $tdedirs_first/share/kgtk/preload ]; then
    echo &quot;[starttde] Reading from $tdedirs_first/share/kgtk/preload&quot;
    read -r TGTK_PRELOAD &lt; $tdedirs_first/share/kgtk/preload
  fi
else
  if [ -r $TDEDIR/share/kgtk/preload ]; then
    read -r TGTK_PRELOAD &lt; $TDEDIR/share/kgtk/preload
  fi
fi

if [ &quot;$TGTK_PRELOAD&quot; != &quot;&quot; ]; then
  if [ -e /usr/lib64/libnspr4.so ]; then
    TGTK_NSPR_PRELOAD=&quot;/usr/lib64/libnspr4.so:&quot;
  elif [ -e /usr/lib/libnspr4.so ]; then
    TGTK_NSPR_PRELOAD=&quot;/usr/lib/libnspr4.so:&quot;
  fi
  export LD_PRELOAD=$TGTK_PRELOAD:$TGTK_NSPR_PRELOAD$LD_PRELOAD
fi

# Note: temporary locations can be overridden through the TDETMP and TDEVARTMP environment variables
for resource in tmp cache socket; do
  if ! $TDEDIR/bin/lnusertemp $resource &gt;/dev/null; then
    echo &quot;[starttde] Call to lnusertemp failed (temporary directories full?). Check your installation.&quot; 1&gt;&amp;2
    xmessage -center -geometry 600x100 &quot;Call to lnusertemp failed (temporary directories full?). Check your installation.&quot;
    exit 1
  fi
done

echo &quot;[starttde] Starting Trinity...&quot; 1&gt;&amp;2

# Detect any running Xorg composition managers.
$TDEDIR/bin/kdetcompmgr

# Run KPersonalizer before the session if this is the first login.
if test &quot;$kpersonalizerrc_general_firstlogin&quot; = &quot;true&quot;; then
  if [ ! -x $TDEDIR/bin/kpersonalizer ]; then
    echo &quot;[starttde] kpersonalizer not found! Please install in order to properly configure your user profile.&quot; 1&gt;&amp;2
  else
    # Start only dcopserver, don&#39;t start whole tdeinit (takes too long).
    echo &quot;[starttde] Running kpersonalizer...&quot; 1&gt;&amp;2
    $TDEDIR/bin/dcopserver
    /usr/bin/twin --lock &amp;
    $TDEDIR/bin/kpersonalizer --before-session
    # Handle kpersonalizer restarts (language change).
    while test $? -eq 1; do
      $TDEDIR/bin/kpersonalizer --r --before-session
    done
    $TDEDIR/bin/dcopquit twin
    $TDEDIR/bin/dcopserver_shutdown --wait
  fi
fi

# Apply any user-specific display configuration settings
$TDEDIR/bin/tdeinit_displayconfig
EXIT_CODE=&quot;$?&quot;

if test -z &quot;$dl&quot;; then
# The splashscreen and progress indicator.
case &quot;$ksplashrc_ksplash_theme&quot; in
   None)
   ;; # Nothing.
   Simple)
   if test &quot;$kpersonalizerrc_general_firstlogin&quot; = &quot;true&quot;; then
       $TDEDIR/bin/ksplashsimple
   fi # Otherwise started earlier.
   ;;
   *)
   $TDEDIR/bin/ksplash --nodcop
   ;;
esac
fi

# Additionally there is $TDE_SESSION_UID with the uid of the user running the TDE session.
# It should be rarely needed (for example, after sudo to prevent desktop-wide functionality in the new user&#39;s kded).
TDE_FULL_SESSION=true
export TDE_FULL_SESSION
xprop -root -f TDE_FULL_SESSION 8t -set TDE_FULL_SESSION true
echo &quot;[starttde] TDE_FULL_SESSION: $TDE_FULL_SESSION&quot; 1&gt;&amp;2
TDE_SESSION_UID=`id -u`
export TDE_SESSION_UID
echo &quot;[starttde] TDE_SESSION_UID: $TDE_SESSION_UID&quot; 1&gt;&amp;2

# We set LD_BIND_NOW to increase the efficiency of tdeinit. tdeinit unsets this variable before loading applications.
LD_BIND_NOW=true $TDEDIR/bin/start_tdeinit_wrapper --new-startup +kcminit_startup
if test $? -ne 0; then
  # Startup error
  echo &quot;[starttde] Could not start tdeinit. Check your installation.&quot; 1&gt;&amp;2
  xmessage -center -geometry 500x100 &quot;Could not start tdeinit. Check your installation.&quot;
fi
echo &quot;[starttde] tdeinit started successfully.&quot; 1&gt;&amp;2

# kdesktop needs notified of this locker process somehow so that it does not attempt launch its own locker process on startup!
if test -n &quot;$dl&quot;; then
  $TDEDIR/bin/kwrapper kdesktop_lock --forcelock &amp;
  # Give it some time for starting up. This is somewhat unclean; some notification would be better.
  sleep 1
fi

export PATH=$PATH:$HOME/bin

# использовать менеджер окон Plasma5 (kwin_x11 --no-kactivities)
export TDEWM=/usr/bin/kwin_x11

# Finally, give the session control to the session manager. If tdeinit_phase1 should cause problems, here is the old way:
test -n &quot;$TDEWM&quot; &amp;&amp; TDEWM=&quot;--windowmanager $TDEWM&quot;
$TDEDIR/bin/kwrapper $TDEDIR/bin/ksmserver --nocrashhandler $TDEWM
EXIT_CODE=&quot;$?&quot;
if test $EXIT_CODE -eq 255; then
  # Startup error
  echo &quot;[starttde] An error was detected while attempting to load the session manager. Please check your installation for problems.&quot; 1&gt;&amp;2
  xmessage -center -geometry 500x100 &quot;An error was detected while attempting to load the session manager. Please check your installation for problems.&quot;
fi

# Plasma: - завершение сеанса... Проверка открытых несохранённых документов

echo &#39;startkde: Shutting down...&#39;  1&gt;&amp;2
kdeinit5_shutdown
echo &quot;[starttde] Shutting down Trinity...&quot; 1&gt;&amp;2
$TDEDIR/bin/tdeinit_shutdown
$TDEDIR/bin/dcopserver_shutdown --wait
$TDEDIR/bin/artsshell -q terminate

# Run scripts in shutdown directories: $PREFIX/shutdown $TDEHOME/shutdown $TDEDIRS/shutdown

unset KDE_FULL_SESSION
xprop -root -remove KDE_FULL_SESSION
unset KDE_SESSION_VERSION
xprop -root -remove KDE_SESSION_VERSION
unset KDE_SESSION_UID

unset TDE_FULL_SESSION
xprop -root -remove TDE_FULL_SESSION
unset TDE_SESSION_UID
echo &quot;[starttde] Trinity shutdown complete.&quot; 1&gt;&amp;2
</code></pre>
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
    </div>
    <div>&nbsp;</div>
    
        <div class="text-center">
    


    <nav>
        <ul class="pagination">
            
                <li class="previous">
                    <a href="indexa7f1.html?page=14" aria-label="предыдущая страница">
                        <span aria-hidden="true">&laquo;</span>
                        <span class="hidden-xs">предыдущая страница</span>
                    </a>
                </li>
            

            
                
                    
                        <li>
                            <a href="index2679.html?page=1">1</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index4658.html?page=2">2</a>
                        </li>
                    
                
            
                
                    <li class="disabled">
                        <span>...</span>
                    </li>
                
            
                
                    
                        <li>
                            <a href="indexaf4d.html?page=5">5</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexc575.html?page=6">6</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index235c.html?page=7">7</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexfdfa.html?page=8">8</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index0b08.html?page=9">9</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index1448.html?page=10">10</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index1c8b.html?page=11">11</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexce37.html?page=12">12</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index8c93.html?page=13">13</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexa7f1.html?page=14">14</a>
                        </li>
                    
                
            
                
                    
                        <li class="active">
                            <a href="index5760.html?page=15">15 <span class="sr-only">(текущая страница)</span></a>
                        </li>
                    
                
            

            
                <li class="next disabled">
                    <span>
                        <span class="hidden-xs">следующая страница</span>
                        <span aria-hidden="true">&raquo;</span>
                    </span>
                </li>
            
        </ul>
    </nav>


</div>

    


        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

</body>

<!-- Mirrored from archlinux.org.ru/forum/users/Dobrov/posts/?page=15 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 05:54:00 GMT -->
</html>
