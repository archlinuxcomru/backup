


<!DOCTYPE html>
<html lang="ru">

<!-- Mirrored from archlinux.org.ru/forum/users/Anton8830/posts/?page=1 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 09:22:44 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Anton8830 Сообщения
    </title>
    <link rel="shortcut icon" href="https://archlinuxcomru.github.io/backup/src/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://archlinuxcomru.github.io/backup/src/css/bootstrap.css">
    
    
    <script type="text/javascript" src="https://archlinuxcomru.github.io/backup/src/js/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://archlinuxcomru.github.io/backup/src/js/bootstrap.js"></script>
    <script type="text/javascript" src="https://archlinuxcomru.github.io/backup/src/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="../../../feeds/posts/index.html" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="../../../feeds/topics/index.html" title="Последние темы на форуме" >

    
</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="../../../../index.html">
        <img src="https://archlinuxcomru.github.io/backup/src/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="../../../../news/index.html">Новости</a></li>
    <li class="active"><a href="../../../index.html">Форум</a></li>
    <li class=""><a href="../../../../blogs/index.html">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_(Русский)">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="../../../../irc/index.html#chat">IRC</a></li>
      <li class="dropdown">
        <a href="../../../../accounts/login/index.html" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="../../../../accounts/login/index.html">Вход</a></li>
          <li><a href="../../../../accounts/register/index.html">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="../../../../messages/inbox/index.html" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="../../../../index.html">ArchLinux.org.ru</a></li>


    <li><a href="../../../index.html">Начало</a> <span class="divider">/</span></li>
    
    
        <li>Сообщения</li>
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    <div class="posts">
        
            




<table class="table table-bordered post post-row
       "
       id="post-219082"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../index.html">
                <span class="post-username">Anton8830</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../../post/219082/index.html">#</a>
            3 года, 1 месяц назад
            
                (отредактировано
                
                    3 года, 1 месяц назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../topics/index.html">
                    23
                </a>
            </div>
            <div>
                Сообщения:
                <a href="index.html">
                    175
                </a>
            </div>
            <div>
                Участник с: 16 ноября 2013
            </div>
            
        </td>
        <td class="post-content">
            <strong>vasek</strong>, спасибо.<br /><br />Найдено 2 решения.<br /><br />1. <em>/etc/systemd/systm/docker_dhcpd.service</em><br /><pre><code>...
[Service]
Restart=on-failure
ExecStart=/usr/bin/docker run -p 67:67 --name dhcpd --rm dhcpd
ExecStop=/usr/bin/docker stop dhcpd
...</code></pre>2. <em>/etc/systemd/system/docker_dhcpd.service</em><br /><pre><code>...
[Service]
Type=oneshot
RemainAfterExit=yes
ExecStart=/usr/bin/docker run -p 67:67 -d --name dhcpd --restart on-failure dhcpd
ExecStop=/usr/bin/docker stop dhcpd
ExecStopPost=/usr/bin/docker rm dhcpd
...</code></pre><br />В первом случае за перезапуск контейнера отвечает systemd, во втором - docker. И в том, и в другом случае контейнер после остановки сервиса удаляется.<br />Первый вариант, наверное, правильнее, с точки зрения организации контроля, хотя при остановке сервиса он становится Failure...
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-219077"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../index.html">
                <span class="post-username">Anton8830</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../../post/219077/index.html">#</a>
            3 года, 1 месяц назад
            
                (отредактировано
                
                    3 года, 1 месяц назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../topics/index.html">
                    23
                </a>
            </div>
            <div>
                Сообщения:
                <a href="index.html">
                    175
                </a>
            </div>
            <div>
                Участник с: 16 ноября 2013
            </div>
            
        </td>
        <td class="post-content">
            <strong>vasek</strong> Если &quot;на пальцах&quot;, то:<br /><pre><code>$ ps -ef | grep dhcpd
anton 357 341 1 12:19 tty1 00:00:00 grep dhcpd
$ docker ps
$ systemctl status docker_dhcpd
...
  Active: inactive (dead)
$ sudo systemctl start docker_dhcpd
$ systemctl status docker_dhcpd
...
  Active: active (exited)
$ docker ps
be1ab5c28f70 dhcpd:latest &quot;/usr/sbin/dhcpd -f ...&quot;  20 hours age  Up 44 seconds  0.0.0.0:67-&gt;67/tcp  dhcpd
$ ps -ef | grep dhcpd
root  600 583 1 12:20 ? 00:00:01 /usr/sbin/dhcpd -f -4
anton 651 341 0 12:22 tty1 00:00:00 grep dhcpd
$ sudo kill -9 600
$ ps -ef | grep dhcpd
anton 684 341 0 12:23 tty1 00:00:00 grep dhcpd
$ docker ps
$ systemctl status docker_dhcpd
...
  Active: active (exited)
$</code></pre><br />Т. е. старт сервиса запускает контейнер, появляется процесс dhcpd - все хорошо.<br />Далее имитируем смерть процесса dhcpd<br />Процесс умирает, контейнер падает, а сервис - нет.<br /><br />Тут суть в том, что сервис отслеживает процесс, описанный в ExecStart (docker start dhcpd). Он завершается с кодом 0 (контейнер запущен) и systemd считает сервис активным. Процесс dhpcd в данном случае не отслеживается и (как я понимаю) не является дочерним для ExecStart...
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-219075"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../index.html">
                <span class="post-username">Anton8830</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../../post/219075/index.html">#</a>
            3 года, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../topics/index.html">
                    23
                </a>
            </div>
            <div>
                Сообщения:
                <a href="index.html">
                    175
                </a>
            </div>
            <div>
                Участник с: 16 ноября 2013
            </div>
            
        </td>
        <td class="post-content">
            <strong>vs220</strong> Ну, docker вообще не совсем для ограничения прав (или совсем не для того). Он позволяет создать изолированную область, где работает нужное приложение, минимально зависимое от системы, позволяет не устанавливать в систему само приложение. Т. е. есть только базовая система и docker, а все остальное изолировано друг от друга в контейнерах. Не знаю, как ещё объяснить...<br /><br />Для меня dhcp и bind внутри контейнеров - просто для практики. Создать образ, запустить контейнер - у меня получилось. Теперь я пытаюсь сделать так, чтобы контейнеры запускались и процессы контролировались через systemd
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-219073"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../index.html">
                <span class="post-username">Anton8830</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../../post/219073/index.html">#</a>
            3 года, 1 месяц назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../topics/index.html">
                    23
                </a>
            </div>
            <div>
                Сообщения:
                <a href="index.html">
                    175
                </a>
            </div>
            <div>
                Участник с: 16 ноября 2013
            </div>
            
        </td>
        <td class="post-content">
            <strong>vs220</strong> Запускать systemd внутри контейнера, конечно, можно, но тогда весь смысл контейнера нивелируется... Образы получаются тяжелыми и бессмысленными.<br /><br />/run/docker/containerd/daemon/*/init.pid может и прокатит, но только когда контейнер один. А если добавить второй, например с bind? Тогда - уже нет...
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-219071"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../index.html">
                <span class="post-username">Anton8830</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../../post/219071/index.html">#</a>
            3 года, 1 месяц назад
            
                (отредактировано
                
                    3 года, 1 месяц назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../topics/index.html">
                    23
                </a>
            </div>
            <div>
                Сообщения:
                <a href="index.html">
                    175
                </a>
            </div>
            <div>
                Участник с: 16 ноября 2013
            </div>
            
        </td>
        <td class="post-content">
            <strong>vs220</strong> Эмм... Есть <pre><code>/run/docker/containerd/daemon/io.containerd.runtime.v1.linux/mody/be1ab5c28f70e78f57af90e84afd04b65f80e0359c2b15789092cb577e7ce1a9/init.pid</code></pre> В нём реальный pid dhcpd.<br /><br />В таком подходе проблема следующая: при обновлении контейнера - этот путь изменится, тогда и сервис придётся переделывать...
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-219067"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../index.html">
                <span class="post-username">Anton8830</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../../post/219067/index.html">#</a>
            3 года, 1 месяц назад
            
                (отредактировано
                
                    3 года, 1 месяц назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../topics/index.html">
                    23
                </a>
            </div>
            <div>
                Сообщения:
                <a href="index.html">
                    175
                </a>
            </div>
            <div>
                Участник с: 16 ноября 2013
            </div>
            
        </td>
        <td class="post-content">
            <strong>vs220</strong> PIDFile пробовал, но проблема в том, что он не создается. Принудительно его создавать тоже пробовал - не прокатило.<br />Restart=always приводит к тому, что сервис запускается, через секунду останавливается, запускается снова, останавливается и так по кругу...<br /><br />Реальный PIDFile, насколько я понимаю, создается внутри контейнера...
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-219064"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../index.html">
                <span class="post-username">Anton8830</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../../post/219064/index.html">#</a>
            3 года, 1 месяц назад
            
                (отредактировано
                
                    3 года, 1 месяц назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../topics/index.html">
                    23
                </a>
            </div>
            <div>
                Сообщения:
                <a href="index.html">
                    175
                </a>
            </div>
            <div>
                Участник с: 16 ноября 2013
            </div>
            
        </td>
        <td class="post-content">
            Доброго дня.<br /><br />Прошу помощи у знающих товарищей по systemd.<br /><br /><strong>Задача</strong><br />настроить запуск и работу dhcpd, находящегося в контейнере docker через сервис systemd<br /><br /><strong>Сделано</strong><br /><br />1. Создан образ на основе archlinux/base с dhpcd и его конфигом внутри<br /><em>Dockerfife</em><br /><pre><code>FROM archlinux/base
RUN echo &quot;y&quot; | pacman -Sy dhcp
COPY ./dhcpd.conf /etc
EXPOSE 67
CMD [&quot;/usr/sbin/dhcpd&quot;, &quot;-f&quot;, &quot;-4&quot;]</code></pre><pre><code>docker build -t dhcpd .</code></pre><br />2. Образ запущен в контейнере с именем dhcpd<br /><pre><code>docker run -d -p 67:67 --name dhcpd dhcpd
docker ps
...
be1ab5c28f70    dhcpd:latest    &quot;/usr/sbin/dhcpf -f ...&quot;    17 hours ago    Up 1 second    0.0.0.0:67-&gt;67/tcp    dhcpd

ps -ef | grep dhcp
...
root    1178    1161    9    09:25    ?    00:00:01 /usr/sbin/dhcpd -f -4</code></pre><br />3. Cоздан сервис<br /><em>/etc/systemd/system/docker_dhcpd.service</em><br /><br /><pre><code>[Unit]
Description=DHCP server in docker container
Requires=docker.service
Conflicts=dhcpd4.service

[Service]
Type=oneshot
RemainAfterExit=yes
ExecStart=/usr/bin/docker start dhcpd
ExecStop=/usr/bin/docker stop dhcpd

[Install]
WantedBy=multi-user.target</code></pre><br />4. Сервис включен.<br /><br /><strong>Проблема</strong><br />Запуск и остановка сервиса делают то, что и планировалось, но при падении процесса dhcpd ничего не происходит, сервис остается запущенным.<br /><br /><strong>Предпринятые действия</strong><br />В сервисе изменил тип Type=forking - получил цикличный перезапуск сервиса... Т. е. при старте, запускается контейнер, процесс умирает и systemd считает, что сервис упал, запускает ExecStop, в результате контейнер останавливается.<br /><br /><strong>Вопрос</strong><br />Как правильно настроить сервис, чтобы он отслеживал процесс dhcpd?
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-192406"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../index.html">
                <span class="post-username">Anton8830</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../../post/192406/index.html">#</a>
            5 лет, 1 месяц назад
            
                (отредактировано
                
                    5 лет, 1 месяц назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../topics/index.html">
                    23
                </a>
            </div>
            <div>
                Сообщения:
                <a href="index.html">
                    175
                </a>
            </div>
            <div>
                Участник с: 16 ноября 2013
            </div>
            
        </td>
        <td class="post-content">
            Кривое обновление mod_wsgi<br /><pre><code>[<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="8dece3f9e2e3cdc5e2e0e8dee8fffbe8ff">[email&#160;protected]</a> ~]$ systemctl status httpd
● httpd.service - Apache Web Server
   Loaded: loaded (/usr/lib/systemd/system/httpd.service; enabled; vendor preset: disabled)
   Active: failed (Result: exit-code) since Tue 2017-07-18 07:04:27 MSK; 4min 22s ago
  Process: 358 ExecStart=/usr/bin/httpd -k start -DFOREGROUND (code=exited, status=1/FAILURE)
 Main PID: 358 (code=exited, status=1/FAILURE)

июл 18 07:04:25 HomeServer systemd[1]: Started Apache Web Server.
июл 18 07:04:27 HomeServer httpd[358]: httpd: Syntax error on line 187 of /etc/httpd/conf/httpd.conf: Cannot load modules/mod_wsgi.so into server: /etc/httpd/modules/mo
июл 18 07:04:27 HomeServer systemd[1]: httpd.service: Main process exited, code=exited, status=1/FAILURE
июл 18 07:04:27 HomeServer systemd[1]: httpd.service: Unit entered failed state.
июл 18 07:04:27 HomeServer systemd[1]: httpd.service: Failed with result &#39;exit-code&#39;.
[<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="fa9b948e9594bab295979fa99f888c9f88">[email&#160;protected]</a> ~]$ grep wsgi.so /etc/httpd/conf/httpd.conf
LoadModule wsgi_module modules/mod_wsgi.so
[<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="ec8d82988382aca4838189bf899e9a899e">[email&#160;protected]</a> ~]$ pacman -Qs wsgi
local/mod_wsgi 4.5.17-1
    Python WSGI adapter module for Apache
[<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="a5c4cbd1cacbe5edcac8c0f6c0d7d3c0d7">[email&#160;protected]</a> ~]$ ls -laF /etc/httpd/modules/ | grep wsgi
-rwxr-xr-x 1 root root 232976 июл 16 15:34 mod_wsgi.so*
[<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="04656a706b6a444c6b6961576176726176">[email&#160;protected]</a> ~]$

</code></pre>Откат 4.5.17-1 -&gt; 4.4.22-1 решает проблему
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-188932"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../index.html">
                <span class="post-username">Anton8830</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../../post/188932/index.html">#</a>
            5 лет, 4 месяца назад
            
                (отредактировано
                
                    5 лет, 4 месяца назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../topics/index.html">
                    23
                </a>
            </div>
            <div>
                Сообщения:
                <a href="index.html">
                    175
                </a>
            </div>
            <div>
                Участник с: 16 ноября 2013
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>teplovoz</em><br>можно приобрести   Wi-Fi USB адаптер и настроить сеть  - Wi-Fi  для ПК   :)</blockquote>Можно, но не хочется. Хочется стационарник на работе подцепить к сети через модем, а к нему цепляться с ноута. А ещё лучше засунуть систему на SD, её - в модем и дальше иметь мобильную систему с возможностью раздачи Wifi<br /><br /><blockquote><em>domov0y</em><br>вы делали iwlist wwp0s29u1u2i3 scan (команда работает только с включенным вайфай модулем) и получали список сетей? если я что-то понимаю страшных буквах то wlp2s0 это вайфай вашего ноутбука.</blockquote>Не делал... Попробую.<br />wlp2s0 - да, это wifi карточка ноута.<br /><br /><blockquote><em>dmix</em><br>судя по idVendor 0x12d1 Huawei Technologies Co., Ltd. idProduct 0x1506 Modem/Networkcard - это Е398 - обычный LTE модем. Раздачу можно сделать только через встроенную или внешнюю Wi-Fi карту.</blockquote><blockquote><em>vasek</em><br>Чтобы USB 3G/4G модем мог раздавать интернет, он должен иметь встроенный WiFi роутер ( LTE роутер)</blockquote>Понятно, вот так с ходу - не судьба, а так хотелось... :-)
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-188872"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="../index.html">
                <span class="post-username">Anton8830</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="../../../post/188872/index.html">#</a>
            5 лет, 4 месяца назад
            
                (отредактировано
                
                    5 лет, 4 месяца назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="../topics/index.html">
                    23
                </a>
            </div>
            <div>
                Сообщения:
                <a href="index.html">
                    175
                </a>
            </div>
            <div>
                Участник с: 16 ноября 2013
            </div>
            
        </td>
        <td class="post-content">
            Товарищи, подскажите, а то я не понимаю...<br /><br />Исходное железо: Стационарный комп, ноутбук, 3g модем от Мегафона.<br />Задумка: воткнуть модем в стационарный комп, через него подключаться к паутине, и через него же (уже как сетевую карту) раздавать wifi для ноута.<br /><br />Пройденный путь: с помощью <a href="https://wiki.archlinux.org/index.php/Software_access_point_(Русский)">hostapd</a>, <a href="https://wiki.archlinux.org/index.php/Internet_sharing_(Русский)">iptables</a> и <a href="https://wiki.archlinux.org/index.php/Dhcpd_(Русский)">dhcpd</a> удалось раздавать wifi с модема через сетевую карту самого ноута. Принцип понятен.<br /><br />Проблема: при подключении модема появляется новое сетевое устройство<br /><pre><code>[<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="f2939c869d9cb2b98187819a93bc9d8697909d9d99">[email&#160;protected]</a> ~]$ ip link
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: wlp2s0: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc mq state DOWN mode DEFAULT group default qlen 1000
    link/ether dc:a9:71:94:71:e0 brd ff:ff:ff:ff:ff:ff
6: wwp0s29u1u2i3: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
    link/ether 3e:27:3f:b1:46:9d brd ff:ff:ff:ff:ff:ff
7: ppp0: &lt;POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UNKNOWN mode DEFAULT group default qlen 3
    link/ppp
[<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="a9c8c7ddc6c7e9e2dadcdac1c8e7c6ddcccbc6c6c2">[email&#160;protected]</a> ~]$ </code></pre><br />Только раздать wifi с него не получается<br /><pre><code>[<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="96f7f8e2f9f8d6dde5e3e5fef7d8f9e2f3f4f9f9fd">[email&#160;protected]</a> ~]$ cat /etc/hostapd/hostapd.conf
ssid=ShareWifi
wpa_passphrase=super_password
interface=wwp0s29u1u2i3
bridge=br0
auth_algs=3
channel=7
driver=nl80211
hw_mode=g
logger_stdout=-1
logger_stdout_level=2
max_num_sta=5
rsn_pairwise=CCMP
wpa=2
wpa_key_mgmt=WPA-PSK
wpa_pairwise=TKIP CCMP
[<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="cdaca3b9a2a38d86beb8bea5ac83a2b9a8afa2a2a6">[email&#160;protected]</a> ~]$ sudo systemctl start hostapd
[sudo] пароль для anton:
[<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="9cfdf2e8f3f2dcd7efe9eff4fdd2f3e8f9fef3f3f7">[email&#160;protected]</a> ~]$ systemctl status hostapd
● hostapd.service - Hostapd IEEE 802.11 AP, IEEE 802.1X/WPA/WPA2/EAP/RADIUS Authenticator
   Loaded: loaded (/usr/lib/systemd/system/hostapd.service; disabled; vendor preset: disabled)
   Active: failed (Result: exit-code) since Thu 2017-05-04 02:24:17 MSK; 7s ago
  Process: 2014 ExecStart=/usr/bin/hostapd /etc/hostapd/hostapd.conf (code=exited, status=1/FAILURE)
 Main PID: 2014 (code=exited, status=1/FAILURE)

май 04 02:24:17 KsushaNotebook hostapd[2014]: Configuration file: /etc/hostapd/hostapd.conf
май 04 02:24:17 KsushaNotebook hostapd[2014]: nl80211: Could not configure driver mode
май 04 02:24:17 KsushaNotebook hostapd[2014]: nl80211: deinit ifname=wwp0s29u1u2i3 disabled_11b_rates=0
май 04 02:24:17 KsushaNotebook hostapd[2014]: nl80211 driver initialization failed.
май 04 02:24:17 KsushaNotebook hostapd[2014]: wwp0s29u1u2i3: interface state UNINITIALIZED-&gt;DISABLED
май 04 02:24:17 KsushaNotebook hostapd[2014]: wwp0s29u1u2i3: AP-DISABLED
май 04 02:24:17 KsushaNotebook hostapd[2014]: hostapd_free_hapd_data: Interface wwp0s29u1u2i3 wasn&#39;t started
май 04 02:24:17 KsushaNotebook systemd[1]: hostapd.service: Main process exited, code=exited, status=1/FAILURE
май 04 02:24:17 KsushaNotebook systemd[1]: hostapd.service: Unit entered failed state.
май 04 02:24:17 KsushaNotebook systemd[1]: hostapd.service: Failed with result &#39;exit-code&#39;.
[<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="84e5eaf0ebeac4cff7f1f7ece5caebf0e1e6ebebef">[email&#160;protected]</a> ~]$ </code></pre>Насколько я понимаю, интерфейс не может выступать точкой доступа.<br /><br />Вопрос: он в-принципе этого не может или такая возможность просто выключена? Или я вообще не правильно понимаю ошибку?<br /><pre><code>[<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="dbbab5afb4b59b90a8aea8b3ba95b4afbeb9b4b4b0">[email&#160;protected]</a> ~]$lsusb -v
...
Bus 002 Device 003: ID 12d1:1506 Huawei Technologies Co., Ltd. Modem/Networkcard
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            0
  bDeviceSubClass         0
  bDeviceProtocol         0
  bMaxPacketSize0        64
  idVendor           0x12d1 Huawei Technologies Co., Ltd.
  idProduct          0x1506 Modem/Networkcard
  bcdDevice            1.02
  iManufacturer           1 HUAWEI
  iProduct                2 HUAWEI Mobile
  iSerial                 0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength          225
    bNumInterfaces          6
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           3
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      2
      bInterfaceProtocol      1
      iInterface              0
      ** UNRECOGNIZED:  05 24 00 10 01
      ** UNRECOGNIZED:  04 24 02 02
      ** UNRECOGNIZED:  05 24 01 00 00
      ** UNRECOGNIZED:  05 24 06 00 00
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               5
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x02  EP 2 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      2
      bInterfaceProtocol      2
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x84  EP 4 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x03  EP 3 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       0
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      2
      bInterfaceProtocol      3
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x85  EP 5 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x04  EP 4 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      2
      bInterfaceProtocol     22
      iInterface              9 CDC Network Control Model (NCM)
      ** UNRECOGNIZED:  05 24 00 10 01
      ** UNRECOGNIZED:  06 24 1a 00 01 1f
      ** UNRECOGNIZED:  0d 24 0f 0b 0f 00 00 00 ea 05 03 00 01
      ** UNRECOGNIZED:  05 24 06 03 03
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x87  EP 7 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               9
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        3
      bAlternateSetting       1
      bNumEndpoints           3
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      2
      bInterfaceProtocol     22
      iInterface             10 CDC Network Data
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x87  EP 7 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               9
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x05  EP 5 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        4
      bAlternateSetting       0
      bNumEndpoints           2
      bInterfaceClass         8 Mass Storage
      bInterfaceSubClass      6 SCSI
      bInterfaceProtocol     80 Bulk-Only
      iInterface              4 Mass Storage
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x88  EP 8 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x06  EP 6 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        5
      bAlternateSetting       0
      bNumEndpoints           2
      bInterfaceClass         8 Mass Storage
      bInterfaceSubClass      6 SCSI
      bInterfaceProtocol     80 Bulk-Only
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x89  EP 9 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x07  EP 7 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass            0
  bDeviceSubClass         0
  bDeviceProtocol         0
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0001
  Self Powered
...</code></pre>
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
    </div>
    <div>&nbsp;</div>
    
        <div class="text-center">
    


    <nav>
        <ul class="pagination">
            
                <li class="previous disabled">
                    <span>
                        <span aria-hidden="true">&laquo;</span>
                        <span class="hidden-xs">предыдущая страница</span>
                    </span>
                </li>
            

            
                
                    
                        <li class="active">
                            <a href="index2679.html?page=1">1 <span class="sr-only">(текущая страница)</span></a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index4658.html?page=2">2</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index9ba9.html?page=3">3</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexfdb0.html?page=4">4</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexaf4d.html?page=5">5</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexc575.html?page=6">6</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index235c.html?page=7">7</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="indexfdfa.html?page=8">8</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index0b08.html?page=9">9</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index1448.html?page=10">10</a>
                        </li>
                    
                
            
                
                    <li class="disabled">
                        <span>...</span>
                    </li>
                
            
                
                    
                        <li>
                            <a href="index5c43.html?page=17">17</a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="index9683.html?page=18">18</a>
                        </li>
                    
                
            

            
                <li class="next">
                    <a href="index4658.html?page=2" aria-label="следующая страница">
                        <span class="hidden-xs">следующая страница</span>
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            
        </ul>
    </nav>


</div>

    


        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

<script data-cfasync="false" src="../../../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>(function(){var js = "window['__CF$cv$params']={r:'745f6b39db227b67',m:'gl8Uvm41Npzpmz8ar4JMCbizsk4UTdCEHw.z0Vd70UE-1662385668-0-AZ6iZyqth7OS1GDbsG/hkkjMmC+n22Pex1pgoD/VkSgZclBhbipDtHylhKNKxgFl36dXzLUA+S2/OQaujHXcIcEhRZpJc4ufRd0nFvUgVZkqFxW/0iuPjEtcuzdhdzkVIS1stedN3x0bsjo0b3G2mKTegXlo1OheaUKROMUs6Bd7',s:[0xea5160f43e,0x1ec98ae7a3],u:'/cdn-cgi/challenge-platform/h/g'};var now=Date.now()/1000,offset=14400,ts=''+(Math.floor(now)-Math.floor(now%offset)),_cpo=document.createElement('script');_cpo.nonce='',_cpo.src='../../../../cdn-cgi/challenge-platform/h/g/scripts/alpha/invisible5615.js?ts='+ts,document.getElementsByTagName('head')[0].appendChild(_cpo);";var _0xh = document.createElement('iframe');_0xh.height = 1;_0xh.width = 1;_0xh.style.position = 'absolute';_0xh.style.top = 0;_0xh.style.left = 0;_0xh.style.border = 'none';_0xh.style.visibility = 'hidden';document.body.appendChild(_0xh);function handler() {var _0xi = _0xh.contentDocument || _0xh.contentWindow.document;if (_0xi) {var _0xj = _0xi.createElement('script');_0xj.nonce = '';_0xj.innerHTML = js;_0xi.getElementsByTagName('head')[0].appendChild(_0xj);}}if (document.readyState !== 'loading') {handler();} else if (window.addEventListener) {document.addEventListener('DOMContentLoaded', handler);} else {var prev = document.onreadystatechange || function () {};document.onreadystatechange = function (e) {prev(e);if (document.readyState !== 'loading') {document.onreadystatechange = prev;handler();}};}})();</script></body>

<!-- Mirrored from archlinux.org.ru/forum/users/Anton8830/posts/?page=1 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 08 Sep 2022 09:22:44 GMT -->
</html>
