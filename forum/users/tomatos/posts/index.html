


<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        tomatos Сообщения
    </title>
    <link rel="shortcut icon" href="https://storage.yandexcloud.net/aor-static/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="https://storage.yandexcloud.net/aor-static/static/css/default.css">
    
    
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://storage.yandexcloud.net/aor-static/static/pybb/js/pybbjs.js"></script>
    
    
    
    <!-- Feeds -->
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/posts/" title="Последние сообщения на форуме" >
    <link rel="alternate" type="application/atom+xml" href="/forum/feeds/topics/" title="Последние темы на форуме" >

    
</head>
<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid wrapper">
        
    
<ul class="nav navbar-nav">
    <li>
      <a class="navbar-brand" href="/">
        <img src="https://storage.yandexcloud.net/aor-static/static/logo.png" alt="" style="opacity: .7; vertical-align: top">
      </a>
    </li>
    <li class=""><a href="/news/">Новости</a></li>
    <li class="active"><a href="/forum/">Форум</a></li>
    <li class=""><a href="/blogs/">Блоги</a></li>
    <li><a href="https://archlinux.org/">Eng</a></li>
    <li><a href="https://wiki.archlinux.org/index.php/Main_page_%28%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9%29">Wiki</a></li>
    <li class="dropdown">
      <a href="https://www.archlinux.org/packages/" class="dropdown-toggle" data-toggle="dropdown">
        Пакеты
        <b class="caret"></b>
      </a>
      <ul class="dropdown-menu">
        <li><a href="https://www.archlinux.org/packages/">Официальные репозитории</a></li></li>
        <li><a href="https://aur.archlinux.org/?setlang=ru">AUR</a></li>
      </ul>
    <li><a href="https://archlinux.org/download/">Скачать</a></li>
</ul>

<form class="navbar-form navbar-left" role="search" action="https://www.google.ru/cse">
    <input type="hidden" name="cx" value="018428664132160064944:ntsma9ch2ug"/>
    <input type="hidden" name="ie" value="UTF-8"/>
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Что ищем?">
      <span class="input-group-btn">
        <button type="submit" name="sa" class="btn btn-default">Найти</button>
      </span>
    </div>
</form>

<ul class="nav navbar-nav navbar-right">


    
      <li><a href="/irc/#chat">IRC</a></li>
      <li class="dropdown">
        <a href="/accounts/login/" class="dropdown-toggle" data-toggle="dropdown">
          Профиль
          <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
          <li><a href="/accounts/login/">Вход</a></li>
          <li><a href="/accounts/register/">Регистрация</a></li>
        </ul>
      </li>
    
</ul>


    </div>
</nav>



<div class="modal fade" id='new_pm_notify' role="dialog" aria-labelledby="gridSystemModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content navbar-default">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="gridSystemModalLabel">Новые личные сообщения</h4>
      </div>
      <div class="modal-body">
        <a href="/messages/inbox/" class="center-block btn btn-primary">Перейти в папку Входящие <span class="badge"></span></a>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid wrapper">
    <div class="row">
        <div class="col-md-12">
            
    
        
<ul class="breadcrumb">
    

    <li><a href="/">ArchLinux.org.ru</a></li>


    <li><a href="/forum/">Начало</a> <span class="divider">/</span></li>
    
    
        <li>Сообщения</li>
    
</ul>

    

        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            
    <div class="row">
        <div class="col-md-12 forum">
            
    <div class="posts">
        
            




<table class="table table-bordered post post-row
       "
       id="post-27220"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/tomatos/">
                <span class="post-username">tomatos</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/27220/">#</a>
            10 лет, 7 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/tomatos/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/tomatos/posts/">
                    11
                </a>
            </div>
            <div>
                Участник с: 03 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
            м<blockquote><em>Natrio</em><br/>Отсюда вывод – сбрасываются ВСЕ цепочки, то есть не только <em><strong>filter</strong></em>, но и <em><strong>nat</strong></em> в том числе.<br/>Собственно, вы всегда можете проверить, что сброшено, а что нет – на то есть команда <strong>iptables-save</strong></blockquote>Вы правы, но я имел в виду, что таблица маршрутизации останется прежней. Все-таки NAT это только частный случай маршрутизации.<br/><blockquote><em>CryptSpirit</em><br/><div class="code"><pre>iptables -A FORWARD -i ppp0 -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT
iptables -A FORWARD -o ppp0 -s 192.168.0.1/24 -j ACCEPT
iptables -P FORWARD DROP</pre></div></blockquote>На самом деле, я хотел настроить для начала простейший вариант, а потом уже добавлять все необходимые мне правила. Но, в любом случае, к сожалению, эти настройки не помогли.  <br/><strong>vadik</strong>, как я понял Ваш совет был аналогичен совету <strong>CryptSpirit</strong>, так что он тоже, повидимому,  не принес успеха.<br/><br/><blockquote><em>CryptSpirit</em><br/>И зачем тебе на wlan0 роут?</blockquote>Роут на wlan0 нужен для того, что бы роутер &ldquo;знал&rdquo;, что подключен через него к сети 192.168.0.0 и куда ему посылать пакеты предназначенные хостам в этой сети. Роут на eth0 Вас же не смущает.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-27218"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/tomatos/">
                <span class="post-username">tomatos</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/27218/">#</a>
            10 лет, 7 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/tomatos/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/tomatos/posts/">
                    11
                </a>
            </div>
            <div>
                Участник с: 03 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>vadik</em><br/><blockquote><em>Tomatos</em><br/>если iptables откючен роутер должен пробовать отправить перенаправленные пакеты наружу</blockquote>Вы хотите на роутере отключить службу которая занимается перенаправлением пакетов? А кто или что тогда будет пакетами рулить?</blockquote>Насколько я понял, из уже прочитанного и опробованного, в общем случае iptables на Linux-роутере не нужен - маршрутизацией пакетов занимается ядро, а iptables всего лишь утилита для конфигурирования правил фильтрации в ядре. В данном случае iptables нужен исключительно для поднятия NAT на роутере. И если выполнить /etc/rc.d/iptables stop всего лишь сбросятся правила фильтрации, но не маршрутизации. Следовательно, пакеты все-таки должны перенаправляться.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-27216"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/tomatos/">
                <span class="post-username">tomatos</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/27216/">#</a>
            10 лет, 7 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/tomatos/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/tomatos/posts/">
                    11
                </a>
            </div>
            <div>
                Участник с: 03 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
            <strong>CryptSpirit</strong>, <strong>vadik</strong> спасибо за советы, вечером буду дома - попробую.<br/><blockquote>И зачем тебе на wlan0 роут?</blockquote>Хммм&#8230; действительно&#8230; Вечером гляну откуда он взялся.<br/><br/>Попробую изложить некоторые свои мысли по поводу проблемы, которые успел надумать.<br/>Меня смущает то, что во всех howto говорят, &ldquo;включите маскарадинг и все будет шоколадно&rdquo;. <br/>Ведь по идее, если iptables откючен роутер должен пробовать отправить перенаправленные пакеты наружу, а уже принимающая сторона должна их отбрасывать, т.к. ничего не знает о сети 192.168.0.0/24. Но wireshark говорит, что никаких пакетов с ip.src=192.168.0.0/24 ни на eth0, ни на ppp0 нет (повторюсь, iptables отключен - их никто не должен, по идее, блокировать). Отсюда у меня возник вопрос: где посмотреть что происходит с пакетами в ядре? Вечером попробую еще логгирование в iptables включить на существующие правила, но вряд ли это что-то даст политика-то ACCEPT.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-27213"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/tomatos/">
                <span class="post-username">tomatos</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/27213/">#</a>
            10 лет, 7 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/tomatos/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/tomatos/posts/">
                    11
                </a>
            </div>
            <div>
                Участник с: 03 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>vadik</em><br/>А iptables вообще запущен? Если да, то как запускаете?</blockquote>Действительно, забыл добавить iptables в rc.conf. <br/><blockquote><em>vadik</em><br/>И еще, из вики:<blockquote>Измените файл /etc/conf.d/iptables:<br/><br/><div class="code"><pre>IPTABLES_FORWARD=1  # enable IP forwarding?</pre></div></blockquote></blockquote>Изменил, перезапустил iptables - не помогло, для верности перезагрузился, все равно ноль эмоций.<br/>У меня ощущение, что проблема не в iptables, а ядро по какой-то причине не форвардит пакеты, хотя должно бы.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-27211"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/tomatos/">
                <span class="post-username">tomatos</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/27211/">#</a>
            10 лет, 7 месяцев назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/tomatos/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/tomatos/posts/">
                    11
                </a>
            </div>
            <div>
                Участник с: 03 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
            Здравствуйте.<br/>После того, как сдох роутер решил попробовать раздавать интернет нетбуком. Настроил VPN к провайдеру, hostapd, dhcp, добавил net.ipv4.ip_forward=1 в /etc/systl.conf, добавил правило iptables -t nat -A POSTROUTING -o ppp0 -j MASQUERADE в iptables.  Машины нормально подключаются к wifi, получают ip, но почему-то этот импровизированный роутер никак не хочет пускать их наружу. Никак не могу понять, чего же я не доделал или сделал не так.<br/>Почитал этот форум, вики, лор, опеннет и гугл, но либо я не по тем словам ищу, либо одно из двух.  Третий день бьюсь лбом в стену.<br/>Описание конфигурации:<br/>eth0 - интерфейс к провайдеру<br/>wlan0 - интерфейс внутрь сети<br/>ppp0 - VPN до интернет<br/>Мой rc.conf<br/><div class="code"><pre>LOCALE="ru_RU.UTF-8"
HARDWARECLOCK="UTC"
TIMEZONE="Asia/Moscow"
KEYMAP="ru"
CONSOLEFONT=ter-v16b
CONSOLEMAP=
USECOLOR="yes"
MOD_AUTOLOAD="yes"
MODULES=(acpi-cpufreq cpufreq_ondemand)
USELVM="no"
HOSTNAME="neb"
eth0="dhcp"
wlan0="wlan0 192.168.0.1"
INTERFACES=(eth0 wlan0)
gateway="default gw 192.168.0.1"
ROUTES=(!gateway)
 
NETWORK_PERSIST="no"
dhcp_ifaces="wlan0"
DAEMONS=(syslog-ng acpid laptop-mode cpufreq dbus @sshd network hostapd dhcp4 netfs crond @alsa @openntpd)</pre></div>вывод ifconfig -a<br/><div class="code"><pre>eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500  metric 1
        inet 10.250.92.224  netmask 255.255.255.0  broadcast 10.250.92.255
        inet6 fe80::226:18ff:fe68:2b7c  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether 00:26:18:68:2b:7c  txqueuelen 1000  (Ethernet)
        RX packets 29433  bytes 6823752 (6.5 MiB)
        RX errors 0  dropped 32  overruns 0  frame 0
        TX packets 14561  bytes 2008836 (1.9 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 2  collisions 0
        device interrupt 45  
lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 16436  metric 1
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;
        loop  txqueuelen 0  (Local Loopback)
        RX packets 1  bytes 76 (76.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 1  bytes 76 (76.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
mon.wlan0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500  metric 1
        unspec 00-25-D3-16-CC-35-30-30-00-00-00-00-00-00-00-00  txqueuelen 1000  (UNSPEC)
        RX packets 6024  bytes 618741 (604.2 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
ppp0: flags=4305&lt;UP,POINTOPOINT,RUNNING,NOARP,MULTICAST&gt;  mtu 1500  metric 1
        inet 89.208.4.234  netmask 255.255.255.255  destination 213.219.200.152
        ppp  txqueuelen 3  (Point-to-Point Protocol)
        RX packets 18553  bytes 4935774 (4.7 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 6061  bytes 1167058 (1.1 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
tap0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500  metric 1
        inet 192.168.77.245  netmask 255.255.255.0  broadcast 192.168.77.255
        inet6 fe80::dc86:52ff:fe04:3d8a  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether de:86:52:04:3d:8a  txqueuelen 100  (Ethernet)
        RX packets 14861  bytes 2494049 (2.3 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 2349  bytes 447417 (436.9 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
wlan0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500  metric 1
        inet 192.168.0.1  netmask 255.255.255.0  broadcast 192.168.0.255
        inet6 fe80::225:d3ff:fe16:cc35  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether 00:25:d3:16:cc:35  txqueuelen 1000  (Ethernet)
        RX packets 323  bytes 33659 (32.8 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 204  bytes 28349 (27.6 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</pre></div>вывод netstat -r<br/><div class="code"><pre>Kernel IP routing table
Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface
default         89.208.4.234    0.0.0.0         UG        0 0          0 ppp0
10.0.0.0        10.250.92.254   255.0.0.0       UG        0 0          0 eth0
10.25.255.228   10.250.92.254   255.255.255.255 UGH       0 0          0 eth0
10.250.92.0     *               255.255.255.0   U         0 0          0 eth0
192.168.0.0     *               255.255.255.0   U         0 0          0 wlan0
192.168.77.0    *               255.255.255.0   U         0 0          0 tap0
213.219.200.152 *               255.255.255.255 UH        0 0          0 ppp0</pre></div>вывод iptables -vnL -t nat<br/><div class="code"><pre>Chain PREROUTING (policy ACCEPT 2331 packets, 314K bytes)
 pkts bytes target     prot opt in     out     source               destination         
Chain INPUT (policy ACCEPT 1130 packets, 149K bytes)
 pkts bytes target     prot opt in     out     source               destination         
Chain OUTPUT (policy ACCEPT 640 packets, 41739 bytes)
 pkts bytes target     prot opt in     out     source               destination         
Chain POSTROUTING (policy ACCEPT 711 packets, 46337 bytes)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MASQUERADE  all  --  *      ppp0    192.168.0.0/24       0.0.0.0/0           </pre></div>
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-73994"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/tomatos/">
                <span class="post-username">tomatos</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/73994/">#</a>
            12 лет, 3 месяца назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/tomatos/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/tomatos/posts/">
                    11
                </a>
            </div>
            <div>
                Участник с: 03 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>off220</em><br/>v gnome tak i ne perekliuchaetsya posle obnovlenii&#8230;:(</blockquote>В параметрах клавиатуры заданы обе раскладки? (для переключения средствами Gnome)
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-73992"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/tomatos/">
                <span class="post-username">tomatos</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/73992/">#</a>
            12 лет, 3 месяца назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/tomatos/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/tomatos/posts/">
                    11
                </a>
            </div>
            <div>
                Участник с: 03 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>h4tr3d</em><br/>Tomatos попробуй другой вариант раскладки, у меня предположения два: или кто-то перебивает настройки уже после старта иксов или какой-то вариант раскладки тупо перестал работать в самих иксах.</blockquote>Внезапно, после, &#8230;дцатой перезагрузки, в openbox заработало переключение по hal. В Gnome  так и не работает. Не понял, что я сделал, к сожалению :(.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-73989"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/tomatos/">
                <span class="post-username">tomatos</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/73989/">#</a>
            12 лет, 3 месяца назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/tomatos/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/tomatos/posts/">
                    11
                </a>
            </div>
            <div>
                Участник с: 03 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>h4tr3d</em><br/>Позитрон! Бог с тобой, не надо давать такие советы, придут, прочитают, подумать, как обычно, забудут, а потом тут вопросы - а у меня тестинг, и все упало, где у меня ошибка? Ну право, в таких ситуациях напрашивается ответ - В ДНК!<br/><br/>Tomatos, попробуй другой вариант раскладки, и покажи сам xml конфига.</blockquote>На  не хочу переходить&#8230;<br/>cat /etc/hal/fdi/policy/10-keymap.fdi <br/><div class="code"><pre>&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt; &lt;!-- -*- SGML -*- --&gt;
&lt;deviceinfo version="0.2"&gt;
  &lt;device&gt;
    &lt;match key="info.capabilities" contains="input.keymap"&gt;
      &lt;append key="info.callouts.add" type="strlist"&gt;hal-setup-keymap&lt;/append&gt;
    &lt;/match&gt;
    &lt;match key="info.capabilities" contains="input.keys"&gt;
      &lt;merge key="input.xkb.rules" type="string"&gt;base&lt;/merge&gt;
      &lt;!-- If we're using Linux, we use evdev by default (falling back to
           keyboard otherwise). --&gt;
      &lt;merge key="input.xkb.model" type="string"&gt;keyboard&lt;/merge&gt;
      &lt;match key="/org/freedesktop/Hal/devices/computer:system.kernel.name"
             string="Linux"&gt;
        &lt;merge key="input.xkb.model" type="string"&gt;evdev&lt;/merge&gt;
      &lt;/match&gt;
      &lt;merge key="input.xkb.layout" type="string"&gt;us,ru&lt;/merge&gt;
      &lt;merge key="input.xkb.variant" type="string"&gt;,winkeys&lt;/merge&gt;
      &lt;merge key="input.xkb.options" type="string"&gt;grp:caps_toggle&lt;/merge&gt;
    &lt;/match&gt;
  &lt;/device&gt;
&lt;/deviceinfo&gt;</pre></div>Никаких изменений в него не вносил вот уже N месяцев&#8230;<br/><blockquote><em>Amigo</em><br/>Всю жисть настраивал мышу и клаву через xorg.conf и никаких халов, чего и вам советую.</blockquote>Тоже предпочитаю более универсальные методы, но вот при переходе Х-ов на hal - решил попробовать&#8230; Теперь очень интересно что-же случилось, вроде ничего не менял?<br/>P.S.: Все равно в скором времени переходить на udev ;)
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-73980"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/tomatos/">
                <span class="post-username">tomatos</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/73980/">#</a>
            12 лет, 3 месяца назад
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/tomatos/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/tomatos/posts/">
                    11
                </a>
            </div>
            <div>
                Участник с: 03 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
            <blockquote><em>PoZiTPoH</em><br/>С вашими настройками переключение идет по CAPS LOCK</blockquote>Спасибо, я в курсе.<br/><blockquote><em>vadik</em><br/>ВМ/ДЕ какое? Или где не работает переключение?</blockquote>Ни в Openbox, ни в Gnome. Сейчас пользуюсь гномовским переключателем, но в Openbox им не попользуешься :(
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
            




<table class="table table-bordered post post-row
       "
       id="post-73977"
       >
    <thead>
    <tr>
        <td class="post-author">
            <a href="/forum/users/tomatos/">
                <span class="post-username">tomatos</span>
            </a>
        </td>
        <td class="post-date">
            <div class="post-control">
                
                    
                
            </div>
            <a class="permalink" href="/forum/post/73977/">#</a>
            12 лет, 3 месяца назад
            
                (отредактировано
                
                    12 лет, 3 месяца назад)
                
            
            
        </td>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="post-info">
            

<div class="avatar">
    
</div>

            <div>
                Темы:
                <a href="/forum/users/tomatos/topics/">
                    2
                </a>
            </div>
            <div>
                Сообщения:
                <a href="/forum/users/tomatos/posts/">
                    11
                </a>
            </div>
            <div>
                Участник с: 03 ноября 2009
            </div>
            
        </td>
        <td class="post-content">
            Доброго всем времени суток.<br/>Дико извиняюсь за некрофилию со старой веткой, но, кажется, у меня похожая проблема.<br/>Судя по всему hal мои настройки подхватил:<br/>Вот что выводит lshal<br/><div class="code"><pre>udi = '/org/freedesktop/Hal/devices/platform_i8042_i8042_KBD_port_logicaldev_input'
  info.addons.singleton = {'hald-addon-input'} (string list)
  info.capabilities = {'input', 'input.keyboard', 'input.keypad', 'input.keys', 'button'} (string list)
  info.category = 'input'  (string)
  info.parent = '/org/freedesktop/Hal/devices/platform_i8042_i8042_KBD_port'  (string)
  info.product = 'AT Translated Set 2 keyboard'  (string)
  info.subsystem = 'input'  (string)
  info.udi = '/org/freedesktop/Hal/devices/platform_i8042_i8042_KBD_port_logicaldev_input'  (string)
  input.device = '/dev/input/event1'  (string)
  input.originating_device = '/org/freedesktop/Hal/devices/platform_i8042_i8042_KBD_port'  (string)
  input.product = 'AT Translated Set 2 keyboard'  (string)
  input.x11_driver = 'evdev'  (string)
  input.xkb.layout = 'us,ru'  (string)
  input.xkb.model = 'evdev'  (string)
  input.xkb.options = 'grp:caps_toggle'  (string)
  input.xkb.rules = 'base'  (string)
  input.xkb.variant = ',winkeys'  (string)
  linux.device_file = '/dev/input/event1'  (string)
  linux.hotplug_type = 2  (0x2)  (int)
  linux.subsystem = 'input'  (string)
  linux.sysfs_path = '/sys/devices/platform/i8042/serio0/input/input1/event1'  (string)</pre></div>о том же говорит Xorg.0.log<br/><div class="code"><pre>(II) XINPUT: Adding extended input device "AT Translated Set 2 keyboard" (type: KEYBOARD)
(**) Option "xkb_rules" "evdev"
(**) Option "xkb_model" "evdev"
(**) Option "xkb_layout" "us,ru"
(**) Option "xkb_variant" ",winkeys"
(**) Option "xkb_options" "grp:caps_toggle"</pre></div>Но переключение все равно не работает.<br/>Немного смущает различие значений xkb_rules и xkb.rules<br/>Судя по pacman.log ничего касающегося hal или ввода сегодня не ставил и не обновлял.<br/>Если, кто-то сможет помочь заставить переключение снова работать - буду несказанно благодарен.
            
                
            

            <div class="post-related">
                <div class='attachments'>
                    
                </div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

        
    </div>
    <div>&nbsp;</div>
    
        <div class="text-center">
    


    <nav>
        <ul class="pagination">
            
                <li class="previous disabled">
                    <span>
                        <span aria-hidden="true">&laquo;</span>
                        <span class="hidden-xs">предыдущая страница</span>
                    </span>
                </li>
            

            
                
                    
                        <li class="active">
                            <a href="?page=1">1 <span class="sr-only">(текущая страница)</span></a>
                        </li>
                    
                
            
                
                    
                        <li>
                            <a href="?page=2">2</a>
                        </li>
                    
                
            

            
                <li class="next">
                    <a href="?page=2" aria-label="следующая страница">
                        <span class="hidden-xs">следующая страница</span>
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            
        </ul>
    </nav>


</div>

    


        </div>
    </div>

        </div>
    </div>
    <div class="row">
        <div class="col-md-6 footer">
            
                <p class="copyright">&copy; 2006-2022, Русскоязычное сообщество
                    Arch Linux.<br>Название и логотип Arch Linux &trade;
                    являются признанными торговыми
                    марками.<br>Linux &reg; &mdash; зарегистрированная торговая
                    марка Linus Torvalds и LMI.</p>
            
        </div>
    </div>
</div>

<script>(function(){var js = "window['__CF$cv$params']={r:'747c757c8a4416ec',m:'fatY.loBAfsWnI99enigjOcZYPioSvUrV0zmpX0zXqg-1662690175-0-ASf2mkiz2vMhSKqW9kILMgnxti2VrJhhVkNfn/C4vQkRpjNCFS/1h6IEKtSlMxcxZBXrMmYxqzyVN41SXWOiSQcy+y6uDGHBWVz/XQf40W0naP7gR2TNDCiXr0TTvQWsKHh7kbRjTApvuo7ANKlMbig=',s:[0xff607e3ddd,0x25ca6141fc],u:'/cdn-cgi/challenge-platform/h/g'};var now=Date.now()/1000,offset=14400,ts=''+(Math.floor(now)-Math.floor(now%offset)),_cpo=document.createElement('script');_cpo.nonce='',_cpo.src='/cdn-cgi/challenge-platform/h/g/scripts/alpha/invisible.js?ts='+ts,document.getElementsByTagName('head')[0].appendChild(_cpo);";var _0xh = document.createElement('iframe');_0xh.height = 1;_0xh.width = 1;_0xh.style.position = 'absolute';_0xh.style.top = 0;_0xh.style.left = 0;_0xh.style.border = 'none';_0xh.style.visibility = 'hidden';document.body.appendChild(_0xh);function handler() {var _0xi = _0xh.contentDocument || _0xh.contentWindow.document;if (_0xi) {var _0xj = _0xi.createElement('script');_0xj.nonce = '';_0xj.innerHTML = js;_0xi.getElementsByTagName('head')[0].appendChild(_0xj);}}if (document.readyState !== 'loading') {handler();} else if (window.addEventListener) {document.addEventListener('DOMContentLoaded', handler);} else {var prev = document.onreadystatechange || function () {};document.onreadystatechange = function (e) {prev(e);if (document.readyState !== 'loading') {document.onreadystatechange = prev;handler();}};}})();</script></body>
</html>
